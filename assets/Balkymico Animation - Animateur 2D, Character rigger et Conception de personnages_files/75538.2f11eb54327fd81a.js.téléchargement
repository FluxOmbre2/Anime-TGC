"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[75538],{406663:function(e,t,n){n.d(t,{IH:function(){return nJ},S1:function(){return nY}});var r,i,o,s,a,u,c,l,d,f,h,p=n(212328),v=n(300491),g=n(478918),m=n(594789),y=n(136314),_=function(e,t){var n=Math.max(t,1);return e.reduce(function(e,t,r){var i=Math.floor(r/n);return e[i]||(e[i]=[]),e[i].push(t),e},[])},b=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=m.q.Unknown),{event:e,code:t,message:n}},w=n(76594),S=function(e){return e?(e^16*Math.random()>>e/4).toString(16):(String(1e7)+String(-1e3)+String(-4e3)+String(-8e3)+String(-1e11)).replace(/[018]/g,S)};function I(e){var t="";try{"body"in e&&(t=JSON.stringify(e.body,null,2))}catch(e){}return t}var E=function(){function e(){this.name="amplitude",this.type="destination",this.retryTimeout=1e3,this.throttleTimeout=3e4,this.storageKey="",this.scheduled=null,this.queue=[]}return e.prototype.setup=function(e){var t;return(0,v.__awaiter)(this,void 0,void 0,function(){var n,r=this;return(0,v.__generator)(this,function(i){switch(i.label){case 0:return this.config=e,this.storageKey="".concat(y.f1,"_").concat(this.config.apiKey.substring(0,10)),[4,null===(t=this.config.storageProvider)||void 0===t?void 0:t.get(this.storageKey)];case 1:return(n=i.sent())&&n.length>0&&Promise.all(n.map(function(e){return r.execute(e)})).catch(),[2,Promise.resolve(void 0)]}})})},e.prototype.execute=function(e){var t=this;return e.insert_id||(e.insert_id=S()),new Promise(function(n){t.addToQueue({event:e,attempts:0,callback:function(e){return n(e)},timeout:0})})},e.prototype.getTryableList=function(e){var t=this;return e.filter(function(e){return e.attempts<t.config.flushMaxRetries?(e.attempts+=1,!0):(t.fulfillRequest([e],500,"Event rejected due to exceeded retry count"),!1)})},e.prototype.scheduleTryable=function(e,t){var n=this;void 0===t&&(t=!1),e.forEach(function(e){if(t&&(n.queue=n.queue.concat(e)),0===e.timeout){n.schedule(n.config.flushIntervalMillis);return}setTimeout(function(){e.timeout=0,n.schedule(0)},e.timeout)})},e.prototype.addToQueue=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.getTryableList(e);this.scheduleTryable(n,!0),this.saveEvents()},e.prototype.schedule=function(e){var t=this;this.scheduled||this.config.offline||(this.scheduled=setTimeout(function(){t.flush(!0).then(function(){t.queue.length>0&&t.schedule(e)})},e))},e.prototype.flush=function(e){return void 0===e&&(e=!1),(0,v.__awaiter)(this,void 0,void 0,function(){var t,n,r=this;return(0,v.__generator)(this,function(i){switch(i.label){case 0:if(this.config.offline)return this.config.loggerProvider.debug("Skipping flush while offline."),[2];return t=[],n=[],this.queue.forEach(function(e){return 0===e.timeout?t.push(e):n.push(e)}),this.scheduled&&(clearTimeout(this.scheduled),this.scheduled=null),[4,Promise.all(_(t,this.config.flushQueueSize).map(function(t){return r.send(t,e)}))];case 1:return i.sent(),this.scheduleTryable(n),[2]}})})},e.prototype.send=function(e,t){return void 0===t&&(t=!0),(0,v.__awaiter)(this,void 0,void 0,function(){var n,r,i,o;return(0,v.__generator)(this,function(s){switch(s.label){case 0:if(!this.config.apiKey)return[2,this.fulfillRequest(e,400,"Event rejected due to missing API key")];n={api_key:this.config.apiKey,events:e.map(function(e){var t=e.event;return t.extra,(0,v.__rest)(t,["extra"])}),options:{min_id_length:this.config.minIdLength},client_upload_time:new Date().toISOString(),request_metadata:this.config.requestMetadata},this.config.requestMetadata=new w.Dg,s.label=1;case 1:return s.trys.push([1,3,,4]),r=(0,w.RG)(this.config.serverUrl,this.config.serverZone,this.config.useBatch).serverUrl,[4,this.config.transportProvider.send(r,n)];case 2:if(null===(i=s.sent()))return this.fulfillRequest(e,0,"Unexpected error occurred"),[2];if(!t)return"body"in i?this.fulfillRequest(e,i.statusCode,"".concat(i.status,": ").concat(I(i))):this.fulfillRequest(e,i.statusCode,i.status),[2];return this.handleResponse(i,e),[3,4];case 3:var a;return o=(a=s.sent())instanceof Error?a.message:String(a),this.config.loggerProvider.error(o),this.handleResponse({status:m.q.Failed,statusCode:0},e),[3,4];case 4:return[2]}})})},e.prototype.handleResponse=function(e,t){var n=e.status;switch(n){case m.q.Success:this.handleSuccessResponse(e,t);break;case m.q.Invalid:this.handleInvalidResponse(e,t);break;case m.q.PayloadTooLarge:this.handlePayloadTooLargeResponse(e,t);break;case m.q.RateLimit:this.handleRateLimitResponse(e,t);break;default:this.config.loggerProvider.warn("{code: 0, error: \"Status '".concat(n,"' provided for ").concat(t.length,' events"}')),this.handleOtherResponse(t)}},e.prototype.handleSuccessResponse=function(e,t){this.fulfillRequest(t,e.statusCode,"Event tracked successfully")},e.prototype.handleInvalidResponse=function(e,t){var n=this;if(e.body.missingField||e.body.error.startsWith("Invalid API key")){this.fulfillRequest(t,e.statusCode,e.body.error);return}var r=new Set((0,v.__spreadArray)((0,v.__spreadArray)((0,v.__spreadArray)((0,v.__spreadArray)([],(0,v.__read)(Object.values(e.body.eventsWithInvalidFields)),!1),(0,v.__read)(Object.values(e.body.eventsWithMissingFields)),!1),(0,v.__read)(Object.values(e.body.eventsWithInvalidIdLengths)),!1),(0,v.__read)(e.body.silencedEvents),!1).flat()),i=t.filter(function(t,i){if(r.has(i)){n.fulfillRequest([t],e.statusCode,e.body.error);return}return!0});i.length>0&&this.config.loggerProvider.warn(I(e));var o=this.getTryableList(i);this.scheduleTryable(o)},e.prototype.handlePayloadTooLargeResponse=function(e,t){if(1===t.length){this.fulfillRequest(t,e.statusCode,e.body.error);return}this.config.loggerProvider.warn(I(e)),this.config.flushQueueSize/=2;var n=this.getTryableList(t);this.scheduleTryable(n)},e.prototype.handleRateLimitResponse=function(e,t){var n=this,r=Object.keys(e.body.exceededDailyQuotaUsers),i=Object.keys(e.body.exceededDailyQuotaDevices),o=e.body.throttledEvents,s=new Set(r),a=new Set(i),u=new Set(o),c=t.filter(function(t,r){if(t.event.user_id&&s.has(t.event.user_id)||t.event.device_id&&a.has(t.event.device_id)){n.fulfillRequest([t],e.statusCode,e.body.error);return}return u.has(r)&&(t.timeout=n.throttleTimeout),!0});c.length>0&&this.config.loggerProvider.warn(I(e));var l=this.getTryableList(c);this.scheduleTryable(l)},e.prototype.handleOtherResponse=function(e){var t=this,n=e.map(function(e){return e.timeout=e.attempts*t.retryTimeout,e}),r=this.getTryableList(n);this.scheduleTryable(r)},e.prototype.fulfillRequest=function(e,t,n){this.removeEvents(e),e.forEach(function(e){return e.callback(b(e.event,t,n))})},e.prototype.saveEvents=function(){if(this.config.storageProvider){var e=this.queue.map(function(e){return e.event});this.config.storageProvider.set(this.storageKey,e)}},e.prototype.removeEvents=function(e){this.queue=this.queue.filter(function(t){return!e.some(function(e){return e.event.insert_id===t.event.insert_id})}),this.saveEvents()},e}();(r=u||(u={})).SET="$set",r.SET_ONCE="$setOnce",r.ADD="$add",r.APPEND="$append",r.PREPEND="$prepend",r.REMOVE="$remove",r.PREINSERT="$preInsert",r.POSTINSERT="$postInsert",r.UNSET="$unset",r.CLEAR_ALL="$clearAll",(i=c||(c={})).REVENUE_PRODUCT_ID="$productId",i.REVENUE_QUANTITY="$quantity",i.REVENUE_PRICE="$price",i.REVENUE_TYPE="$revenueType",i.REVENUE="$revenue",(o=l||(l={})).IDENTIFY="$identify",o.GROUP_IDENTIFY="$groupidentify",o.REVENUE="revenue_amount";var C=function(e){if(Object.keys(e).length>1e3)return!1;for(var t in e){var n=e[t];if(!k(t,n))return!1}return!0},k=function(e,t){var n,r;if("string"!=typeof e)return!1;if(Array.isArray(t)){var i=!0;try{for(var o=(0,v.__values)(t),s=o.next();!s.done;s=o.next()){var a=s.value;if(Array.isArray(a))return!1;if("object"==typeof a)i=i&&C(a);else if(!["number","string"].includes(typeof a))return!1;if(!i)return!1}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}else if(null==t)return!1;else if("object"==typeof t)return C(t);else if(!["number","string","boolean"].includes(typeof t))return!1;return!0},T=function(){function e(){this._propertySet=new Set,this._properties={}}return e.prototype.getUserProperties=function(){return(0,v.__assign)({},this._properties)},e.prototype.set=function(e,t){return this._safeSet(u.SET,e,t),this},e.prototype.setOnce=function(e,t){return this._safeSet(u.SET_ONCE,e,t),this},e.prototype.append=function(e,t){return this._safeSet(u.APPEND,e,t),this},e.prototype.prepend=function(e,t){return this._safeSet(u.PREPEND,e,t),this},e.prototype.postInsert=function(e,t){return this._safeSet(u.POSTINSERT,e,t),this},e.prototype.preInsert=function(e,t){return this._safeSet(u.PREINSERT,e,t),this},e.prototype.remove=function(e,t){return this._safeSet(u.REMOVE,e,t),this},e.prototype.add=function(e,t){return this._safeSet(u.ADD,e,t),this},e.prototype.unset=function(e){return this._safeSet(u.UNSET,e,y.q$),this},e.prototype.clearAll=function(){return this._properties={},this._properties[u.CLEAR_ALL]=y.q$,this},e.prototype._safeSet=function(e,t,n){if(this._validate(e,t,n)){var r=this._properties[e];return void 0===r&&(r={},this._properties[e]=r),r[t]=n,this._propertySet.add(t),!0}return!1},e.prototype._validate=function(e,t,n){return!(void 0!==this._properties[u.CLEAR_ALL]||this._propertySet.has(t))&&(e===u.ADD?"number"==typeof n:e===u.UNSET||e===u.REMOVE||k(t,n))},e}(),M=function(){function e(){this.productId="",this.quantity=1,this.price=0}return e.prototype.setProductId=function(e){return this.productId=e,this},e.prototype.setQuantity=function(e){return e>0&&(this.quantity=e),this},e.prototype.setPrice=function(e){return this.price=e,this},e.prototype.setRevenueType=function(e){return this.revenueType=e,this},e.prototype.setRevenue=function(e){return this.revenue=e,this},e.prototype.setEventProperties=function(e){return C(e)&&(this.properties=e),this},e.prototype.getEventProperties=function(){var e=this.properties?(0,v.__assign)({},this.properties):{};return e[c.REVENUE_PRODUCT_ID]=this.productId,e[c.REVENUE_QUANTITY]=this.quantity,e[c.REVENUE_PRICE]=this.price,e[c.REVENUE_TYPE]=this.revenueType,e[c.REVENUE]=this.revenue,e},e}(),x=function(){function e(e){this.client=e,this.queue=[],this.applying=!1,this.plugins=[]}return e.prototype.register=function(e,t){var n,r;return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(i){switch(i.label){case 0:if(this.plugins.some(function(t){return t.name===e.name}))return t.loggerProvider.warn("Plugin with name ".concat(e.name," already exists, skipping registration")),[2];return void 0===e.name&&(e.name=S(),t.loggerProvider.warn("Plugin name is undefined. \n      Generating a random UUID for plugin name: ".concat(e.name,". \n      Set a name for the plugin to prevent it from being added multiple times."))),e.type=null!==(n=e.type)&&void 0!==n?n:"enrichment",[4,null===(r=e.setup)||void 0===r?void 0:r.call(e,t,this.client)];case 1:return i.sent(),this.plugins.push(e),[2]}})})},e.prototype.deregister=function(e){var t;return(0,v.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,v.__generator)(this,function(i){switch(i.label){case 0:return n=this.plugins.findIndex(function(t){return t.name===e}),r=this.plugins[n],this.plugins.splice(n,1),[4,null===(t=r.teardown)||void 0===t?void 0:t.call(r)];case 1:return i.sent(),[2]}})})},e.prototype.reset=function(e){this.applying=!1,this.plugins.map(function(e){var t;return null===(t=e.teardown)||void 0===t?void 0:t.call(e)}),this.plugins=[],this.client=e},e.prototype.push=function(e){var t=this;return new Promise(function(n){t.queue.push([e,n]),t.scheduleApply(0)})},e.prototype.scheduleApply=function(e){var t=this;this.applying||(this.applying=!0,setTimeout(function(){t.apply(t.queue.shift()).then(function(){t.applying=!1,t.queue.length>0&&t.scheduleApply(0)})},e))},e.prototype.apply=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,o,s,a,u,c,l,d,f,h,p;return(0,v.__generator)(this,function(g){switch(g.label){case 0:if(!e)return[2];t=(0,v.__read)(e,1)[0],n=(0,v.__read)(e,2)[1],r=this.plugins.filter(function(e){return"before"===e.type}),g.label=1;case 1:g.trys.push([1,6,7,8]),o=(i=(0,v.__values)(r)).next(),g.label=2;case 2:if(o.done)return[3,5];if(!(s=o.value).execute)return[3,4];return[4,s.execute((0,v.__assign)({},t))];case 3:if(null===(a=g.sent()))return n({event:t,code:0,message:""}),[2];t=a,g.label=4;case 4:return o=i.next(),[3,2];case 5:return[3,8];case 6:return d={error:g.sent()},[3,8];case 7:try{o&&!o.done&&(f=i.return)&&f.call(i)}finally{if(d)throw d.error}return[7];case 8:u=this.plugins.filter(function(e){return"enrichment"===e.type||void 0===e.type}),g.label=9;case 9:g.trys.push([9,14,15,16]),l=(c=(0,v.__values)(u)).next(),g.label=10;case 10:if(l.done)return[3,13];if(!(s=l.value).execute)return[3,12];return[4,s.execute((0,v.__assign)({},t))];case 11:if(null===(a=g.sent()))return n({event:t,code:0,message:""}),[2];t=a,g.label=12;case 12:return l=c.next(),[3,10];case 13:return[3,16];case 14:return h={error:g.sent()},[3,16];case 15:try{l&&!l.done&&(p=c.return)&&p.call(c)}finally{if(h)throw h.error}return[7];case 16:return Promise.all(this.plugins.filter(function(e){return"destination"===e.type}).map(function(e){var n=(0,v.__assign)({},t);return e.execute(n).catch(function(e){return b(n,0,String(e))})})).then(function(e){var r=(0,v.__read)(e,1)[0]||b(t,100,"Event not tracked, no destination plugins on the instance");n(r)}),[2]}})})},e.prototype.flush=function(){return(0,v.__awaiter)(this,void 0,void 0,function(){var e,t=this;return(0,v.__generator)(this,function(n){switch(n.label){case 0:return e=this.queue,this.queue=[],[4,Promise.all(e.map(function(e){return t.apply(e)}))];case 1:return n.sent(),[4,Promise.all(this.plugins.filter(function(e){return"destination"===e.type}).map(function(e){return e.flush&&e.flush()}))];case 2:return n.sent(),[2]}})})},e}(),O=function(e,t){return(0,v.__assign)((0,v.__assign)({},t),{event_type:l.IDENTIFY,user_properties:e.getUserProperties()})},R=function(e,t,n,r){var i;return(0,v.__assign)((0,v.__assign)({},r),{event_type:l.GROUP_IDENTIFY,group_properties:n.getUserProperties(),groups:((i={})[e]=t,i)})},P=function(e,t,n){var r,i=new T;return i.set(e,t),(0,v.__assign)((0,v.__assign)({},n),{event_type:l.IDENTIFY,user_properties:i.getUserProperties(),groups:((r={})[e]=t,r)})},N=function(){function e(e){void 0===e&&(e="$default"),this.initializing=!1,this.isReady=!1,this.q=[],this.dispatchQ=[],this.logEvent=this.track.bind(this),this.timeline=new x(this),this.name=e}return e.prototype._init=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(t){switch(t.label){case 0:return this.config=e,this.timeline.reset(this),[4,this.runQueuedFunctions("q")];case 1:return t.sent(),this.isReady=!0,[2]}})})},e.prototype.runQueuedFunctions=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,o,s;return(0,v.__generator)(this,function(a){switch(a.label){case 0:t=this[e],this[e]=[],a.label=1;case 1:a.trys.push([1,8,9,10]),r=(n=(0,v.__values)(t)).next(),a.label=2;case 2:if(r.done)return[3,7];if(!((i=(0,r.value)())&&"promise"in i))return[3,4];return[4,i.promise];case 3:return a.sent(),[3,6];case 4:return[4,i];case 5:a.sent(),a.label=6;case 6:return r=n.next(),[3,2];case 7:return[3,10];case 8:return o={error:a.sent()},[3,10];case 9:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(o)throw o.error}return[7];case 10:if(!this[e].length)return[3,12];return[4,this.runQueuedFunctions(e)];case 11:a.sent(),a.label=12;case 12:return[2]}})})},e.prototype.track=function(e,t,n){var r=(0,v.__assign)((0,v.__assign)((0,v.__assign)({},"string"==typeof e?{event_type:e}:e),n),t&&{event_properties:t});return(0,g.S)(this.dispatch(r))},e.prototype.identify=function(e,t){var n=O(e,t);return(0,g.S)(this.dispatch(n))},e.prototype.groupIdentify=function(e,t,n,r){var i=R(e,t,n,r);return(0,g.S)(this.dispatch(i))},e.prototype.setGroup=function(e,t,n){var r=P(e,t,n);return(0,g.S)(this.dispatch(r))},e.prototype.revenue=function(e,t){var n=(0,v.__assign)((0,v.__assign)({},t),{event_type:l.REVENUE,event_properties:e.getEventProperties()});return(0,g.S)(this.dispatch(n))},e.prototype.add=function(e){return this.isReady?this._addPlugin(e):(this.q.push(this._addPlugin.bind(this,e)),(0,g.S)())},e.prototype._addPlugin=function(e){return(0,g.S)(this.timeline.register(e,this.config))},e.prototype.remove=function(e){return this.isReady?this._removePlugin(e):(this.q.push(this._removePlugin.bind(this,e)),(0,g.S)())},e.prototype._removePlugin=function(e){return(0,g.S)(this.timeline.deregister(e))},e.prototype.dispatchWithCallback=function(e,t){if(!this.isReady)return t(b(e,0,"Client not initialized"));this.process(e).then(t)},e.prototype.dispatch=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,v.__generator)(this,function(n){return this.isReady?[2,this.process(e)]:[2,new Promise(function(n){t.dispatchQ.push(t.dispatchWithCallback.bind(t,e,n))})]})})},e.prototype.process=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){var t,n;return(0,v.__generator)(this,function(r){switch(r.label){case 0:if(r.trys.push([0,2,,3]),this.config.optOut)return[2,b(e,0,"Event skipped due to optOut config")];return[4,this.timeline.push(e)];case 1:return 200===(t=r.sent()).code?this.config.loggerProvider.log(t.message):100===t.code?this.config.loggerProvider.warn(t.message):this.config.loggerProvider.error(t.message),[2,t];case 2:return n=String(r.sent()),this.config.loggerProvider.error(n),[2,t=b(e,0,n)];case 3:return[2]}})})},e.prototype.setOptOut=function(e){if(!this.isReady){this.q.push(this._setOptOut.bind(this,!!e));return}this._setOptOut(e)},e.prototype._setOptOut=function(e){this.config.optOut=!!e},e.prototype.flush=function(){return(0,g.S)(this.timeline.flush())},e}(),D=function(e,t){return"boolean"==typeof e?e:(null==e?void 0:e[t])!==!1},A=function(e){return D(e,"attribution")},L=function(e){return D(e,"pageViews")},q=function(e){return D(e,"sessions")},j=function(e){return"boolean"==typeof e?e:"object"==typeof e&&(!0===e.elementInteractions||"object"==typeof e.elementInteractions)},F=function(e){if(j(e.autocapture)&&"object"==typeof e.autocapture&&"object"==typeof e.autocapture.elementInteractions)return e.autocapture.elementInteractions},U=function(e){var t,n=function(){return!1},r=void 0,i=e.pageCounter;return L(e.defaultTracking)&&(n=void 0,t=void 0,e.defaultTracking&&"object"==typeof e.defaultTracking&&e.defaultTracking.pageViews&&"object"==typeof e.defaultTracking.pageViews&&("trackOn"in e.defaultTracking.pageViews&&(n=e.defaultTracking.pageViews.trackOn),"trackHistoryChanges"in e.defaultTracking.pageViews&&(r=e.defaultTracking.pageViews.trackHistoryChanges),"eventType"in e.defaultTracking.pageViews&&e.defaultTracking.pageViews.eventType&&(t=e.defaultTracking.pageViews.eventType))),{trackOn:n,trackHistoryChanges:r,eventType:t,pageCounter:i}},z="dclid",B="fbclid",W="gbraid",V="gclid",K="ko_click_id",H="li_fat_id",G="msclkid",$="rtd_cid",J="ttclid",Y="twclid",Q="wbraid",X={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,referrer:void 0,referring_domain:void 0,dclid:void 0,gbraid:void 0,gclid:void 0,fbclid:void 0,ko_click_id:void 0,li_fat_id:void 0,msclkid:void 0,rtd_cid:void 0,ttclid:void 0,twclid:void 0,wbraid:void 0},Z=function(e){var t=e.split(".");return t.length<=2?e:t.slice(t.length-2,t.length).join(".")},ee=function(e,t,n,r){void 0===r&&(r=!0),e.referrer;var i=e.referring_domain,o=(0,v.__rest)(e,["referrer","referring_domain"]),s=t||{},a=(s.referrer,s.referring_domain),u=(0,v.__rest)(s,["referrer","referring_domain"]);if(et(n.excludeReferrers,e.referring_domain)||!r&&Object.values(e).every(function(e){return!e})&&t)return!1;var c=JSON.stringify(o)!==JSON.stringify(u),l=Z(i||"")!==Z(a||"");return!t||c||l},et=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=""),e.some(function(e){return e instanceof RegExp?e.test(t):e===t})},en=function(e){var t=e;return t?(t.startsWith(".")&&(t=t.substring(1)),[new RegExp("".concat(t.replace(".","\\."),"$"))]):[]},er=n(701522),ei=function(){var e,t=(0,er.l)();return(null===(e=null==t?void 0:t.location)||void 0===e?void 0:e.search)?t.location.search.substring(1).split("&").filter(Boolean).reduce(function(e,t){var n=t.split("=",2),r=eo(n[0]),i=eo(n[1]);return i&&(e[r]=i),e},{}):{}},eo=function(e){void 0===e&&(e="");try{return decodeURIComponent(e)}catch(e){return""}},es=function(){function e(){}return e.prototype.parse=function(){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(e){return[2,(0,v.__assign)((0,v.__assign)((0,v.__assign)((0,v.__assign)({},X),this.getUtmParam()),this.getReferrer()),this.getClickIds())]})})},e.prototype.getUtmParam=function(){var e=ei();return{utm_campaign:e.utm_campaign,utm_content:e.utm_content,utm_id:e.utm_id,utm_medium:e.utm_medium,utm_source:e.utm_source,utm_term:e.utm_term}},e.prototype.getReferrer=function(){var e,t,n={referrer:void 0,referring_domain:void 0};try{n.referrer=document.referrer||void 0,n.referring_domain=null!==(t=null===(e=n.referrer)||void 0===e?void 0:e.split("/")[2])&&void 0!==t?t:void 0}catch(e){}return n},e.prototype.getClickIds=function(){var e,t=ei();return(e={})[z]=t[z],e[B]=t[B],e[W]=t[W],e[V]=t[V],e[K]=t[K],e[H]=t[H],e[G]=t[G],e[$]=t[$],e[J]=t[J],e[Y]=t[Y],e[Q]=t[Q],e},e}(),ea=function(e,t){return void 0===t&&(t=Date.now()),Date.now()-t>e},eu=function(){function e(e,t){var n,r,i,o;this.shouldTrackNewCampaign=!1,this.options=(0,v.__assign)({initialEmptyValue:"EMPTY",resetSessionOnNewCampaign:!1,excludeReferrers:en(null===(n=t.cookieOptions)||void 0===n?void 0:n.domain)},e),this.storage=t.cookieStorage,this.storageKey=(r=t.apiKey,i="MKTG",void 0===o&&(o=10),[y.xp,i,r.substring(0,o)].filter(Boolean).join("_")),this.currentCampaign=X,this.sessionTimeout=t.sessionTimeout,this.lastEventTime=t.lastEventTime,t.loggerProvider.log("Installing web attribution tracking.")}return e.prototype.init=function(){return(0,v.__awaiter)(this,void 0,void 0,function(){var e,t;return(0,v.__generator)(this,function(n){switch(n.label){case 0:return[4,this.fetchCampaign()];case 1:if(t=v.__read.apply(void 0,[n.sent(),2]),this.currentCampaign=t[0],this.previousCampaign=t[1],e=!this.lastEventTime||ea(this.sessionTimeout,this.lastEventTime),!ee(this.currentCampaign,this.previousCampaign,this.options,e))return[3,3];return this.shouldTrackNewCampaign=!0,[4,this.storage.set(this.storageKey,this.currentCampaign)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.fetchCampaign=function(){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([new es().parse(),this.storage.get(this.storageKey)])];case 1:return[2,e.sent()]}})})},e.prototype.generateCampaignEvent=function(e){this.shouldTrackNewCampaign=!1;var t,n,r=(t=this.currentCampaign,n=this.options,O(Object.entries((0,v.__assign)((0,v.__assign)({},X),t)).reduce(function(e,t){var r,i=(0,v.__read)(t,2),o=i[0],s=i[1];return(e.setOnce("initial_".concat(o),null!==(r=null!=s?s:n.initialEmptyValue)&&void 0!==r?r:"EMPTY"),s)?e.set(o,s):e.unset(o)},new T)));return e&&(r.event_id=e),r},e.prototype.shouldSetSessionIdOnNewCampaign=function(){return this.shouldTrackNewCampaign&&!!this.options.resetSessionOnNewCampaign},e}(),ec=n(635657),el=function(){function e(){this.name="identity",this.type="before",this.identityStore=(0,ec.bM)().identityStore}return e.prototype.execute=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){var t;return(0,v.__generator)(this,function(n){return(t=e.user_properties)&&this.identityStore.editIdentity().updateUserProperties(t).commit(),[2,e]})})},e.prototype.setup=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(t){return e.instanceName&&(this.identityStore=(0,ec.bM)(e.instanceName).identityStore),[2]})})},e}(),ed=function(e,t){for(var n=0;n<t.length;n++){var r=t[n],i=r.name,o=r.args,s=r.resolve,a=e&&e[i];if("function"==typeof a){var u=a.apply(e,o);"function"==typeof s&&s(null==u?void 0:u.promise)}}return e},ef=function(e){return e&&void 0!==e._q},eh=function(){if("undefined"==typeof navigator)return"";var e,t,n,r,i=navigator.userLanguage;return null!==(r=null!==(n=null!==(t=null===(e=navigator.languages)||void 0===e?void 0:e[0])&&void 0!==t?t:navigator.language)&&void 0!==n?n:i)&&void 0!==r?r:""},ep=function(){function e(){this.name="@amplitude/plugin-context-browser",this.type="before",this.library="amplitude-ts/".concat("2.11.0"),"undefined"!=typeof navigator&&(this.userAgent=navigator.userAgent)}return e.prototype.setup=function(e){return this.config=e,Promise.resolve(void 0)},e.prototype.execute=function(e){var t,n;return(0,v.__awaiter)(this,void 0,void 0,function(){var r,i,o;return(0,v.__generator)(this,function(s){return r=new Date().getTime(),i=null!==(t=this.config.lastEventId)&&void 0!==t?t:-1,o=null!==(n=e.event_id)&&void 0!==n?n:i+1,this.config.lastEventId=o,e.time||(this.config.lastEventTime=r),[2,(0,v.__assign)((0,v.__assign)((0,v.__assign)((0,v.__assign)((0,v.__assign)((0,v.__assign)((0,v.__assign)((0,v.__assign)({user_id:this.config.userId,device_id:this.config.deviceId,session_id:this.config.sessionId,time:r},this.config.appVersion&&{app_version:this.config.appVersion}),this.config.trackingOptions.platform&&{platform:"Web"}),this.config.trackingOptions.language&&{language:eh()}),this.config.trackingOptions.ipAddress&&{ip:"$remote"}),{insert_id:S(),partner_id:this.config.partnerId,plan:this.config.plan}),this.config.ingestionMetadata&&{ingestion_metadata:{source_name:this.config.ingestionMetadata.sourceName,source_version:this.config.ingestionMetadata.sourceVersion}}),e),{event_id:o,library:this.library,user_agent:this.userAgent})]})})},e}(),ev=n(203253),eg=function(){function e(){this.memoryStorage=new Map}return e.prototype.isEnabled=function(){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(e){return[2,!0]})})},e.prototype.get=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(t){return[2,this.memoryStorage.get(e)]})})},e.prototype.getRaw=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){var t;return(0,v.__generator)(this,function(n){switch(n.label){case 0:return[4,this.get(e)];case 1:return[2,(t=n.sent())?JSON.stringify(t):void 0]}})})},e.prototype.set=function(e,t){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(n){return this.memoryStorage.set(e,t),[2]})})},e.prototype.remove=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(t){return this.memoryStorage.delete(e),[2]})})},e.prototype.reset=function(){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(e){return this.memoryStorage.clear(),[2]})})},e}(),em=n(629790),ey=function(e,t,n){return void 0===t&&(t=""),void 0===n&&(n=10),[y.xp,t,e.substring(0,n)].filter(Boolean).join("_")},e_=function(){function e(e){this.options=(0,v.__assign)({},e)}return e.prototype.isEnabled=function(){return(0,v.__awaiter)(this,void 0,void 0,function(){var t,n;return(0,v.__generator)(this,function(r){switch(r.label){case 0:if(!(0,er.l)())return[2,!1];e.testValue=String(Date.now()),t=new e(this.options),n="AMP_TEST",r.label=1;case 1:return r.trys.push([1,4,5,7]),[4,t.set(n,e.testValue)];case 2:return r.sent(),[4,t.get(n)];case 3:return[2,r.sent()===e.testValue];case 4:return r.sent(),[2,!1];case 5:return[4,t.remove(n)];case 6:return r.sent(),[7];case 7:return[2]}})})},e.prototype.get=function(e){var t;return(0,v.__awaiter)(this,void 0,void 0,function(){var n,r;return(0,v.__generator)(this,function(i){switch(i.label){case 0:return[4,this.getRaw(e)];case 1:if(!(n=i.sent()))return[2,void 0];try{if(r=null!==(t=eb(n))&&void 0!==t?t:ew(n),void 0===r)return console.error("Amplitude Logger [Error]: Failed to decode cookie value for key: ".concat(e,", value: ").concat(n)),[2,void 0];return[2,JSON.parse(r)]}catch(t){return console.error("Amplitude Logger [Error]: Failed to parse cookie value for key: ".concat(e,", value: ").concat(n)),[2,void 0]}return[2]}})})},e.prototype.getRaw=function(e){var t,n;return(0,v.__awaiter)(this,void 0,void 0,function(){var r,i;return(0,v.__generator)(this,function(o){return(i=(null!==(n=null===(t=null==(r=(0,er.l)())?void 0:r.document)||void 0===t?void 0:t.cookie.split("; "))&&void 0!==n?n:[]).find(function(t){return 0===t.indexOf(e+"=")}))?[2,i.substring(e.length+1)]:[2,void 0]})})},e.prototype.set=function(e,t){var n;return(0,v.__awaiter)(this,void 0,void 0,function(){var r,i,o,s,a,u,c;return(0,v.__generator)(this,function(l){try{r=null!==(n=this.options.expirationDays)&&void 0!==n?n:0,i=null!==t?r:-1,o=void 0,i&&((s=new Date).setTime(s.getTime()+864e5*i),o=s),a="".concat(e,"=").concat(btoa(encodeURIComponent(JSON.stringify(t)))),o&&(a+="; expires=".concat(o.toUTCString())),a+="; path=/",this.options.domain&&(a+="; domain=".concat(this.options.domain)),this.options.secure&&(a+="; Secure"),this.options.sameSite&&(a+="; SameSite=".concat(this.options.sameSite)),(u=(0,er.l)())&&(u.document.cookie=a)}catch(t){c=t instanceof Error?t.message:String(t),console.error("Amplitude Logger [Error]: Failed to set cookie for key: ".concat(e,". Error: ").concat(c))}return[2]})})},e.prototype.remove=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(t){switch(t.label){case 0:return[4,this.set(e,null)];case 1:return t.sent(),[2]}})})},e.prototype.reset=function(){return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(e){return[2]})})},e}(),eb=function(e){try{return decodeURIComponent(atob(e))}catch(e){return}},ew=function(e){try{return decodeURIComponent(atob(decodeURIComponent(e)))}catch(e){return}},eS=n(522879),eI=function(){function e(e){this.storage=e}return e.prototype.isEnabled=function(){return(0,v.__awaiter)(this,void 0,void 0,function(){var t,n,r;return(0,v.__generator)(this,function(i){switch(i.label){case 0:if(!this.storage)return[2,!1];t=String(Date.now()),n=new e(this.storage),r="AMP_TEST",i.label=1;case 1:return i.trys.push([1,4,5,7]),[4,n.set(r,t)];case 2:return i.sent(),[4,n.get(r)];case 3:return[2,i.sent()===t];case 4:return i.sent(),[2,!1];case 5:return[4,n.remove(r)];case 6:return i.sent(),[7];case 7:return[2]}})})},e.prototype.get=function(e){return(0,v.__awaiter)(this,void 0,void 0,function(){var t;return(0,v.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getRaw(e)];case 1:if(!(t=n.sent()))return[2,void 0];return[2,JSON.parse(t)];case 2:return n.sent(),console.error("[Amplitude] Error: Could not get value from storage"),[2,void 0];case 3:return[2]}})})},e.prototype.getRaw=function(e){var t;return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(n){return[2,(null===(t=this.storage)||void 0===t?void 0:t.getItem(e))||void 0]})})},e.prototype.set=function(e,t){var n;return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(r){try{null===(n=this.storage)||void 0===n||n.setItem(e,JSON.stringify(t))}catch(e){}return[2]})})},e.prototype.remove=function(e){var t;return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(n){try{null===(t=this.storage)||void 0===t||t.removeItem(e)}catch(e){}return[2]})})},e.prototype.reset=function(){var e;return(0,v.__awaiter)(this,void 0,void 0,function(){return(0,v.__generator)(this,function(t){try{null===(e=this.storage)||void 0===e||e.clear()}catch(e){}return[2]})})},e}(),eE=function(e){function t(t){var n,r=this;return(r=e.call(this,null===(n=(0,er.l)())||void 0===n?void 0:n.localStorage)||this).loggerProvider=null==t?void 0:t.loggerProvider,r}return(0,v.__extends)(t,e),t.prototype.set=function(t,n){var r;return(0,v.__awaiter)(this,void 0,void 0,function(){var i;return(0,v.__generator)(this,function(o){switch(o.label){case 0:if(!(Array.isArray(n)&&n.length>1e3))return[3,2];return i=n.length-1e3,[4,e.prototype.set.call(this,t,n.slice(0,1e3))];case 1:return o.sent(),null===(r=this.loggerProvider)||void 0===r||r.error("Failed to save ".concat(i," events because the queue length exceeded ").concat(1e3,".")),[3,4];case 2:return[4,e.prototype.set.call(this,t,n)];case 3:o.sent(),o.label=4;case 4:return[2]}})})},t}(eI),eC=function(e){function t(){var t;return e.call(this,null===(t=(0,er.l)())||void 0===t?void 0:t.sessionStorage)||this}return(0,v.__extends)(t,e),t}(eI),ek=n(327704),eT=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={done:4},t}return(0,v.__extends)(t,e),t.prototype.send=function(e,t){return(0,v.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,v.__generator)(this,function(r){return[2,new Promise(function(r,i){"undefined"==typeof XMLHttpRequest&&i(Error("XHRTransport is not supported."));var o=new XMLHttpRequest;o.open("POST",e,!0),o.onreadystatechange=function(){if(o.readyState===n.state.done){var e=o.responseText;try{r(n.buildResponse(JSON.parse(e)))}catch(e){r(n.buildResponse({code:o.status}))}}},o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept","*/*"),o.send(JSON.stringify(t))})]})})},t}(ek.d),eM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,v.__extends)(t,e),t.prototype.send=function(e,t){return(0,v.__awaiter)(this,void 0,void 0,function(){var n=this;return(0,v.__generator)(this,function(r){return[2,new Promise(function(r,i){var o=(0,er.l)();if(!(null==o?void 0:o.navigator.sendBeacon))throw Error("SendBeaconTransport is not supported");try{var s=JSON.stringify(t);if(o.navigator.sendBeacon(e,JSON.stringify(t)))return r(n.buildResponse({code:200,events_ingested:t.events.length,payload_size_bytes:s.length,server_upload_time:Date.now()}));return r(n.buildResponse({code:500}))}catch(e){i(e)}})]})})},t}(ek.d),ex=function(e){var t=parseInt(e,32);if(!isNaN(t))return t},eO=function(e){if(atob&&escape&&e)try{return decodeURIComponent(escape(atob(e)))}catch(e){return}},eR="[Amplitude]",eP="".concat(eR," Form Started"),eN="".concat(eR," Form Submitted"),eD="".concat(eR," File Downloaded"),eA="session_start",eL="session_end",eq="".concat(eR," File Extension"),ej="".concat(eR," File Name"),eF="".concat(eR," Link ID"),eU="".concat(eR," Link Text"),ez="".concat(eR," Link URL"),eB="".concat(eR," Form ID"),eW="".concat(eR," Form Name"),eV="".concat(eR," Form Destination"),eK="cookie",eH=function(e){function t(t,n,r,i,o,s,a,u,c,l,d,f,h,p,v,g,m,y,_,b,w,S,I,E,C,k,T,M,x,O,R,P,N,D){void 0===r&&(r=new eg),void 0===i&&(i={domain:"",expiration:365,sameSite:"Lax",secure:!1,upgrade:!0}),void 0===u&&(u=1e3),void 0===c&&(c=5),void 0===l&&(l=30),void 0===d&&(d=eK),void 0===g&&(g=new em.Y),void 0===m&&(m=ev.i.Warn),void 0===_&&(_=!1),void 0===b&&(b=!1),void 0===I&&(I=""),void 0===E&&(E="US"),void 0===k&&(k=18e5),void 0===T&&(T=new eE({loggerProvider:g})),void 0===M&&(M={ipAddress:!0,language:!0,platform:!0}),void 0===x&&(x="fetch"),void 0===O&&(O=!1),void 0===R&&(R=!1);var A=e.call(this,{apiKey:t,storageProvider:T,transportProvider:e$(x)})||this;return A.apiKey=t,A.appVersion=n,A.cookieOptions=i,A.defaultTracking=o,A.autocapture=s,A.flushIntervalMillis=u,A.flushMaxRetries=c,A.flushQueueSize=l,A.identityStorage=d,A.ingestionMetadata=f,A.instanceName=h,A.loggerProvider=g,A.logLevel=m,A.minIdLength=y,A.offline=_,A.partnerId=w,A.plan=S,A.serverUrl=I,A.serverZone=E,A.sessionTimeout=k,A.storageProvider=T,A.trackingOptions=M,A.transport=x,A.useBatch=O,A.fetchRemoteConfig=R,A._optOut=!1,A._cookieStorage=r,A.deviceId=a,A.lastEventId=p,A.lastEventTime=v,A.optOut=b,A.sessionId=C,A.pageCounter=N,A.userId=P,A.debugLogsEnabled=D,A.loggerProvider.enable(D?ev.i.Debug:A.logLevel),A}return(0,v.__extends)(t,e),Object.defineProperty(t.prototype,"cookieStorage",{get:function(){return this._cookieStorage},set:function(e){this._cookieStorage!==e&&(this._cookieStorage=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceId",{get:function(){return this._deviceId},set:function(e){this._deviceId!==e&&(this._deviceId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this._userId},set:function(e){this._userId!==e&&(this._userId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){return this._sessionId},set:function(e){this._sessionId!==e&&(this._sessionId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut!==e&&(this._optOut=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventTime",{get:function(){return this._lastEventTime},set:function(e){this._lastEventTime!==e&&(this._lastEventTime=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventId",{get:function(){return this._lastEventId},set:function(e){this._lastEventId!==e&&(this._lastEventId=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageCounter",{get:function(){return this._pageCounter},set:function(e){this._pageCounter!==e&&(this._pageCounter=e,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"debugLogsEnabled",{set:function(e){this._debugLogsEnabled!==e&&(this._debugLogsEnabled=e,this.updateStorage())},enumerable:!1,configurable:!0}),t.prototype.updateStorage=function(){var e={deviceId:this._deviceId,userId:this._userId,sessionId:this._sessionId,optOut:this._optOut,lastEventTime:this._lastEventTime,lastEventId:this._lastEventId,pageCounter:this._pageCounter,debugLogsEnabled:this._debugLogsEnabled};this.cookieStorage.set(ey(this.apiKey),e)},t}(w.De),eG=function(e,t){switch(void 0===e&&(e=eK),void 0===t&&(t={}),e){case"localStorage":return new eE;case"sessionStorage":return new eC;case"none":return new eg;default:return new e_((0,v.__assign)((0,v.__assign)({},t),{expirationDays:t.expiration}))}},e$=function(e){return"xhr"===e?new eT:"beacon"===e?new eM:new eS.V},eJ=function(e){var t={};for(var n in e){var r=e[n];r&&(t[n]=r)}return t},eY=function(e){void 0===e&&(e={});var t,n,r,i=(0,er.l)(),o=void 0,s=e.trackOn,a=e.trackHistoryChanges,u=e.eventType,c=void 0===u?"[Amplitude] Page Viewed":u,l=function(){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var e,t;return(0,v.__generator)(this,function(n){switch(n.label){case 0:return t={event_type:c},e=[{}],[4,eQ()];case 1:return[2,(t.event_properties=v.__assign.apply(void 0,[v.__assign.apply(void 0,e.concat([n.sent()])),{"[Amplitude] Page Domain":"undefined"!=typeof location&&location.hostname||"","[Amplitude] Page Location":"undefined"!=typeof location&&location.href||"","[Amplitude] Page Path":"undefined"!=typeof location&&location.pathname||"","[Amplitude] Page Title":"undefined"!=typeof document&&document.title||"","[Amplitude] Page URL":"undefined"!=typeof location&&location.href.split("?")[0]||""}]),t)]}})})},d=function(){return void 0===s||"function"==typeof s&&s()},f="undefined"!=typeof location?location.href:null,h=function(){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var e,n,r,i;return(0,v.__generator)(this,function(s){switch(s.label){case 0:if(n=eZ(a,e=location.href,f||"")&&d(),f=e,!n)return[3,4];if(null==o||o.log("Tracking page view event"),null!=t)return[3,1];return[3,3];case 1:return i=(r=t).track,[4,l()];case 2:i.apply(r,[s.sent()]),s.label=3;case 3:s.label=4;case 4:return[2]}})})},p=function(){h()};return{name:"@amplitude/plugin-page-view-tracking-browser",type:"enrichment",setup:function(e,s){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var a,u;return(0,v.__generator)(this,function(c){switch(c.label){case 0:if(t=s,r=e,(o=e.loggerProvider).log("Installing @amplitude/plugin-page-view-tracking-browser"),i&&(i.addEventListener("popstate",p),n=i.history.pushState,i.history.pushState=new Proxy(i.history.pushState,{apply:function(e,t,n){var r=(0,v.__read)(n,3),i=r[0],o=r[1],s=r[2];e.apply(t,[i,o,s]),h()}})),!d())return[3,2];return o.log("Tracking page view event"),u=(a=t).track,[4,l()];case 1:u.apply(a,[c.sent()]),c.label=2;case 2:return[2]}})})},execute:function(e){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var t;return(0,v.__generator)(this,function(n){switch(n.label){case 0:if(!("attribution"===s&&eX(e)))return[3,2];return null==o||o.log("Enriching campaign event to page view event with campaign parameters"),[4,l()];case 1:t=n.sent(),e.event_type=t.event_type,e.event_properties=(0,v.__assign)((0,v.__assign)({},e.event_properties),t.event_properties),n.label=2;case 2:return r&&e.event_type===c&&(r.pageCounter=r.pageCounter?r.pageCounter+1:1,e.event_properties=(0,v.__assign)((0,v.__assign)({},e.event_properties),{"[Amplitude] Page Counter":r.pageCounter})),[2,e]}})})},teardown:function(){return(0,v.__awaiter)(void 0,void 0,void 0,function(){return(0,v.__generator)(this,function(e){return i&&(i.removeEventListener("popstate",p),n&&(i.history.pushState=n)),[2]})})}}},eQ=function(){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,v.__generator)(this,function(t){switch(t.label){case 0:return e=eJ,[4,new es().parse()];case 1:return[2,e.apply(void 0,[t.sent()])]}})})},eX=function(e){if("$identify"===e.event_type&&e.user_properties){var t=e.user_properties,n=t[u.SET]||{},r=t[u.UNSET]||{},i=(0,v.__spreadArray)((0,v.__spreadArray)([],(0,v.__read)(Object.keys(n)),!1),(0,v.__read)(Object.keys(r)),!1);return Object.keys(X).every(function(e){return i.includes(e)})}return!1},eZ=function(e,t,n){return"pathOnly"===e?t.split("?")[0]!==n.split("?")[0]:t!==n},e0=function(){var e,t=[],n=function(e,n,r){e.addEventListener(n,r),t.push({element:e,type:n,handler:r})},r=function(){t.forEach(function(e){var t=e.element,n=e.type,r=e.handler;null==t||t.removeEventListener(n,r)}),t=[]};return{name:"@amplitude/plugin-form-interaction-tracking-browser",type:"enrichment",setup:function(t,r){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var i;return(0,v.__generator)(this,function(o){return null===(i=(0,er.l)())||void 0===i||i.addEventListener("load",function(){if(!r){t.loggerProvider.warn("Form interaction tracking requires a later version of @amplitude/analytics-browser. Form interaction events are not tracked.");return}if("undefined"!=typeof document){var i=function(e){var t=!1;n(e,"change",function(){var n;t||r.track(eP,((n={})[eB]=e1(e.id),n[eW]=e1(e.name),n[eV]=e.action,n)),t=!0}),n(e,"submit",function(){var n,i;t||r.track(eP,((n={})[eB]=e1(e.id),n[eW]=e1(e.name),n[eV]=e.action,n)),r.track(eN,((i={})[eB]=e1(e.id),i[eW]=e1(e.name),i[eV]=e.action,i)),t=!1})};Array.from(document.getElementsByTagName("form")).forEach(i),"undefined"!=typeof MutationObserver&&(e=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){"FORM"===e.nodeName&&i(e),"querySelectorAll"in e&&"function"==typeof e.querySelectorAll&&Array.from(e.querySelectorAll("form")).map(i)})})})).observe(document.body,{subtree:!0,childList:!0})}}),[2]})})},execute:function(e){return(0,v.__awaiter)(void 0,void 0,void 0,function(){return(0,v.__generator)(this,function(t){return[2,e]})})},teardown:function(){return(0,v.__awaiter)(void 0,void 0,void 0,function(){return(0,v.__generator)(this,function(t){return null==e||e.disconnect(),r(),[2]})})}}},e1=function(e){if("string"==typeof e)return e},e2=function(){var e,t=[],n=function(e,n,r){e.addEventListener(n,r),t.push({element:e,type:n,handler:r})},r=function(){t.forEach(function(e){var t=e.element,n=e.type,r=e.handler;null==t||t.removeEventListener(n,r)}),t=[]};return{name:"@amplitude/plugin-file-download-tracking-browser",type:"enrichment",setup:function(t,r){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var i;return(0,v.__generator)(this,function(o){return null===(i=(0,er.l)())||void 0===i||i.addEventListener("load",function(){if(!r){t.loggerProvider.warn("File download tracking requires a later version of @amplitude/analytics-browser. File download events are not tracked.");return}if("undefined"!=typeof document){var i=function(e){try{t=new URL(e.href,window.location.href)}catch(e){return}var t,i=o.exec(t.href),s=null==i?void 0:i[1];s&&n(e,"click",function(){var n;s&&r.track(eD,((n={})[eq]=s,n[ej]=t.pathname,n[eF]=e.id,n[eU]=e.text,n[ez]=e.href,n))})},o=/\.(pdf|xlsx?|docx?|txt|rtf|csv|exe|key|pp(s|t|tx)|7z|pkg|rar|gz|zip|avi|mov|mp4|mpe?g|wmv|midi?|mp3|wav|wma)$/;Array.from(document.getElementsByTagName("a")).forEach(i),"undefined"!=typeof MutationObserver&&(e=new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){"A"===e.nodeName&&i(e),"querySelectorAll"in e&&"function"==typeof e.querySelectorAll&&Array.from(e.querySelectorAll("a")).map(i)})})})).observe(document.body,{subtree:!0,childList:!0})}}),[2]})})},execute:function(e){return(0,v.__awaiter)(void 0,void 0,void 0,function(){return(0,v.__generator)(this,function(t){return[2,e]})})},teardown:function(){return(0,v.__awaiter)(void 0,void 0,void 0,function(){return(0,v.__generator)(this,function(t){return null==e||e.disconnect(),r(),[2]})})}}},e3=!1,e4=function(e){e3||void 0!==e.defaultTracking||(e.loggerProvider.warn("`options.defaultTracking` is set to undefined. This implicitly configures your Amplitude instance to track Page Views, Sessions, File Downloads, and Form Interactions. You can suppress this warning by explicitly setting a value to `options.defaultTracking`. The value must either be a boolean, to enable and disable all default events, or an object, for advanced configuration. For example:\n\namplitude.init(<YOUR_API_KEY>, {\n  defaultTracking: true,\n});\n\nVisit https://www.docs.developers.amplitude.com/data/sdks/browser-2/#tracking-default-events for more details."),e3=!0)},e5=function(){var e=(0,er.l)(),t=[],n=function(n,r){e&&(e.addEventListener(n,r),t.push({type:n,handler:r}))},r=function(){t.forEach(function(t){var n=t.type,r=t.handler;e&&e.removeEventListener(n,r)}),t=[]};return{name:"@amplitude/plugin-network-checker-browser",type:"before",setup:function(e,t){return(0,v.__awaiter)(void 0,void 0,void 0,function(){return(0,v.__generator)(this,function(r){return e.offline=!navigator.onLine,n("online",function(){e.loggerProvider.debug("Network connectivity changed to online."),e.offline=!1,setTimeout(function(){t.flush()},e.flushIntervalMillis)}),n("offline",function(){e.loggerProvider.debug("Network connectivity changed to offline."),e.offline=!0}),[2]})})},teardown:function(){return(0,v.__awaiter)(void 0,void 0,void 0,function(){return(0,v.__generator)(this,function(e){return r(),[2]})})}}},e6=n(441063),e8=n(997172),e7=function(e,t){return(0,v.__awaiter)(void 0,void 0,void 0,function(){return(0,v.__generator)(this,function(n){switch(n.label){case 0:return[4,(0,e8.X3)(e,1,{upgrade:function(e){t.forEach(function(t){e.objectStoreNames.contains(t)||e.createObjectStore(t)})}})];case 1:return[2,n.sent()]}})})},e9=function(e){var t=e.loggerProvider,n=e.apiKey,r=e.configKeys;return(0,v.__awaiter)(void 0,void 0,void 0,function(){var e,i,o,s,a;return(0,v.__generator)(this,function(u){switch(u.label){case 0:return[4,e7(e="".concat(n.substring(0,10),"_amp_config"),r)];case 1:var c;return i=u.sent(),[4,(c="".concat(n.substring(0,10),"_amp_config_meta"),(0,v.__awaiter)(void 0,void 0,void 0,function(){return(0,v.__generator)(this,function(e){switch(e.label){case 0:return[4,(0,e8.X3)(c,1,{upgrade:function(e){e.objectStoreNames.contains("lastFetchedSessionId")||e.createObjectStore("lastFetchedSessionId")}})];case 1:return[2,e.sent()]}})}))];case 2:o=u.sent(),u.label=3;case 3:return u.trys.push([3,8,,9]),[4,o.get("lastFetchedSessionId","sessionId")];case 4:if(!((s=u.sent())&&Date.now()-s>=2592e5))return[3,7];return i.close(),[4,(0,e8.Lj)(e)];case 5:return u.sent(),[4,e7(e,r)];case 6:i=u.sent(),u.label=7;case 7:return[3,9];case 8:return a=u.sent(),t.warn("Failed to reset store: ".concat(a)),[3,9];case 9:return[2,{storeRemoteConfig:function(e,n){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var r,s,a,u,c,l;return(0,v.__generator)(this,function(d){switch(d.label){case 0:if(d.trys.push([0,7,,8]),!n)return[3,2];return[4,o.put("lastFetchedSessionId",n,"sessionId")];case 1:d.sent(),d.label=2;case 2:for(u in r=function(t){var n,r;return(0,v.__generator)(this,function(o){switch(o.label){case 0:return n=e.configs[t],r=i.transaction(t,"readwrite"),[4,Promise.all((0,v.__spreadArray)((0,v.__spreadArray)([],(0,v.__read)(Object.keys(n).map(function(e){return r.store.put((0,v.__assign)({},n[e]),e)})),!1),[r.done],!1))];case 1:return o.sent(),[2]}})},s=e.configs,a=[],s)a.push(u);c=0,d.label=3;case 3:if(!(c<a.length))return[3,6];if(!((u=a[c])in s))return[3,5];return[5,r(u)];case 4:d.sent(),d.label=5;case 5:return c++,[3,3];case 6:return[3,8];case 7:return l=d.sent(),t.warn("Failed to store remote config: ".concat(l)),[3,8];case 8:return[2]}})})},getRemoteConfig:function(e,n){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var r;return(0,v.__generator)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,i.get(e,n)];case 1:return[2,o.sent()];case 2:return r=o.sent(),t.warn("Failed to fetch remote config: ".concat(r)),[3,3];case 3:return[2,void 0]}})})},getLastFetchedSessionId:function(){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,v.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,o.get("lastFetchedSessionId","sessionId")];case 1:return[2,n.sent()];case 2:return e=n.sent(),t.warn("Failed to fetch lastFetchedSessionId: ".concat(e)),[3,3];case 3:return[2,void 0]}})})},remoteConfigHasValues:function(e){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var n;return(0,v.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,i.getAll(e)];case 1:return[2,!!r.sent().length];case 2:return n=r.sent(),t.warn("Failed to fetch remote config: ".concat(n)),[3,3];case 3:return[2,!1]}})})}}]}})})},te="Remote config fetch rejected due to timeout after 5 seconds",tt=function(){function e(e){var t=e.localConfig,n=e.configKeys,r=this;this.retryTimeout=1e3,this.attempts=0,this.sessionTargetingMatch=!1,this.metrics={},this.getRemoteConfig=function(e,t,n){return(0,v.__awaiter)(r,void 0,void 0,function(){var r,i,o,s,a;return(0,v.__generator)(this,function(u){switch(u.label){case 0:if(r=Date.now(),!this.remoteConfigIDBStore)return[3,3];return[4,this.remoteConfigIDBStore.getLastFetchedSessionId()];case 1:if(!((i=u.sent())&&n&&i===n))return[3,3];return[4,this.remoteConfigIDBStore.getRemoteConfig(e,t)];case 2:return o=u.sent(),this.metrics.fetchTimeIDB=Date.now()-r,[2,o];case 3:return[4,this.fetchWithTimeout(n)];case 4:if((s=u.sent())&&(a=s.configs&&s.configs[e]))return this.metrics.fetchTimeAPISuccess=Date.now()-r,[2,a[t]];return this.metrics.fetchTimeAPIFail=Date.now()-r,[2,void 0]}})})},this.fetchWithTimeout=function(e){return(0,v.__awaiter)(r,void 0,void 0,function(){var t,n,r;return(0,v.__generator)(this,function(i){switch(i.label){case 0:return t=new AbortController,n=setTimeout(function(){return t.abort()},5e3),[4,this.fetchRemoteConfig(t.signal,e)];case 1:return r=i.sent(),clearTimeout(n),[2,r]}})})},this.fetchRemoteConfig=function(e,t){return(0,v.__awaiter)(r,void 0,void 0,function(){var n,r,i,o,s;return(0,v.__generator)(this,function(a){switch(a.label){case 0:if(t===this.lastFetchedSessionId&&this.attempts>=this.localConfig.flushMaxRetries)return[2,this.completeRequest({err:"Remote config fetch rejected due to exceeded retry count"})];if(e.aborted)return[2,this.completeRequest({err:te})];t!==this.lastFetchedSessionId&&(this.lastFetchedSessionId=t,this.attempts=0),a.label=1;case 1:return a.trys.push([1,3,,4]),n=new URLSearchParams({api_key:this.localConfig.apiKey,config_keys:this.configKeys.join(",")}),r={headers:{"Content-Type":"application/json",Accept:"*/*"},method:"GET"},i="".concat(this.getServerUrl(),"?").concat(n.toString()),this.attempts+=1,[4,fetch(i,(0,v.__assign)((0,v.__assign)({},r),{signal:e}))];case 2:if(null===(o=a.sent()))return[2,this.completeRequest({err:"Unexpected error occurred"})];switch(new ek.d().buildStatus(o.status)){case m.q.Success:return this.attempts=0,[2,this.parseAndStoreConfig(o,t)];case m.q.Failed:return[2,this.retryFetch(e,t)];default:return[2,this.completeRequest({err:"Network error occurred, remote config fetch failed"})]}return[3,4];case 3:if(s=a.sent(),e.aborted)return[2,this.completeRequest({err:te})];return[2,this.completeRequest({err:s.message})];case 4:return[2]}})})},this.retryFetch=function(e,t){return(0,v.__awaiter)(r,void 0,void 0,function(){var n=this;return(0,v.__generator)(this,function(r){switch(r.label){case 0:return[4,new Promise(function(e){return setTimeout(e,n.attempts*n.retryTimeout)})];case 1:return r.sent(),[2,this.fetchRemoteConfig(e,t)]}})})},this.parseAndStoreConfig=function(e,t){return(0,v.__awaiter)(r,void 0,void 0,function(){var n;return(0,v.__generator)(this,function(r){switch(r.label){case 0:return[4,e.json()];case 1:if(n=r.sent(),!this.remoteConfigIDBStore)return[3,3];return[4,this.remoteConfigIDBStore.storeRemoteConfig(n,t)];case 2:r.sent(),r.label=3;case 3:return this.completeRequest({success:"Remote config successfully fetched"}),[2,n]}})})},this.localConfig=t,this.configKeys=n}return e.prototype.initialize=function(){return(0,v.__awaiter)(this,void 0,void 0,function(){var e;return(0,v.__generator)(this,function(t){switch(t.label){case 0:return e=this,[4,e9({apiKey:this.localConfig.apiKey,loggerProvider:this.localConfig.loggerProvider,configKeys:this.configKeys})];case 1:return e.remoteConfigIDBStore=t.sent(),[2]}})})},e.prototype.getServerUrl=function(){return this.localConfig.serverZone===e6.J.STAGING?"https://sr-client-cfg.stag2.amplitude.com/config":this.localConfig.serverZone===e6.J.EU?"https://sr-client-cfg.eu.amplitude.com/config":"https://sr-client-cfg.amplitude.com/config"},e.prototype.completeRequest=function(e){var t=e.err,n=e.success;if(t)throw Error(t);n&&this.localConfig.loggerProvider.log(n)},e}(),tn=function(e){var t=e.localConfig,n=e.configKeys;return(0,v.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,v.__generator)(this,function(r){switch(r.label){case 0:return[4,(e=new tt({localConfig:t,configKeys:n})).initialize()];case 1:return r.sent(),[2,e]}})})},tr=function(){function e(e){this.config=e,this.config.loggerProvider.debug("Local configuration before merging with remote config",JSON.stringify(this.config,null,2))}return e.prototype.initialize=function(){return(0,v.__awaiter)(this,void 0,void 0,function(){var e;return(0,v.__generator)(this,function(t){switch(t.label){case 0:return e=this,[4,tn({localConfig:this.config,configKeys:["analyticsSDK"]})];case 1:return e.remoteConfigFetch=t.sent(),[2]}})})},e.prototype.generateJoinedConfig=function(){var e,t,n,r,i;return(0,v.__awaiter)(this,void 0,void 0,function(){var o,s,a;return(0,v.__generator)(this,function(u){switch(u.label){case 0:if(u.trys.push([0,3,,4]),!(s=this.remoteConfigFetch))return[3,2];return[4,this.remoteConfigFetch.getRemoteConfig("analyticsSDK","browserSDK",this.config.sessionId)];case 1:s=u.sent(),u.label=2;case 2:return o=s,this.config.loggerProvider.debug("Remote configuration:",JSON.stringify(o,null,2)),o&&"autocapture"in o&&("boolean"==typeof o.autocapture&&(this.config.autocapture=o.autocapture),"object"==typeof o.autocapture&&(void 0===this.config.autocapture&&(this.config.autocapture=o.autocapture),"boolean"==typeof this.config.autocapture&&(this.config.autocapture=(0,v.__assign)({attribution:this.config.autocapture,fileDownloads:this.config.autocapture,formInteractions:this.config.autocapture,pageViews:this.config.autocapture,sessions:this.config.autocapture,elementInteractions:this.config.autocapture},o.autocapture)),"object"==typeof this.config.autocapture&&(this.config.autocapture=(0,v.__assign)((0,v.__assign)({},this.config.autocapture),o.autocapture))),this.config.defaultTracking=this.config.autocapture),this.config.loggerProvider.debug("Joined configuration: ",JSON.stringify(this.config,null,2)),null!==(e=(i=this.config).requestMetadata)&&void 0!==e||(i.requestMetadata=new w.Dg),(null===(t=this.remoteConfigFetch)||void 0===t?void 0:t.metrics.fetchTimeIDB)&&this.config.requestMetadata.recordHistogram("remote_config_fetch_time_IDB",this.remoteConfigFetch.metrics.fetchTimeIDB),(null===(n=this.remoteConfigFetch)||void 0===n?void 0:n.metrics.fetchTimeAPISuccess)&&this.config.requestMetadata.recordHistogram("remote_config_fetch_time_API_success",this.remoteConfigFetch.metrics.fetchTimeAPISuccess),(null===(r=this.remoteConfigFetch)||void 0===r?void 0:r.metrics.fetchTimeAPIFail)&&this.config.requestMetadata.recordHistogram("remote_config_fetch_time_API_fail",this.remoteConfigFetch.metrics.fetchTimeAPIFail),[3,4];case 3:return a=u.sent(),this.config.loggerProvider.error("Failed to fetch remote configuration because of error: ",a),[3,4];case 4:return[2,this.config]}})})},e}(),ti="[Amplitude] Element Clicked",to="[Amplitude] Element Tag",ts="[Amplitude] Element Text",ta="[Amplitude] Element Selector",tu="[Amplitude] Page URL",tc="https://app.amplitude.com",tl={US:tc,EU:"https://app.eu.amplitude.com",STAGING:"https://apps.stag2.amplitude.com"},td="amp-visual-tagging-selector-highlight",tf=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function th(e){return"function"==typeof e}function tp(e){return th(null==e?void 0:e.then)}function tv(e){var t=e(function(e){Error.call(e),e.stack=Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var tg=tv(function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}});function tm(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var ty=function(){var e;function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e,t,n,r,i,o=this._parentage;if(o){if(this._parentage=null,Array.isArray(o))try{for(var s=(0,v.__values)(o),a=s.next();!a.done;a=s.next())a.value.remove(this)}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this)}var u=this.initialTeardown;if(th(u))try{u()}catch(e){i=e instanceof tg?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var l=(0,v.__values)(c),d=l.next();!d.done;d=l.next()){var f=d.value;try{tb(f)}catch(e){i=null!=i?i:[],e instanceof tg?i=(0,v.__spreadArray)((0,v.__spreadArray)([],(0,v.__read)(i)),(0,v.__read)(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}if(i)throw new tg(i)}},t.prototype.add=function(e){var n;if(e&&e!==this){if(this.closed)tb(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}},t.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},t.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},t.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&tm(t,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&tm(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=((e=new t).closed=!0,e),t}();function t_(e){return e instanceof ty||e&&"closed"in e&&th(e.remove)&&th(e.add)&&th(e.unsubscribe)}function tb(e){th(e)?e():e.unsubscribe()}ty.EMPTY;var tw={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},tS={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=tS.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,(0,v.__spreadArray)([e,t],(0,v.__read)(n))):setTimeout.apply(void 0,(0,v.__spreadArray)([e,t],(0,v.__read)(n)))},clearTimeout:function(e){var t=tS.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function tI(e){tS.setTimeout(function(){var t=tw.onUnhandledError;if(t)t(e);else throw e})}function tE(){}var tC=tk("C",void 0,void 0);function tk(e,t,n){return{kind:e,value:t,error:n}}var tT=null,tM=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,t_(t)&&t.add(n)):n.destination=tA,n}return(0,v.__extends)(t,e),t.create=function(e,t,n){return new tP(e,t,n)},t.prototype.next=function(e){this.isStopped?tD(tk("N",e,void 0),this):this._next(e)},t.prototype.error=function(e){this.isStopped?tD(tk("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?tD(tC,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(ty),tx=Function.prototype.bind;function tO(e,t){return tx.call(e,t)}var tR=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){tN(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){tN(e)}else tN(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){tN(e)}},e}(),tP=function(e){function t(t,n,r){var i,o,s=e.call(this)||this;return th(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:s&&tw.useDeprecatedNextContext?((o=Object.create(t)).unsubscribe=function(){return s.unsubscribe()},i={next:t.next&&tO(t.next,o),error:t.error&&tO(t.error,o),complete:t.complete&&tO(t.complete,o)}):i=t,s.destination=new tR(i),s}return(0,v.__extends)(t,e),t}(tM);function tN(e){tw.useDeprecatedSynchronousErrorHandling?tw.useDeprecatedSynchronousErrorHandling&&tT&&(tT.errorThrown=!0,tT.error=e):tI(e)}function tD(e,t){var n=tw.onStoppedNotification;n&&tS.setTimeout(function(){return n(e,t)})}var tA={closed:!0,next:tE,error:function(e){throw e},complete:tE},tL="function"==typeof Symbol&&Symbol.observable||"@@observable";function tq(e){return e}var tj=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,o=(r=e)&&r instanceof tM||r&&th(r.next)&&th(r.error)&&th(r.complete)&&t_(r)?e:new tP(e,t,n);return function(e){if(tw.useDeprecatedSynchronousErrorHandling){var t=!tT;if(t&&(tT={errorThrown:!1,error:null}),e(),t){var n=tT,r=n.errorThrown,i=n.error;if(tT=null,r)throw i}}else e()}(function(){var e=i.operator,t=i.source;o.add(e?e.call(o,t):t?i._subscribe(o):i._trySubscribe(o))}),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=tF(t))(function(t,r){var i=new tP({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[tL]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===e.length?tq:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)})(this)},e.prototype.toPromise=function(e){var t=this;return new(e=tF(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}();function tF(e){var t;return null!==(t=null!=e?e:tw.Promise)&&void 0!==t?t:Promise}function tU(e){return Symbol.asyncIterator&&th(null==e?void 0:e[Symbol.asyncIterator])}function tz(e){return TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var tB="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function tW(e){return th(null==e?void 0:e[tB])}function tV(e){return(0,v.__asyncGenerator)(this,arguments,function(){var t,n,r;return(0,v.__generator)(this,function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,(0,v.__await)(t.read())];case 3:if(r=(n=i.sent()).value,!n.done)return[3,5];return[4,(0,v.__await)(void 0)];case 4:return[2,i.sent()];case 5:return[4,(0,v.__await)(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function tK(e){return th(null==e?void 0:e.getReader)}function tH(e){if(e instanceof tj)return e;if(null!=e){if(th(e[tL]))return new tj(function(t){var n=e[tL]();if(th(n.subscribe))return n.subscribe(t);throw TypeError("Provided object does not correctly implement Symbol.observable")});if(tf(e))return new tj(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()});if(tp(e))return new tj(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,tI)});if(tU(e))return tG(e);if(tW(e))return new tj(function(t){var n,r;try{for(var i=(0,v.__values)(e),o=i.next();!o.done;o=i.next()){var s=o.value;if(t.next(s),t.closed)return}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}t.complete()});if(tK(e))return tG(tV(e))}throw tz(e)}function tG(e){return new tj(function(t){(function(e,t){var n,r,i,o;return(0,v.__awaiter)(this,void 0,void 0,function(){var s;return(0,v.__generator)(this,function(a){switch(a.label){case 0:a.trys.push([0,5,6,11]),n=(0,v.__asyncValues)(e),a.label=1;case 1:return[4,n.next()];case 2:if((r=a.sent()).done)return[3,4];if(s=r.value,t.next(s),t.closed)return[2];a.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return i={error:a.sent()},[3,11];case 6:if(a.trys.push([6,,9,10]),!(r&&!r.done&&(o=n.return)))return[3,8];return[4,o.call(n)];case 7:a.sent(),a.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})})(e,t).catch(function(e){return t.error(e)})})}function t$(e){return function(t){if(th(null==t?void 0:t.lift))return t.lift(function(t){try{return e(t,this)}catch(e){this.error(e)}});throw TypeError("Unable to lift unknown Observable type")}}function tJ(e,t,n,r,i){return new tY(e,t,n,r,i)}var tY=function(e){function t(t,n,r,i,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return(0,v.__extends)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),n||null===(t=this.onFinalize)||void 0===t||t.call(this)}},t}(tM);function tQ(e,t){return t$(function(n,r){var i=0;n.subscribe(tJ(r,function(n){r.next(e.call(t,n,i++))}))})}function tX(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(o),!i)return o}function tZ(e,t,n){return(void 0===n&&(n=1/0),th(t))?tZ(function(n,r){return tQ(function(e,i){return t(n,e,r,i)})(tH(e(n,r)))},n):("number"==typeof t&&(n=t),t$(function(t,r){var i,o,s,a,u,c,l,d,f;return i=n,s=[],a=0,u=0,c=!1,l=function(){!c||s.length||a||r.complete()},d=function(e){return a<i?f(e):s.push(e)},f=function(t){a++;var n=!1;tH(e(t,u++)).subscribe(tJ(r,function(e){o?d(e):r.next(e)},function(){n=!0},void 0,function(){if(n)try{for(a--;s.length&&a<i;)!function(){var e=s.shift();f(e)}();l()}catch(e){r.error(e)}}))},t.subscribe(tJ(r,d,function(){c=!0,l()})),function(){}}))}var t0=Array.isArray,t1=["addListener","removeListener"],t2=["addEventListener","removeEventListener"],t3=["on","off"];function t4(e,t,n,r){if(th(n)&&(r=n,n=void 0),r)return t4(e,t,n).pipe((i=r,tQ(function(e){return t0(e)?i.apply(void 0,(0,v.__spreadArray)([],(0,v.__read)(e))):i(e)})));var i,o=(0,v.__read)(th(e.addEventListener)&&th(e.removeEventListener)?t2.map(function(r){return function(i){return e[r](t,i,n)}}):th(e.addListener)&&th(e.removeListener)?t1.map(t5(e,t)):th(e.on)&&th(e.off)?t3.map(t5(e,t)):[],2),s=o[0],a=o[1];if(!s&&tf(e))return tZ(function(e){return t4(e,t,n)})(tH(e));if(!s)throw TypeError("Invalid event target");return new tj(function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return s(t),function(){return a(t)}})}function t5(e,t){return function(n){return function(r){return e[n](t,r)}}}function t6(e,t,n){for(var r=null,i=[],o=e,s=0;o&&"break"!==function(){var e,a,u,c,l=ni((e=o.getAttribute("id"))&&d.idName(e)?{name:"#"+CSS.escape(e),penalty:0}:null)||ni.apply(void 0,(0,v.__spreadArray)([],(0,v.__read)(Array.from(o.attributes).filter(function(e){return d.attr(e.name,e.value)}).map(function(e){return{name:"[".concat(CSS.escape(e.name),'="').concat(CSS.escape(e.value),'"]'),penalty:.5}})),!1))||ni.apply(void 0,(0,v.__spreadArray)([],(0,v.__read)(Array.from(o.classList).filter(d.className).map(function(e){return{name:"."+CSS.escape(e),penalty:1}})),!1))||ni((a=o.tagName.toLowerCase(),d.tagName(a)?{name:a,penalty:2}:null))||[nt()],f=function(e){var t=e.parentNode;if(!t)return null;var n=t.firstChild;if(!n)return null;for(var r=0;n&&(n.nodeType===Node.ELEMENT_NODE&&r++,n!==e);)n=n.nextSibling;return r}(o);if("all"==t)f&&(l=l.concat(l.filter(nr).map(function(e){return nn(e,f)})));else if("two"==t)l=l.slice(0,1),f&&(l=l.concat(l.filter(nr).map(function(e){return nn(e,f)})));else if("one"==t){var h=(0,v.__read)(l=l.slice(0,1),1)[0];f&&nr(h)&&(l=[nn(h,f)])}else"none"==t&&(l=[nt()],f&&(l=[nn(l[0],f)]));try{for(var p=(u=void 0,(0,v.__values)(l)),g=p.next();!g.done;g=p.next()){var h=g.value;h.level=s}}catch(e){u={error:e}}finally{try{g&&!g.done&&(c=p.return)&&c.call(p)}finally{if(u)throw u.error}}if(i.push(l),i.length>=d.seedMinLength&&(r=t8(i,n)))return"break";o=o.parentElement,s++}(););return(r||(r=t8(i,n)),!r&&n)?n():r}function t8(e,t){var n,r,i=ns(function e(t,n){var r,i,o,s,a;return void 0===n&&(n=[]),(0,v.__generator)(this,function(u){switch(u.label){case 0:if(!(t.length>0))return[3,9];u.label=1;case 1:u.trys.push([1,6,7,8]),i=(r=(0,v.__values)(t[0])).next(),u.label=2;case 2:if(i.done)return[3,5];return o=i.value,[5,(0,v.__values)(e(t.slice(1,t.length),n.concat(o)))];case 3:u.sent(),u.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s={error:u.sent()},[3,8];case 7:try{i&&!i.done&&(a=r.return)&&a.call(r)}finally{if(s)throw s.error}return[7];case 8:return[3,11];case 9:return[4,n];case 10:u.sent(),u.label=11;case 11:return[2]}})}(e));if(i.length>d.threshold)return t?t():null;try{for(var o=(0,v.__values)(i),s=o.next();!s.done;s=o.next()){var a=s.value;if(ne(a))return a}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return null}function t7(e){for(var t=e[0],n=t.name,r=1;r<e.length;r++){var i=e[r].level||0;n=t.level===i-1?"".concat(e[r].name," > ").concat(n):"".concat(e[r].name," ").concat(n),t=e[r]}return n}function t9(e){return e.map(function(e){return e.penalty}).reduce(function(e,t){return e+t},0)}function ne(e){var t=t7(e);switch(f.querySelectorAll(t).length){case 0:throw Error("Can't select any node with this selector: ".concat(t));case 1:return!0;default:return!1}}function nt(){return{name:"*",penalty:3}}function nn(e,t){return{name:e.name+":nth-child(".concat(t,")"),penalty:e.penalty+1}}function nr(e){return"html"!==e.name&&!e.name.startsWith("#")}function ni(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter(no);return n.length>0?n:null}function no(e){return null!=e}function ns(e){return(0,v.__spreadArray)([],(0,v.__read)(e),!1).sort(function(e,t){return t9(e)-t9(t)})}var na=["input","select","textarea"],nu=function(e,t){return function(n,r){var i,o,s,a=e.pageUrlAllowlist,u=e.shouldTrackEventResolver,c=null===(o=null===(i=null==r?void 0:r.tagName)||void 0===i?void 0:i.toLowerCase)||void 0===o?void 0:o.call(i);if(!c)return!1;if(u)return u(n,r);if(!nh(window.location.href,a))return!1;var l=(null==r?void 0:r.type)||"";if("string"==typeof l)switch(l.toLowerCase()){case"hidden":case"password":return!1}if(t&&!t.some(function(e){var t;return!!(null===(t=null==r?void 0:r.matches)||void 0===t?void 0:t.call(r,e))}))return!1;switch(c){case"input":case"select":case"textarea":return"change"===n||"click"===n;default:var d=null===(s=null==window?void 0:window.getComputedStyle)||void 0===s?void 0:s.call(window,r);if(d&&"pointer"===d.getPropertyValue("cursor")&&"click"===n)return!0;return"click"===n}}},nc=function(e){return!(null==e||"string"==typeof e&&(/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/.test((e||"").replace(/[- ]/g,""))||/(^\d{3}-?\d{2}-?\d{4}$)/.test(e)))},nl=function(e){var t,n,r,i=null===(n=null===(t=null==e?void 0:e.tagName)||void 0===t?void 0:t.toLowerCase)||void 0===n?void 0:n.call(t),o=e instanceof HTMLElement&&(null===(r=e.getAttribute("contenteditable"))||void 0===r?void 0:r.toLowerCase())==="true";return!na.includes(i)&&!o},nd=function(e){var t="";return nl(e)&&e.childNodes&&e.childNodes.length&&e.childNodes.forEach(function(e){var n="";e&&3===e.nodeType?e.textContent&&(n=e.textContent):n=nd(e),t+=n.split(/(\s+)/).filter(nc).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}),t},nf=function(e,t){var n,r,i="";try{return i=function(e,t){if(e.nodeType!==Node.ELEMENT_NODE)throw Error("Can't generate CSS selector for non-element node type.");if("html"===e.tagName.toLowerCase())return"html";var n,r={root:document.body,idName:function(e){return!0},className:function(e){return!0},tagName:function(e){return!0},attr:function(e,t){return!1},seedMinLength:1,optimizedMinLength:2,threshold:1e3,maxNumberOfTries:1e4};f=(n=(d=(0,v.__assign)((0,v.__assign)({},r),t)).root).nodeType===Node.DOCUMENT_NODE?n:n===r.root?n.ownerDocument:n;var i=t6(e,"all",function(){return t6(e,"two",function(){return t6(e,"one",function(){return t6(e,"none")})})});if(i){var o=ns(function e(t,n,r){var i,o,s;return void 0===r&&(r={counter:0,visited:new Map}),(0,v.__generator)(this,function(a){switch(a.label){case 0:if(!(t.length>2&&t.length>d.optimizedMinLength))return[3,5];i=1,a.label=1;case 1:var u;if(!(i<t.length-1))return[3,5];if(r.counter>d.maxNumberOfTries||(r.counter+=1,(o=(0,v.__spreadArray)([],(0,v.__read)(t),!1)).splice(i,1),s=t7(o),r.visited.has(s)))return[2];if(!(ne(o)&&(u=o,f.querySelector(t7(u))===n)))return[3,4];return[4,o];case 2:return a.sent(),r.visited.set(s,!0),[5,(0,v.__values)(e(o,n,r))];case 3:a.sent(),a.label=4;case 4:return i++,[3,1];case 5:return[2]}})}(i,e));return o.length>0&&(i=o[0]),t7(i)}throw Error("Selector was not found.")}(e,{className:function(e){return e!==td}})}catch(e){t&&t.warn("Failed to get selector with finder, use fallback strategy instead: ".concat(e.toString()))}var o=null===(r=null===(n=null==e?void 0:e.tagName)||void 0===n?void 0:n.toLowerCase)||void 0===r?void 0:r.call(n);if(o&&(i=o),e.id)i="#".concat(e.id);else if(e.className){var s=e.className.split(" ").filter(function(e){return e!==td}).join(".");s&&(i="".concat(i,".").concat(s))}return i},nh=function(e,t){return!t||!t.length||t.some(function(t){return"string"==typeof t?e===t:e.match(t)})},np=function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null==r||"object"==typeof r&&0===Object.keys(r).length||"string"==typeof r&&0===r.trim().length||(t[n]=r),t},{})},nv=function(e){var t=e.parentElement;if(!t)return"";var n=t.querySelector(":scope>span,h1,h2,h3,h4,h5,h6");if(n){var r=n.textContent||"";return nc(r)?r:""}return nv(t)},ng=function(e,t){return e?t.some(function(t){var n;return null===(n=null==e?void 0:e.matches)||void 0===n?void 0:n.call(e,t)})?e:ng(null==e?void 0:e.parentElement,t):null},nm=function(e,t){if(!e)return{};var n,r,i,o=null===(i=null===(r=null==e?void 0:e.tagName)||void 0===r?void 0:r.toLowerCase)||void 0===i?void 0:i.call(r),s=nf(e,t);return np(((n={})[to]=o,n[ts]=nd(e),n[ta]=s,n[tu]=window.location.href.split("?")[0],n))},ny=function(e){return null!==e.event.target&&!!e.closestTrackedAncestor},n_=function(){function e(e){var t=(void 0===e?{}:e).origin,n=this;this.endpoint=tc,this.requestCallbacks={},this.onSelect=function(e){n.notify({action:"element-selected",data:e})},this.onTrack=function(e,t){"selector-mode-changed"===e?n.notify({action:"track-selector-mode-changed",data:t}):"selector-moved"===e&&n.notify({action:"track-selector-moved",data:t})},this.endpoint=void 0===t?tc:t}return e.prototype.notify=function(e){var t,n,r,i;null===(n=null===(t=this.logger)||void 0===t?void 0:t.debug)||void 0===n||n.call(t,"Message sent: ",JSON.stringify(e)),null===(i=null===(r=window.opener)||void 0===r?void 0:r.postMessage)||void 0===i||i.call(r,e,this.endpoint)},e.prototype.sendRequest=function(e,t,n){var r=this;void 0===n&&(n={timeout:15e3});var i="".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),o={id:i,action:e,args:t};return new Promise(function(t,s){r.requestCallbacks[i]={resolve:t,reject:s},r.notify(o),(null==n?void 0:n.timeout)>0&&setTimeout(function(){s(Error("".concat(e," timed out (id: ").concat(i,")"))),delete r.requestCallbacks[i]},n.timeout)})},e.prototype.handleResponse=function(e){var t;if(!this.requestCallbacks[e.id]){null===(t=this.logger)||void 0===t||t.warn("No callback found for request id: ".concat(e.id));return}this.requestCallbacks[e.id].resolve(e.responseData),delete this.requestCallbacks[e.id]},e.prototype.setup=function(e){var t=this,n=void 0===e?{}:e,r=n.logger,i=n.endpoint,o=n.isElementSelectable,s=n.cssSelectorAllowlist,a=n.actionClickAllowlist;this.logger=r,i&&this.endpoint===tc&&(this.endpoint=i);var u=null;window.addEventListener("message",function(e){if(null===(r=null===(n=t.logger)||void 0===n?void 0:n.debug)||void 0===r||r.call(n,"Message received: ",JSON.stringify(e)),t.endpoint===e.origin){var n,r,i,c,l,d=null==e?void 0:e.data,f=null==d?void 0:d.action;if(f){if("id"in d)null===(c=null===(i=t.logger)||void 0===i?void 0:i.debug)||void 0===c||c.call(i,"Received Response to previous request: ",JSON.stringify(e)),t.handleResponse(d);else if("ping"===f)t.notify({action:"pong"});else if("initialize-visual-tagging-selector"===f){var h,p=null==d?void 0:d.data;(h="https://cdn.amplitude.com/libs/visual-tagging-selector-1.0.0-alpha.js.gz",new Promise(function(e,t){var n;try{var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src=h,r.addEventListener("load",function(){e({status:!0})},{once:!0}),r.addEventListener("error",function(){t({status:!1,message:"Failed to load the script ".concat(h)})}),null===(n=document.head)||void 0===n||n.appendChild(r)}catch(e){t(e)}})).then(function(){var e;u=null===(e=null==window?void 0:window.amplitudeVisualTaggingSelector)||void 0===e?void 0:e.call(window,{getEventTagProps:nm,isElementSelectable:function(e){return!o||o((null==p?void 0:p.actionType)||"click",e)},onTrack:t.onTrack,onSelect:t.onSelect,visualHighlightClass:td,messenger:t,cssSelectorAllowlist:s,actionClickAllowlist:a}),t.notify({action:"selector-loaded"})}).catch(function(){var e;null===(e=t.logger)||void 0===e||e.warn("Failed to initialize visual tagging selector")})}else"close-visual-tagging-selector"===f&&(null===(l=null==u?void 0:u.close)||void 0===l||l.call(u))}}}),this.notify({action:"page-loaded"})},e}(),nb=["id","class","style","value","onclick","onchange","oninput","onblur","onsubmit","onfocus","onkeydown","onkeyup","onkeypress","data-reactid","data-react-checksum","data-reactroot"],nw=["type"],nS=["svg","path","g"],nI=["password","hidden"];function nE(e,t){return t$(function(n,r){var i=0;n.subscribe(tJ(r,function(n){return e.call(t,n,i++)&&r.next(n)}))})}var nC=function(e){function t(t,n){return e.call(this)||this}return(0,v.__extends)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(ty),nk={setInterval:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=nk.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,(0,v.__spreadArray)([e,t],(0,v.__read)(n))):setInterval.apply(void 0,(0,v.__spreadArray)([e,t],(0,v.__read)(n)))},clearInterval:function(e){var t=nk.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},nT=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return(0,v.__extends)(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n,r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),nk.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&nk.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,tm(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(nC),nM={now:function(){return(nM.delegate||Date).now()},delegate:void 0},nx=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=nM.now,e}(),nO=new(function(e){function t(t,n){void 0===n&&(n=nx.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return(0,v.__extends)(t,e),t.prototype.flush=function(e){var t,n=this.actions;if(this._active){n.push(e);return}this._active=!0;do if(t=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,t){for(;e=n.shift();)e.unsubscribe();throw t}},t}(nx))(nT);function nR(e){return void 0===e&&(e=1/0),tZ(tq,e)}var nP=new tj(function(e){return e.complete()});function nN(e){return e&&th(e.schedule)}function nD(e){return e[e.length-1]}function nA(e){return nN(nD(e))?e.pop():void 0}function nL(e,t){return void 0===t&&(t=0),t$(function(n,r){n.subscribe(tJ(r,function(n){return tX(r,e,function(){return r.next(n)},t)},function(){return tX(r,e,function(){return r.complete()},t)},function(n){return tX(r,e,function(){return r.error(n)},t)}))})}function nq(e,t){return void 0===t&&(t=0),t$(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function nj(e,t){if(!e)throw Error("Iterable cannot be null");return new tj(function(n){tX(n,t,function(){var r=e[Symbol.asyncIterator]();tX(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function nF(e,t){return t?function(e,t){if(null!=e){if(th(e[tL]))return tH(e).pipe(nq(t),nL(t));if(tf(e))return new tj(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})});if(tp(e))return tH(e).pipe(nq(t),nL(t));if(tU(e))return nj(e,t);if(tW(e))return new tj(function(n){var r;return tX(n,t,function(){r=e[tB](),tX(n,t,function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){n.error(e);return}i?n.complete():n.next(t)},0,!0)}),function(){return th(null==r?void 0:r.return)&&r.return()}});if(tK(e))return nj(tV(e),t)}throw tz(e)}(e,t):tH(e)}function nU(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=nA(t),i=(e=1/0,"number"==typeof nD(t)?t.pop():e);return t.length?1===t.length?tH(t[0]):nR(i)(nF(t,r)):nP}function nz(e){return e<=0?function(){return nP}:t$(function(t,n){var r=0;t.subscribe(tJ(n,function(t){++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function nB(e){return e instanceof Date&&!isNaN(e)}var nW=tv(function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}});function nV(e){throw new nW(e)}var nK=["a","button","input","select","textarea","label","video","audio",'[contenteditable="true" i]',"[data-amp-default-track]",".amp-default-track"],nH=["div","span","h1","h2","h3","h4","h5","h6"];(s=h||(h={})).ClickObservable="clickObservable",s.ChangeObservable="changeObservable",s.NavigateObservable="navigateObservable",s.MutationObservable="mutationObservable";var nG=function(e){void 0===e&&(e={});var t,n,r,i=e.dataAttributePrefix,o=void 0===i?"data-amp-track-":i,s=e.visualTaggingOptions,a=void 0===s?{enabled:!0,messenger:new n_}:s;e.cssSelectorAllowlist=null!==(t=e.cssSelectorAllowlist)&&void 0!==t?t:nK,e.actionClickAllowlist=null!==(n=e.actionClickAllowlist)&&void 0!==n?n:nH,e.debounceTime=null!==(r=e.debounceTime)&&void 0!==r?r:0;var u="@amplitude/plugin-autocapture-browser",c=[],l=void 0,d=function(){var e,t,n=t4(document,"click",{capture:!0}).pipe(tQ(function(e){return p(e,"click")})),r=t4(document,"change",{capture:!0}).pipe(tQ(function(e){return p(e,"change")}));window.navigation&&(t=t4(window.navigation,"navigate").pipe(tQ(function(e){return p(e,"navigate")})));var i=new tj(function(e){var t=new MutationObserver(function(t){e.next(t)});return t.observe(document.body,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),function(){return t.disconnect()}}).pipe(tQ(function(e){return p(e,"mutation")}));return(e={})[h.ClickObservable]=n,e[h.ChangeObservable]=r,e[h.NavigateObservable]=t,e[h.MutationObservable]=i,e},f=function(e,t){var n,r,i,s,a=null===(s=null===(i=null==t?void 0:t.tagName)||void 0===i?void 0:i.toLowerCase)||void 0===s?void 0:s.call(i),u="function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{left:null,top:null},c=t.getAttribute("aria-label"),d=t.getAttributeNames().reduce(function(e,n){if(n.startsWith(o)){var r=n.replace(o,""),i=t.getAttribute(n);r&&(e[r]=i||"")}return e},{}),f=nv(t),h=nf(t,l),p=((r={})["[Amplitude] Element ID"]=t.id,r["[Amplitude] Element Class"]=t.className,r["[Amplitude] Element Hierarchy"]=(n=t)?function(e,t){for(var n=0,r=0;r<e.length;r++){var i=e[r];if(null===i)n+=4;else{var o=function e(t,n){void 0===n&&(n=!1);try{if(null==t){if(n)return"None";return null}if("string"==typeof t){if(n){if((t=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r")).includes('"'))return"'".concat(t,"'");if(t.includes("'"))return'"'.concat(t.replace(/'/g,"\\'"),'"');return"'".concat(t,"'")}return t}if("boolean"==typeof t)return t?"True":"False";if(Array.isArray(t)){var r=t.map(function(t){return e(t,!0)});return"[".concat(r.join(", "),"]")}else if("object"==typeof t){var i=Object.entries(t).filter(function(e){var t=(0,v.__read)(e,1)[0];return null!=t}).map(function(t){var n=(0,v.__read)(t,2),r=n[0],i=n[1];return"".concat(String(e(r,!0)),": ").concat(String(e(i,!0)))}),o="{".concat(i.join(", "),"}");return o.includes("\\'")&&(o=o.replace(/'/g,"'").replace(/'/g,"\\'")),o}return t.toString()}catch(e){return null}}(i);n+=o?Array.from(o).length:4}if(n>1024)return e.slice(0,r)}return e}((function(e){var t=[];if(!e)return t;t.push(e);for(var n=e.parentElement;n&&"HTML"!==n.tagName;)t.push(n),n=n.parentElement;return t})(n).map(function(e){return function(e){if(null===e)return null;var t,n,r,i,o,s,a=e.tagName.toLowerCase(),u={tag:a},c=Array.from(null!==(i=null===(r=e.parentElement)||void 0===r?void 0:r.children)&&void 0!==i?i:[]);c.length&&(u.index=c.indexOf(e),u.indexOfType=c.filter(function(t){return t.tagName===e.tagName}).indexOf(e));var l=null===(s=null===(o=e.previousElementSibling)||void 0===o?void 0:o.tagName)||void 0===s?void 0:s.toLowerCase();l&&(u.prevSib=l);var d=e.id;d&&(u.id=d);var f=Array.from(e.classList);f.length&&(u.classes=f);var h={},p=Array.from(e.attributes).filter(function(e){return!nb.includes(e.name)}),g=!nl(e);if(!nI.includes(e.type)&&!nS.includes(a))try{for(var m=(0,v.__values)(p),y=m.next();!y.done;y=m.next()){var _=y.value;(!g||nw.includes(_.name))&&(h[_.name]=String(_.value).substring(0,128))}}catch(e){t={error:e}}finally{try{y&&!y.done&&(n=m.return)&&n.call(m)}finally{if(t)throw t.error}}return Object.keys(h).length&&(u.attrs=h),u}(e)}),0):[],r[to]=a,r[ts]=nd(t),r["[Amplitude] Element Position Left"]=null==u.left?null:Math.round(u.left),r["[Amplitude] Element Position Top"]=null==u.top?null:Math.round(u.top),r["[Amplitude] Element Aria Label"]=c,r["[Amplitude] Element Attributes"]=d,r[ta]=h,r["[Amplitude] Element Parent Label"]=f,r[tu]=window.location.href.split("?")[0],r["[Amplitude] Page Title"]="undefined"!=typeof document&&document.title||"",r["[Amplitude] Viewport Height"]=window.innerHeight,r["[Amplitude] Viewport Width"]=window.innerWidth,r);return"a"===a&&"click"===e&&t instanceof HTMLAnchorElement&&(p["[Amplitude] Element Href"]=t.href),np(p)},p=function(t,n){var r={event:t,timestamp:Date.now(),type:n};if(("click"===r.type||"change"===r.type)&&null!==r.event.target){var i=ng(r.event.target,e.cssSelectorAllowlist);i&&(r.closestTrackedAncestor=i,r.targetElementProperties=f(r.type,i))}return r};return{name:u,type:"enrichment",setup:function(t,n){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var r,i,o,s,h,p,g,m,y,_,b;return(0,v.__generator)(this,function(w){var S,I,E,C,k,T,M,x,O,R,P,N,D,A,L,q,j,F,U,z,B,W,V,K,H,G,$,J,Y,Q,X,Z,ee,et;return n?(l=t.loggerProvider,"undefined"==typeof document||(r=nu(e,e.cssSelectorAllowlist),i=nu(e,e.actionClickAllowlist),I=(S={allObservables:o=d(),options:e,amplitude:n,shouldTrackEvent:r}).amplitude,E=S.allObservables,C=S.options,k=S.shouldTrackEvent,O=nU((T=E.clickObservable).pipe(t$(function(e,t){var n,r=!1;e.subscribe(tJ(t,function(e){var i=n;n=e,r&&t.next([i,e]),r=!0}))}),nE(function(e){var t=(0,v.__read)(e,2),n=t[0],r=t[1],i=n.event.target!==r.event.target,o=20>=Math.abs(r.event.screenX-n.event.screenX)&&20>=Math.abs(r.event.screenY-n.event.screenY);return i&&!o})),T.pipe((M=C.debounceTime,void 0===x&&(x=nO),t$(function(e,t){var n=null,r=null,i=null,o=function(){if(n){n.unsubscribe(),n=null;var e=r;r=null,t.next(e)}};function s(){var e=i+M,r=x.now();if(r<e){n=this.schedule(void 0,e-r),t.add(n);return}o()}e.subscribe(tJ(t,function(e){r=e,i=x.now(),n||(n=x.schedule(s,M),t.add(n))},function(){o(),t.complete()},void 0,function(){r=n=null}))})),tQ(function(){return"timeout"}))),s=T.pipe((void 0===R&&(R=nO),P=0,N=R,void 0===P&&(P=0),void 0===D&&(D=nO),A=-1,null!=N&&(nN(N)?D=N:A=N),L=new tj(function(e){var t=nB(P)?+P-D.now():P;t<0&&(t=0);var n=0;return D.schedule(function(){e.closed||(e.next(n++),0<=A?this.schedule(void 0,A):e.complete())},t)}),function e(t,n){return n?function(r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return nR(1)(nF(e,nA(e)))}(n.pipe(nz(1),t$(function(e,t){e.subscribe(tJ(t,tE))})),r.pipe(e(t)))}:tZ(function(e,n){return tH(t(e,n)).pipe(nz(1),tQ(function(){return e}))})}(function(){return L})),nE(ny),nE(function(e){return k("click",e.closestTrackedAncestor)}),t$(function(e,t){var n=[];return e.subscribe(tJ(t,function(e){return n.push(e)},function(){t.next(n),t.complete()})),tH(O).subscribe(tJ(t,function(){var e=n;n=[],t.next(e)},tE)),function(){n=null}})).subscribe(function(e){var t,n,r=(e.length,ti);try{for(var i=(0,v.__values)(e),o=i.next();!o.done;o=i.next()){var s=o.value;null==I||I.track(r,s.targetElementProperties,{time:s.timestamp})}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}),c.push(s),j=(q={allObservables:o,getEventProperties:f,amplitude:n,shouldTrackEvent:r}).amplitude,F=q.allObservables,U=q.getEventProperties,z=q.shouldTrackEvent,h=F.changeObservable.pipe(nE(ny),nE(function(e){return z("change",e.closestTrackedAncestor)})).subscribe(function(e){null==j||j.track("[Amplitude] Element Changed",U("change",e.closestTrackedAncestor))}),c.push(h),W=(B={allObservables:o,options:e,getEventProperties:f,amplitude:n,shouldTrackEvent:r,shouldTrackActionClick:i}).amplitude,V=B.allObservables,K=B.options,H=B.getEventProperties,G=B.shouldTrackEvent,$=B.shouldTrackActionClick,J=V.clickObservable,Y=V.mutationObservable,Q=V.navigateObservable,X=J.pipe(nE(function(e){return!G("click",e.closestTrackedAncestor)}),tQ(function(e){var t=ng(e.event.target,K.actionClickAllowlist);return e.closestTrackedAncestor=t,null!==e.closestTrackedAncestor&&(e.targetElementProperties=H(e.type,e.closestTrackedAncestor)),e}),nE(ny),nE(function(e){return $("click",e.closestTrackedAncestor)})),Z=[Y],Q&&Z.push(Q),ee=nU.apply(void 0,(0,v.__spreadArray)([],(0,v.__read)(Z),!1)),p=X.pipe((et=function(e){return ee.pipe(nz(1),function(e,t){var n=nB(e)?{first:e}:"number"==typeof e?{each:e}:e,r=n.first,i=n.each,o=n.with,s=void 0===o?nV:o,a=n.scheduler,u=void 0===a?nO:a,c=n.meta,l=void 0===c?null:c;if(null==r&&null==i)throw TypeError("No timeout provided.");return t$(function(e,t){var n,o,a=null,c=0,d=function(e){o=tX(t,u,function(){try{n.unsubscribe(),tH(s({meta:l,lastValue:a,seen:c})).subscribe(t)}catch(e){t.error(e)}},e)};n=e.subscribe(tJ(t,function(e){null==o||o.unsubscribe(),c++,t.next(a=e),i>0&&d(i)},void 0,void 0,function(){(null==o?void 0:o.closed)||null==o||o.unsubscribe(),a=null})),c||d(null!=r?"number"==typeof r?r:+r-u.now():i)})}({first:500,with:function(){return nP}}),tQ(function(){return e}))},t$(function(e,t){var n=null,r=0,i=!1,o=function(){return i&&!n&&t.complete()};e.subscribe(tJ(t,function(e){null==n||n.unsubscribe(),tH(et(e,r++)).subscribe(n=tJ(t,function(e){return t.next(e)},function(){n=null,o()}))},function(){i=!0,o()}))}))).subscribe(function(e){null==W||W.track(ti,H("click",e.closestTrackedAncestor),{time:e.timestamp})}),c.push(p),null===(_=null==t?void 0:t.loggerProvider)||void 0===_||_.log("".concat(u," has been successfully added.")),window.opener&&a.enabled&&(g=e.cssSelectorAllowlist,m=e.actionClickAllowlist,null===(b=a.messenger)||void 0===b||b.setup((0,v.__assign)((0,v.__assign)({logger:null==t?void 0:t.loggerProvider},(null==t?void 0:t.serverZone)&&{endpoint:tl[t.serverZone]}),{isElementSelectable:nu(e,(0,v.__spreadArray)((0,v.__spreadArray)([],(0,v.__read)(g),!1),(0,v.__read)(m),!1)),cssSelectorAllowlist:g,actionClickAllowlist:m}))))):null===(y=null==t?void 0:t.loggerProvider)||void 0===y||y.warn("".concat(u," plugin requires a later version of @amplitude/analytics-browser. Events are not tracked.")),[2]})})},execute:function(e){return(0,v.__awaiter)(void 0,void 0,void 0,function(){return(0,v.__generator)(this,function(t){return[2,e]})})},teardown:function(){return(0,v.__awaiter)(void 0,void 0,void 0,function(){var e,t,n,r;return(0,v.__generator)(this,function(i){try{for(t=(e=(0,v.__values)(c)).next();!t.done;t=e.next())t.value.unsubscribe()}catch(e){n={error:e}}finally{try{t&&!t.done&&(r=e.return)&&r.call(e)}finally{if(n)throw n.error}}return[2]})})}}},n$=(a=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,v.__extends)(t,e),t.prototype.init=function(e,t,n){var r,i;return void 0===e&&(e=""),arguments.length>2?(r=t,i=n):"string"==typeof t?(r=t,i=void 0):(r=null==t?void 0:t.userId,i=t),(0,g.S)(this._init((0,v.__assign)((0,v.__assign)({},i),{userId:r,apiKey:e})))},t.prototype._init=function(t){var n,r,i;return(0,v.__awaiter)(this,void 0,void 0,function(){var o,s,a,u,c,l=this;return(0,v.__generator)(this,function(d){var f,h,p,g,m;switch(d.label){case 0:if(this.initializing)return[2];return this.initializing=!0,[4,(f=t.apiKey,h=t,p=this,void 0===h&&(h={}),(0,v.__awaiter)(void 0,void 0,void 0,function(){var e,t,n,r,i,o,s,a,u,c,l,d,g,m,_,b,w,I,E,C,k,T,M,x,O,R,P,N,D,A,L,q,j,F,U,z,B,W,V,K,H,G,$;return(0,v.__generator)(this,function(J){var Y,Q,X;switch(J.label){case 0:if(e=h.identityStorage||eK,E={},!(e!==eK))return[3,1];return n="",[3,5];case 1:if(!(null!==(k=null===(C=h.cookieOptions)||void 0===C?void 0:C.domain)&&void 0!==k))return[3,2];return r=k,[3,4];case 2:return[4,(0,v.__awaiter)(void 0,void 0,void 0,function(){var e,t,n,r,i,o;return(0,v.__generator)(this,function(s){switch(s.label){case 0:return[4,new e_().isEnabled()];case 1:if(!s.sent()||"undefined"==typeof location||!location.hostname)return[2,""];for(e=(null!=Y?Y:location.hostname).split("."),t=[],n="AMP_TLDTEST",r=e.length-2;r>=0;--r)t.push(e.slice(r).join("."));r=0,s.label=2;case 2:if(!(r<t.length))return[3,7];return[4,(o=new e_({domain:"."+(i=t[r])})).set(n,1)];case 3:return s.sent(),[4,o.get(n)];case 4:if(!s.sent())return[3,6];return[4,o.remove(n)];case 5:return s.sent(),[2,"."+i];case 6:return r++,[3,2];case 7:return[2,""]}})})];case 3:r=J.sent(),J.label=4;case 4:n=r,J.label=5;case 5:return t=v.__assign.apply(void 0,[(E.domain=n,E.expiration=365,E.sameSite="Lax",E.secure=!1,E.upgrade=!0,E),h.cookieOptions]),[4,(Q=i=eG(h.identityStorage,t),void 0===(X=null===(M=null===(T=h.cookieOptions)||void 0===T?void 0:T.upgrade)||void 0===M||M)&&(X=!0),(0,v.__awaiter)(void 0,void 0,void 0,function(){var e,t,n,r,i,o,s,a,u;return(0,v.__generator)(this,function(c){switch(c.label){case 0:return e="".concat(y.xp.toLowerCase(),"_").concat(f.substring(0,6)),[4,Q.getRaw(e)];case 1:if(!(t=c.sent()))return[2,{optOut:!1}];if(!X)return[3,3];return[4,Q.remove(e)];case 2:c.sent(),c.label=3;case 3:return r=(n=(0,v.__read)(t.split("."),6))[0],i=n[1],o=n[2],s=n[3],a=n[4],u=n[5],[2,{deviceId:r,userId:eO(i),sessionId:ex(s),lastEventId:ex(u),lastEventTime:ex(a),optOut:!!o}]}})}))];case 6:return o=J.sent(),[4,i.get(ey(f))];case 7:return s=J.sent(),a=ei(),u=null!==(N=null!==(P=null!==(R=null!==(O=null!==(x=h.deviceId)&&void 0!==x?x:a.ampDeviceId)&&void 0!==O?O:a.deviceId)&&void 0!==R?R:null==s?void 0:s.deviceId)&&void 0!==P?P:o.deviceId)&&void 0!==N?N:S(),c=null!==(D=null==s?void 0:s.lastEventId)&&void 0!==D?D:o.lastEventId,l=null!==(A=null==s?void 0:s.lastEventTime)&&void 0!==A?A:o.lastEventTime,d=null!==(q=null!==(L=h.optOut)&&void 0!==L?L:null==s?void 0:s.optOut)&&void 0!==q?q:o.optOut,g=null!==(j=null==s?void 0:s.sessionId)&&void 0!==j?j:o.sessionId,m=null!==(U=null!==(F=h.userId)&&void 0!==F?F:null==s?void 0:s.userId)&&void 0!==U?U:o.userId,p.previousSessionDeviceId=null!==(z=null==s?void 0:s.deviceId)&&void 0!==z?z:o.deviceId,p.previousSessionUserId=null!==(B=null==s?void 0:s.userId)&&void 0!==B?B:o.userId,_={ipAddress:null===(V=null===(W=h.trackingOptions)||void 0===W?void 0:W.ipAddress)||void 0===V||V,language:null===(H=null===(K=h.trackingOptions)||void 0===K?void 0:K.language)||void 0===H||H,platform:null===($=null===(G=h.trackingOptions)||void 0===G?void 0:G.platform)||void 0===$||$},b=null==s?void 0:s.pageCounter,w=null==s?void 0:s.debugLogsEnabled,void 0!==h.autocapture&&(h.defaultTracking=h.autocapture),[4,(I=new eH(f,h.appVersion,i,t,h.defaultTracking,h.autocapture,u,h.flushIntervalMillis,h.flushMaxRetries,h.flushQueueSize,e,h.ingestionMetadata,h.instanceName,c,l,h.loggerProvider,h.logLevel,h.minIdLength,h.offline,d,h.partnerId,h.plan,h.serverUrl,h.serverZone,g,h.sessionTimeout,h.storageProvider,_,h.transport,h.useBatch,h.fetchRemoteConfig,m,b,w)).storageProvider.isEnabled()];case 8:return J.sent()||(I.loggerProvider.warn("Storage provider ".concat(I.storageProvider.constructor.name," is not enabled. Falling back to MemoryStorage.")),I.storageProvider=new eg),[2,I]}})}))];case 1:if(o=d.sent(),!t.fetchRemoteConfig)return[3,4];return[4,(g=o,(0,v.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,v.__generator)(this,function(t){switch(t.label){case 0:return[4,(e=new tr(g)).initialize()];case 1:return t.sent(),[2,e]}})}))];case 2:return[4,d.sent().generateJoinedConfig()];case 3:o=d.sent(),d.label=4;case 4:return[4,e.prototype._init.call(this,o)];case 5:if(d.sent(),this.logBrowserOptions(o),!A(this.config.defaultTracking))return[3,7];return s=A((m=this.config).defaultTracking)&&m.defaultTracking&&"object"==typeof m.defaultTracking&&m.defaultTracking.attribution&&"object"==typeof m.defaultTracking.attribution?(0,v.__assign)({},m.defaultTracking.attribution):{},this.webAttribution=new eu(s,this.config),[4,this.webAttribution.init()];case 6:d.sent(),d.label=7;case 7:if(u=Number.isNaN(Number((a=ei()).ampSessionId))?void 0:Number(a.ampSessionId),this.setSessionId(null!==(i=null!==(r=null!==(n=t.sessionId)&&void 0!==n?n:u)&&void 0!==r?r:this.config.sessionId)&&void 0!==i?i:Date.now()),(c=(0,ec.bM)(t.instanceName)).identityStore.setIdentity({userId:this.config.userId,deviceId:this.config.deviceId}),!(null!==this.config.offline))return[3,9];return[4,this.add(e5()).promise];case 8:d.sent(),d.label=9;case 9:return[4,this.add(new E).promise];case 10:return d.sent(),[4,this.add(new ep).promise];case 11:return d.sent(),[4,this.add(new el).promise];case 12:if(d.sent(),e4(this.config),!D(this.config.defaultTracking,"fileDownloads"))return[3,14];return this.config.loggerProvider.debug("Adding file download tracking plugin"),[4,this.add(e2()).promise];case 13:d.sent(),d.label=14;case 14:if(!D(this.config.defaultTracking,"formInteractions"))return[3,16];return this.config.loggerProvider.debug("Adding form interaction plugin"),[4,this.add(e0()).promise];case 15:d.sent(),d.label=16;case 16:if(!L(this.config.defaultTracking))return[3,18];return this.config.loggerProvider.debug("Adding page view tracking plugin"),[4,this.add(eY(U(this.config))).promise];case 17:d.sent(),d.label=18;case 18:if(!j(this.config.autocapture))return[3,20];return this.config.loggerProvider.debug("Adding user interactions plugin (autocapture plugin)"),[4,this.add(nG(F(this.config))).promise];case 19:d.sent(),d.label=20;case 20:return this.initializing=!1,[4,this.runQueuedFunctions("dispatchQ")];case 21:return d.sent(),c.eventBridge.setEventReceiver(function(e){l.track(e.eventType,e.eventProperties)}),[2]}})})},t.prototype.getUserId=function(){var e;return null===(e=this.config)||void 0===e?void 0:e.userId},t.prototype.setUserId=function(e){if(!this.config){this.q.push(this.setUserId.bind(this,e));return}this.config.loggerProvider.debug("function setUserId: ",e),(e!==this.config.userId||void 0===e)&&(this.config.userId=e,(0,ec.x)(e,this.config.instanceName))},t.prototype.getDeviceId=function(){var e;return null===(e=this.config)||void 0===e?void 0:e.deviceId},t.prototype.setDeviceId=function(e){if(!this.config){this.q.push(this.setDeviceId.bind(this,e));return}this.config.loggerProvider.debug("function setDeviceId: ",e),this.config.deviceId=e,(0,ec.Sb)(e,this.config.instanceName)},t.prototype.reset=function(){this.setDeviceId(S()),this.setUserId(void 0)},t.prototype.getSessionId=function(){var e;return null===(e=this.config)||void 0===e?void 0:e.sessionId},t.prototype.setSessionId=function(e){var t,n=[];if(!this.config)return this.q.push(this.setSessionId.bind(this,e)),(0,g.S)(Promise.resolve());if(e===this.config.sessionId)return(0,g.S)(Promise.resolve());this.config.loggerProvider.debug("function setSessionId: ",e);var r=this.getSessionId(),i=this.config.lastEventTime,o=null!==(t=this.config.lastEventId)&&void 0!==t?t:-1;this.config.sessionId=e,this.config.lastEventTime=void 0,this.config.pageCounter=0,q(this.config.defaultTracking)&&(r&&i&&n.push(this.track(eL,void 0,{device_id:this.previousSessionDeviceId,event_id:++o,session_id:r,time:i+1,user_id:this.previousSessionUserId}).promise),this.config.lastEventTime=this.config.sessionId);var s=this.trackCampaignEventIfNeeded(++o,n);return q(this.config.defaultTracking)&&n.push(this.track(eA,void 0,{event_id:s?++o:o,session_id:this.config.sessionId,time:this.config.lastEventTime}).promise),this.previousSessionDeviceId=this.config.deviceId,this.previousSessionUserId=this.config.userId,(0,g.S)(Promise.all(n))},t.prototype.extendSession=function(){if(!this.config){this.q.push(this.extendSession.bind(this));return}this.config.lastEventTime=Date.now()},t.prototype.setTransport=function(e){if(!this.config){this.q.push(this.setTransport.bind(this,e));return}this.config.transportProvider=e$(e)},t.prototype.identify=function(t,n){if(ef(t)){var r=t._q;t._q=[],t=ed(new T,r)}return(null==n?void 0:n.user_id)&&this.setUserId(n.user_id),(null==n?void 0:n.device_id)&&this.setDeviceId(n.device_id),e.prototype.identify.call(this,t,n)},t.prototype.groupIdentify=function(t,n,r,i){if(ef(r)){var o=r._q;r._q=[],r=ed(new T,o)}return e.prototype.groupIdentify.call(this,t,n,r,i)},t.prototype.revenue=function(t,n){if(ef(t)){var r=t._q;t._q=[],t=ed(new M,r)}return e.prototype.revenue.call(this,t,n)},t.prototype.trackCampaignEventIfNeeded=function(e,t){if(!this.webAttribution||!this.webAttribution.shouldTrackNewCampaign)return!1;var n=this.webAttribution.generateCampaignEvent(e);return t?t.push(this.track(n).promise):this.track(n),this.config.loggerProvider.log("Tracking attribution."),!0},t.prototype.process=function(t){return(0,v.__awaiter)(this,void 0,void 0,function(){var n,r,i;return(0,v.__generator)(this,function(o){return n=Date.now(),r=ea(this.config.sessionTimeout,this.config.lastEventTime),i=this.webAttribution&&this.webAttribution.shouldSetSessionIdOnNewCampaign(),t.event_type===eA||t.event_type===eL||t.session_id&&t.session_id!==this.getSessionId()||(r||i?(this.setSessionId(n),i&&this.config.loggerProvider.log("Created a new session for new campaign.")):r||this.trackCampaignEventIfNeeded()),[2,e.prototype.process.call(this,t)]})})},t.prototype.logBrowserOptions=function(e){try{var t=(0,v.__assign)((0,v.__assign)({},e),{apiKey:e.apiKey.substring(0,10)+"********"});this.config.loggerProvider.debug("Initialized Amplitude with BrowserConfig:",JSON.stringify(t))}catch(e){this.config.loggerProvider.error("Error logging browser config",e)}},t}(N)),{init:(0,p.w_)(a.init.bind(a),"init",(0,p.yh)(a),(0,p.zn)(a,["config"])),add:(0,p.w_)(a.add.bind(a),"add",(0,p.yh)(a),(0,p.zn)(a,["config.apiKey","timeline.plugins"])),remove:(0,p.w_)(a.remove.bind(a),"remove",(0,p.yh)(a),(0,p.zn)(a,["config.apiKey","timeline.plugins"])),track:(0,p.w_)(a.track.bind(a),"track",(0,p.yh)(a),(0,p.zn)(a,["config.apiKey","timeline.queue.length"])),logEvent:(0,p.w_)(a.logEvent.bind(a),"logEvent",(0,p.yh)(a),(0,p.zn)(a,["config.apiKey","timeline.queue.length"])),identify:(0,p.w_)(a.identify.bind(a),"identify",(0,p.yh)(a),(0,p.zn)(a,["config.apiKey","timeline.queue.length"])),groupIdentify:(0,p.w_)(a.groupIdentify.bind(a),"groupIdentify",(0,p.yh)(a),(0,p.zn)(a,["config.apiKey","timeline.queue.length"])),setGroup:(0,p.w_)(a.setGroup.bind(a),"setGroup",(0,p.yh)(a),(0,p.zn)(a,["config.apiKey","timeline.queue.length"])),revenue:(0,p.w_)(a.revenue.bind(a),"revenue",(0,p.yh)(a),(0,p.zn)(a,["config.apiKey","timeline.queue.length"])),flush:(0,p.w_)(a.flush.bind(a),"flush",(0,p.yh)(a),(0,p.zn)(a,["config.apiKey","timeline.queue.length"])),getUserId:(0,p.w_)(a.getUserId.bind(a),"getUserId",(0,p.yh)(a),(0,p.zn)(a,["config","config.userId"])),setUserId:(0,p.w_)(a.setUserId.bind(a),"setUserId",(0,p.yh)(a),(0,p.zn)(a,["config","config.userId"])),getDeviceId:(0,p.w_)(a.getDeviceId.bind(a),"getDeviceId",(0,p.yh)(a),(0,p.zn)(a,["config","config.deviceId"])),setDeviceId:(0,p.w_)(a.setDeviceId.bind(a),"setDeviceId",(0,p.yh)(a),(0,p.zn)(a,["config","config.deviceId"])),reset:(0,p.w_)(a.reset.bind(a),"reset",(0,p.yh)(a),(0,p.zn)(a,["config","config.userId","config.deviceId"])),getSessionId:(0,p.w_)(a.getSessionId.bind(a),"getSessionId",(0,p.yh)(a),(0,p.zn)(a,["config"])),setSessionId:(0,p.w_)(a.setSessionId.bind(a),"setSessionId",(0,p.yh)(a),(0,p.zn)(a,["config"])),extendSession:(0,p.w_)(a.extendSession.bind(a),"extendSession",(0,p.yh)(a),(0,p.zn)(a,["config"])),setOptOut:(0,p.w_)(a.setOptOut.bind(a),"setOptOut",(0,p.yh)(a),(0,p.zn)(a,["config"])),setTransport:(0,p.w_)(a.setTransport.bind(a),"setTransport",(0,p.yh)(a),(0,p.zn)(a,["config"]))}),nJ=n$.add,nY=(n$.extendSession,n$.flush,n$.getDeviceId,n$.getSessionId,n$.getUserId,n$.groupIdentify,n$.identify,n$.init);n$.logEvent,n$.remove,n$.reset,n$.revenue,n$.setDeviceId,n$.setGroup,n$.setOptOut,n$.setSessionId,n$.setTransport,n$.setUserId,n$.track},635657:function(e,t,n){n.d(t,{bM:function(){return d},Sb:function(){return h},x:function(){return f}});var r=function(){function e(){}return e.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:i(),platform:"Web",os:void 0,deviceModel:void 0}},e}(),i=function(){return"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},o=function(){function e(){this.queue=[]}return e.prototype.logEvent=function(e){this.receiver?this.receiver(e):this.queue.length<512&&this.queue.push(e)},e.prototype.setEventReceiver=function(e){this.receiver=e,this.queue.length>0&&(this.queue.forEach(function(t){e(t)}),this.queue=[])},e}(),s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=function(e,t){var n=typeof e;if(n!==typeof t)return!1;for(var r=0,i=["string","number","boolean","undefined"];r<i.length;r++)if(i[r]===n)return e===t;if(null==e&&null==t)return!0;if(null==e||null==t||e.length!==t.length)return!1;var o=Array.isArray(e),s=Array.isArray(t);if(o!==s)return!1;if(o&&s){for(var u=0;u<e.length;u++)if(!a(e[u],t[u]))return!1}else{if(!a(Object.keys(e).sort(),Object.keys(t).sort()))return!1;var c=!0;return Object.keys(e).forEach(function(n){a(e[n],t[n])||(c=!1)}),c}return!0};Object.entries||(Object.entries=function(e){for(var t=Object.keys(e),n=t.length,r=Array(n);n--;)r[n]=[t[n],e[t[n]]];return r});var u=function(){function e(){this.identity={userProperties:{}},this.listeners=new Set}return e.prototype.editIdentity=function(){var e=this,t=s({},this.identity.userProperties),n=s(s({},this.identity),{userProperties:t});return{setUserId:function(e){return n.userId=e,this},setDeviceId:function(e){return n.deviceId=e,this},setUserProperties:function(e){return n.userProperties=e,this},setOptOut:function(e){return n.optOut=e,this},updateUserProperties:function(e){for(var t=n.userProperties||{},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r],s=o[0],a=o[1];switch(s){case"$set":for(var u=0,c=Object.entries(a);u<c.length;u++){var l=c[u],d=l[0],f=l[1];t[d]=f}break;case"$unset":for(var h=0,p=Object.keys(a);h<p.length;h++){var d=p[h];delete t[d]}break;case"$clearAll":t={}}}return n.userProperties=t,this},commit:function(){return e.setIdentity(n),this}}},e.prototype.getIdentity=function(){return s({},this.identity)},e.prototype.setIdentity=function(e){var t=s({},this.identity);this.identity=s({},e),a(t,this.identity)||this.listeners.forEach(function(t){t(e)})},e.prototype.addIdentityListener=function(e){this.listeners.add(e)},e.prototype.removeIdentityListener=function(e){this.listeners.delete(e)},e}(),c="undefined"!=typeof globalThis?globalThis:void 0!==n.g?n.g:self,l=function(){function e(){this.identityStore=new u,this.eventBridge=new o,this.applicationContextProvider=new r}return e.getInstance=function(t){return c.analyticsConnectorInstances||(c.analyticsConnectorInstances={}),c.analyticsConnectorInstances[t]||(c.analyticsConnectorInstances[t]=new e),c.analyticsConnectorInstances[t]},e}(),d=function(e){return void 0===e&&(e="$default_instance"),l.getInstance(e)},f=function(e,t){d(t).identityStore.editIdentity().setUserId(e).commit()},h=function(e,t){d(t).identityStore.editIdentity().setDeviceId(e).commit()}},701522:function(e,t,n){n.d(t,{l:function(){return r}});var r=function(){var e="ampIntegrationContext";return"undefined"!=typeof globalThis&&void 0!==globalThis[e]?globalThis[e]:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0!==n.g?n.g:void 0}},522879:function(e,t,n){n.d(t,{V:function(){return i}});var r=n(300491),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.send=function(e,t){return(0,r.__awaiter)(this,void 0,void 0,function(){var n,i;return(0,r.__generator)(this,function(r){switch(r.label){case 0:if("undefined"==typeof fetch)throw Error("FetchTransport is not supported");return[4,fetch(e,{headers:{"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify(t),method:"POST"})];case 1:return[4,(n=r.sent()).text()];case 2:i=r.sent();try{return[2,this.buildResponse(JSON.parse(i))]}catch(e){return[2,this.buildResponse({code:n.status})]}return[2]}})})},t}(n(327704).d)},76594:function(e,t,n){n.d(t,{De:function(){return a},Dg:function(){return c},RG:function(){return u}});var r=n(203253),i=n(136314),o=n(629790),s=function(){return{flushMaxRetries:12,flushQueueSize:200,flushIntervalMillis:1e4,instanceName:"$default_instance",logLevel:r.i.Warn,loggerProvider:new o.Y,offline:!1,optOut:!1,serverUrl:i.EG,serverZone:"US",useBatch:!1}},a=function(){function e(e){this._optOut=!1;var t,n,r,i,o=s();this.apiKey=e.apiKey,this.flushIntervalMillis=null!==(t=e.flushIntervalMillis)&&void 0!==t?t:o.flushIntervalMillis,this.flushMaxRetries=e.flushMaxRetries||o.flushMaxRetries,this.flushQueueSize=e.flushQueueSize||o.flushQueueSize,this.instanceName=e.instanceName||o.instanceName,this.loggerProvider=e.loggerProvider||o.loggerProvider,this.logLevel=null!==(n=e.logLevel)&&void 0!==n?n:o.logLevel,this.minIdLength=e.minIdLength,this.plan=e.plan,this.ingestionMetadata=e.ingestionMetadata,this.offline=void 0!==e.offline?e.offline:o.offline,this.optOut=null!==(r=e.optOut)&&void 0!==r?r:o.optOut,this.serverUrl=e.serverUrl,this.serverZone=e.serverZone||o.serverZone,this.storageProvider=e.storageProvider,this.transportProvider=e.transportProvider,this.useBatch=null!==(i=e.useBatch)&&void 0!==i?i:o.useBatch,this.loggerProvider.enable(this.logLevel);var a=u(e.serverUrl,e.serverZone,e.useBatch);this.serverZone=a.serverZone,this.serverUrl=a.serverUrl}return Object.defineProperty(e.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut=e},enumerable:!1,configurable:!0}),e}(),u=function(e,t,n){if(void 0===e&&(e=""),void 0===t&&(t=s().serverZone),void 0===n&&(n=s().useBatch),e)return{serverUrl:e,serverZone:void 0};var r,o=["US","EU"].includes(t)?t:s().serverZone;return{serverZone:o,serverUrl:(r=n,"EU"===o?r?i.RE:i.y_:r?i.h8:i.EG)}},c=function(){function e(){this.sdk={metrics:{histogram:{}}}}return e.prototype.recordHistogram=function(e,t){this.sdk.metrics.histogram[e]=t},e}()},136314:function(e,t,n){n.d(t,{EG:function(){return s},RE:function(){return c},f1:function(){return o},h8:function(){return u},q$:function(){return r},xp:function(){return i},y_:function(){return a}});var r="-",i="AMP",o="".concat(i,"_unsent"),s="https://api2.amplitude.com/2/httpapi",a="https://api.eu.amplitude.com/2/httpapi",u="https://api2.amplitude.com/batch",c="https://api.eu.amplitude.com/batch"},629790:function(e,t,n){n.d(t,{Y:function(){return o}});var r=n(203253),i="Amplitude Logger ",o=function(){function e(){this.logLevel=r.i.None}return e.prototype.disable=function(){this.logLevel=r.i.None},e.prototype.enable=function(e){void 0===e&&(e=r.i.Warn),this.logLevel=e},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<r.i.Verbose||console.log("".concat(i,"[Log]: ").concat(e.join(" ")))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<r.i.Warn||console.warn("".concat(i,"[Warn]: ").concat(e.join(" ")))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<r.i.Error||console.error("".concat(i,"[Error]: ").concat(e.join(" ")))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.logLevel<r.i.Debug||console.log("".concat(i,"[Debug]: ").concat(e.join(" ")))},e}()},327704:function(e,t,n){n.d(t,{d:function(){return i}});var r=n(594789),i=function(){function e(){}return e.prototype.send=function(e,t){return Promise.resolve(null)},e.prototype.buildResponse=function(e){if("object"!=typeof e)return null;var t,n,i,o,s,a,u,c,l,d,f,h,p,v,g,m,y,_,b,w,S,I,E=e.code||0,C=this.buildStatus(E);switch(C){case r.q.Success:return{status:C,statusCode:E,body:{eventsIngested:null!==(t=e.events_ingested)&&void 0!==t?t:0,payloadSizeBytes:null!==(n=e.payload_size_bytes)&&void 0!==n?n:0,serverUploadTime:null!==(i=e.server_upload_time)&&void 0!==i?i:0}};case r.q.Invalid:return{status:C,statusCode:E,body:{error:null!==(o=e.error)&&void 0!==o?o:"",missingField:null!==(s=e.missing_field)&&void 0!==s?s:"",eventsWithInvalidFields:null!==(a=e.events_with_invalid_fields)&&void 0!==a?a:{},eventsWithMissingFields:null!==(u=e.events_with_missing_fields)&&void 0!==u?u:{},eventsWithInvalidIdLengths:null!==(c=e.events_with_invalid_id_lengths)&&void 0!==c?c:{},epsThreshold:null!==(l=e.eps_threshold)&&void 0!==l?l:0,exceededDailyQuotaDevices:null!==(d=e.exceeded_daily_quota_devices)&&void 0!==d?d:{},silencedDevices:null!==(f=e.silenced_devices)&&void 0!==f?f:[],silencedEvents:null!==(h=e.silenced_events)&&void 0!==h?h:[],throttledDevices:null!==(p=e.throttled_devices)&&void 0!==p?p:{},throttledEvents:null!==(v=e.throttled_events)&&void 0!==v?v:[]}};case r.q.PayloadTooLarge:return{status:C,statusCode:E,body:{error:null!==(g=e.error)&&void 0!==g?g:""}};case r.q.RateLimit:return{status:C,statusCode:E,body:{error:null!==(m=e.error)&&void 0!==m?m:"",epsThreshold:null!==(y=e.eps_threshold)&&void 0!==y?y:0,throttledDevices:null!==(_=e.throttled_devices)&&void 0!==_?_:{},throttledUsers:null!==(b=e.throttled_users)&&void 0!==b?b:{},exceededDailyQuotaDevices:null!==(w=e.exceeded_daily_quota_devices)&&void 0!==w?w:{},exceededDailyQuotaUsers:null!==(S=e.exceeded_daily_quota_users)&&void 0!==S?S:{},throttledEvents:null!==(I=e.throttled_events)&&void 0!==I?I:[]}};case r.q.Timeout:default:return{status:C,statusCode:E}}},e.prototype.buildStatus=function(e){return e>=200&&e<300?r.q.Success:429===e?r.q.RateLimit:413===e?r.q.PayloadTooLarge:408===e?r.q.Timeout:e>=400&&e<500?r.q.Invalid:e>=500?r.q.Failed:r.q.Unknown},e}()},212328:function(e,t,n){n.d(t,{w_:function(){return u},yh:function(){return o},zn:function(){return a}});var r=n(300491),i=n(203253),o=function(e){return function(){var t=(0,r.__assign)({},e.config);return{logger:t.loggerProvider,logLevel:t.logLevel}}},s=function(e,t){var n,i;t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"");try{for(var o=(0,r.__values)(t.split(".")),s=o.next();!s.done;s=o.next()){var a=s.value;if(!(a in e))return;e=e[a]}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return e},a=function(e,t){return function(){var n,i,o={};try{for(var a=(0,r.__values)(t),u=a.next();!u.done;u=a.next()){var c=u.value;o[c]=s(e,c)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return o}},u=function(e,t,n,r,o){return void 0===o&&(o=null),function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var u=n(),c=u.logger,l=u.logLevel;if(l&&l<i.i.Debug||!l||!c)return e.apply(o,s);var d={type:"invoke public method",name:t,args:s,stacktrace:(Error().stack||"").split("\n").slice(3).map(function(e){return e.trim()}),time:{start:new Date().toISOString()},states:{}};r&&d.states&&(d.states.before=r());var f=e.apply(o,s);return f&&f.promise?f.promise.then(function(){r&&d.states&&(d.states.after=r()),d.time&&(d.time.end=new Date().toISOString()),c.debug(JSON.stringify(d,null,2))}):(r&&d.states&&(d.states.after=r()),d.time&&(d.time.end=new Date().toISOString()),c.debug(JSON.stringify(d,null,2))),f}}},478918:function(e,t,n){n.d(t,{S:function(){return r}});var r=function(e){return{promise:e||Promise.resolve()}}},203253:function(e,t,n){var r,i;n.d(t,{i:function(){return r}}),(i=r||(r={}))[i.None=0]="None",i[i.Error=1]="Error",i[i.Warn=2]="Warn",i[i.Verbose=3]="Verbose",i[i.Debug=4]="Debug"},441063:function(e,t,n){var r,i;n.d(t,{J:function(){return r}}),(i=r||(r={})).US="US",i.EU="EU"},594789:function(e,t,n){var r,i;n.d(t,{q:function(){return r}}),(i=r||(r={})).Unknown="unknown",i.Skipped="skipped",i.Success="success",i.RateLimit="rate_limit",i.PayloadTooLarge="payload_too_large",i.Invalid="invalid",i.Failed="failed",i.Timeout="Timeout",i.SystemError="SystemError"},559228:function(e,t,n){let r,i,o,s,a,u;n.d(t,{k:function(){return rr}});var c,l,d,f,h,p,v,g,m,y,_,b,w,S,I,E,C,k,T,M,x,O,R,P,N,D,A,L=n(300491),q=n(212328),j=n(522879),F=n(629790),U=n(76594),z=n(203253),B=n(136314),W=n(441063),V="[Amplitude]",K="".concat(V," Session Replay ID"),H=W.J.US,G="".concat(V," Session Replay Debug"),$="amp-mask";B.xp,(c=x||(x={})).GET_SR_PROPS="get-sr-props",c.DEBUG_INFO="debug-info";var J=function(){return{flushMaxRetries:2,logLevel:z.i.Warn,loggerProvider:new F.Y,transportProvider:new j.V}},Y=function(e){function t(t,n){var r=this,i=J();return(r=e.call(this,(0,L.__assign)((0,L.__assign)({transportProvider:i.transportProvider},n),{apiKey:t}))||this).flushMaxRetries=void 0!==n.flushMaxRetries&&n.flushMaxRetries<=i.flushMaxRetries?n.flushMaxRetries:i.flushMaxRetries,r.apiKey=t,r.sampleRate=n.sampleRate||0,r.serverZone=n.serverZone||H,r.configEndpointUrl=n.configEndpointUrl,r.shouldInlineStylesheet=n.shouldInlineStylesheet,n.privacyConfig&&(r.privacyConfig=n.privacyConfig),n.debugMode&&(r.debugMode=n.debugMode),r}return(0,L.__extends)(t,e),t}(U.De),Q=n(701522),X=n(635657),Z=n(478918);function ee(e){let t=null==e?void 0:e.host;return(null==t?void 0:t.shadowRoot)===e}function et(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function en(e){try{var t;let n=e.rules||e.cssRules;return n?((t=Array.from(n,er).join("")).includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t):null}catch(e){return null}}function er(e){let t;if("styleSheet"in e)try{t=en(e.styleSheet)||function(e){let{cssText:t}=e;if(t.split('"').length<3)return t;let n=["@import",`url(${JSON.stringify(e.href)})`];return""===e.layerName?n.push("layer"):e.layerName&&n.push(`layer(${e.layerName})`),e.supportsText&&n.push(`supports(${e.supportsText})`),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(e)}catch(e){}else if("selectorText"in e&&e.selectorText.includes(":"))return e.cssText.replace(/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,"$1\\$2");return t||e.cssText}(l=O||(O={}))[l.Document=0]="Document",l[l.DocumentType=1]="DocumentType",l[l.Element=2]="Element",l[l.Text=3]="Text",l[l.CDATA=4]="CDATA",l[l.Comment=5]="Comment";class ei{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var t;if(!e)return -1;let n=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!=n?n:-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){let t=this.getId(e);this.idNodeMap.delete(t),e.childNodes&&e.childNodes.forEach(e=>this.removeNodeFromMap(e))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,t){let n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)}replace(e,t){let n=this.getNode(e);if(n){let e=this.nodeMetaMap.get(n);e&&this.nodeMetaMap.set(t,e)}this.idNodeMap.set(e,t)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function eo({element:e,maskInputOptions:t,tagName:n,type:r,value:i,maskInputFn:o}){let s=i||"",a=r&&es(r);return(t[n.toLowerCase()]||a&&t[a])&&(s=o?o(s,e):"*".repeat(s.length)),s}function es(e){return e.toLowerCase()}let ea="__rrweb_original__";function eu(e){let t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?es(t):null}let ec=1,el=RegExp("[^a-z0-9-_:]");function ed(){return ec++}let ef=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,eh=/^(?:[a-z+]+:)?\/\//i,ep=/^www\..*/i,ev=/^(data:)([^,]*),(.*)/i;function eg(e,t){return(e||"").replace(ef,(e,n,r,i,o,s)=>{let a=r||o||s,u=n||i||"";if(!a)return e;if(eh.test(a)||ep.test(a)||ev.test(a))return`url(${u}${a}${u})`;if("/"===a[0])return`url(${u}${(t.indexOf("//")>-1?t.split("/").slice(0,3).join("/"):t.split("/")[0]).split("?")[0]+a}${u})`;let c=t.split("/"),l=a.split("/");for(let e of(c.pop(),l))"."!==e&&(".."===e?c.pop():c.push(e));return`url(${u}${c.join("/")}${u})`})}let em=/^[^ \t\n\r\u000c]+/,ey=/^[, \t\n\r\u000c]+/;function e_(e,t){if(!t||""===t.trim())return t;let n=e.createElement("a");return n.href=t,n.href}function eb(){let e=document.createElement("a");return e.href="",e.href}function ew(e,t,n,r){return r?"src"!==n&&("href"!==n||"use"===t&&"#"===r[0])&&("xlink:href"!==n||"#"===r[0])&&("background"!==n||"table"!==t&&"td"!==t&&"th"!==t)?"srcset"===n?function(e,t){if(""===t.trim())return t;let n=0;function r(e){let r;let i=e.exec(t.substring(n));return i?(r=i[0],n+=r.length,r):""}let i=[];for(;r(ey),!(n>=t.length);){let o=r(em);if(","===o.slice(-1))o=e_(e,o.substring(0,o.length-1)),i.push(o);else{let r="";o=e_(e,o);let s=!1;for(;;){let e=t.charAt(n);if(""===e){i.push((o+r).trim());break}if(s)")"===e&&(s=!1);else{if(","===e){n+=1,i.push((o+r).trim());break}"("===e&&(s=!0)}r+=e,n+=1}}}return i.join(", ")}(e,r):"style"===n?eg(r,eb()):"object"===t&&"data"===n?e_(e,r):r:e_(e,r):r}function eS(e,t,n){return("video"===e||"audio"===e)&&"autoplay"===t}function eI(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!n&&eI(e.parentNode,t,n);for(let n=e.classList.length;n--;){let r=e.classList[n];if(t.test(r))return!0}return!!n&&eI(e.parentNode,t,n)}function eE(e,t,n){try{let r=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===r)return!1;if("string"==typeof t){if(r.classList.contains(t)||r.closest(`.${t}`))return!0}else if(eI(r,t,!0))return!0;if(n&&(r.matches(n)||r.closest(n)))return!0}catch(e){}return!1}function eC(e){return null==e?"":e.toLowerCase()}function ek(e,t){let n;let{doc:o,mirror:s,blockClass:a,blockSelector:u,maskTextClass:c,maskTextSelector:l,skipChild:d=!1,inlineStylesheet:f=!0,maskInputOptions:h={},maskTextFn:p,maskInputFn:v,slimDOMOptions:g,dataURLOptions:m={},inlineImages:y=!1,recordCanvas:_=!1,onSerialize:b,onIframeLoad:w,iframeLoadTimeout:S=5e3,onStylesheetLoad:I,stylesheetLoadTimeout:E=5e3,keepIframeSrcFn:C=()=>!1,newlyAddedElement:k=!1}=t,{preserveWhiteSpace:T=!0}=t,M=function(e,t){let{doc:n,mirror:o,blockClass:s,blockSelector:a,maskTextClass:u,maskTextSelector:c,inlineStylesheet:l,maskInputOptions:d={},maskTextFn:f,maskInputFn:h,dataURLOptions:p={},inlineImages:v,recordCanvas:g,keepIframeSrcFn:m,newlyAddedElement:y=!1}=t,_=function(e,t){if(!t.hasNode(e))return;let n=t.getId(e);return 1===n?void 0:n}(n,o);switch(e.nodeType){case e.DOCUMENT_NODE:if("CSS1Compat"!==e.compatMode)return{type:O.Document,childNodes:[],compatMode:e.compatMode};return{type:O.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:O.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:_};case e.ELEMENT_NODE:return function(e,t){let{doc:n,blockClass:o,blockSelector:s,inlineStylesheet:a,maskInputOptions:u={},maskInputFn:c,dataURLOptions:l={},inlineImages:d,recordCanvas:f,keepIframeSrcFn:h,newlyAddedElement:p=!1,rootId:v}=t,g=function(e,t,n){try{if("string"==typeof t){if(e.classList.contains(t))return!0}else for(let n=e.classList.length;n--;){let r=e.classList[n];if(t.test(r))return!0}if(n)return e.matches(n)}catch(e){}return!1}(e,o,s),m=function(e){if(e instanceof HTMLFormElement)return"form";let t=es(e.tagName);return el.test(t)?"div":t}(e),y={},_=e.attributes.length;for(let t=0;t<_;t++){let r=e.attributes[t];eS(m,r.name,r.value)||(y[r.name]=ew(n,m,es(r.name),r.value))}if("link"===m&&a){let t=Array.from(n.styleSheets).find(t=>t.href===e.href),r=null;t&&(r=en(t)),r&&(delete y.rel,delete y.href,y._cssText=eg(r,t.href))}if("style"===m&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){let t=en(e.sheet);t&&(y._cssText=eg(t,eb()))}if("input"===m||"textarea"===m||"select"===m){let t=e.value,n=e.checked;"radio"!==y.type&&"checkbox"!==y.type&&"submit"!==y.type&&"button"!==y.type&&t?y.value=eo({element:e,type:eu(e),tagName:m,value:t,maskInputOptions:u,maskInputFn:c}):n&&(y.checked=n)}if("option"===m&&(e.selected&&!u.select?y.selected=!0:delete y.selected),"canvas"===m&&f){if("2d"===e.__context)!function(e){let t=e.getContext("2d");if(!t)return!0;for(let n=0;n<e.width;n+=50)for(let r=0;r<e.height;r+=50){let i=t.getImageData;if(new Uint32Array((ea in i?i[ea]:i).call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some(e=>0!==e))return!1}return!0}(e)&&(y.rr_dataURL=e.toDataURL(l.type,l.quality));else if(!("__context"in e)){let t=e.toDataURL(l.type,l.quality),n=document.createElement("canvas");n.width=e.width,n.height=e.height,t!==n.toDataURL(l.type,l.quality)&&(y.rr_dataURL=t)}}if("img"===m&&d){r||(i=(r=n.createElement("canvas")).getContext("2d"));let t=e.crossOrigin;e.crossOrigin="anonymous";let o=()=>{e.removeEventListener("load",o);try{r.width=e.naturalWidth,r.height=e.naturalHeight,i.drawImage(e,0,0),y.rr_dataURL=r.toDataURL(l.type,l.quality)}catch(t){console.warn(`Cannot inline img src=${e.currentSrc}! Error: ${t}`)}t?y.crossOrigin=t:e.removeAttribute("crossorigin")};e.complete&&0!==e.naturalWidth?o():e.addEventListener("load",o)}if(("audio"===m||"video"===m)&&(y.rr_mediaState=e.paused?"paused":"played",y.rr_mediaCurrentTime=e.currentTime),!p&&(e.scrollLeft&&(y.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(y.rr_scrollTop=e.scrollTop)),g){let{width:t,height:n}=e.getBoundingClientRect();y={class:y.class,rr_width:`${t}px`,rr_height:`${n}px`}}return"iframe"!==m||h(y.src)||(e.contentDocument||(y.rr_src=y.src),delete y.src),{type:O.Element,tagName:m,attributes:y,childNodes:[],isSVG:!!("svg"===e.tagName||e.ownerSVGElement)||void 0,needBlock:g,rootId:v}}(e,{doc:n,blockClass:s,blockSelector:a,inlineStylesheet:l,maskInputOptions:d,maskInputFn:h,dataURLOptions:p,inlineImages:v,recordCanvas:g,keepIframeSrcFn:m,newlyAddedElement:y,rootId:_});case e.TEXT_NODE:return function(e,t){var n;let{maskTextClass:r,maskTextSelector:i,maskTextFn:o,rootId:s}=t,a=e.parentNode&&e.parentNode.tagName,u=e.textContent,c="STYLE"===a||void 0,l="SCRIPT"===a||void 0;if(c&&u){try{e.nextSibling||e.previousSibling||(null===(n=e.parentNode.sheet)||void 0===n?void 0:n.cssRules)&&(u=en(e.parentNode.sheet))}catch(t){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${t}`,e)}u=eg(u,eb())}return l&&(u="SCRIPT_PLACEHOLDER"),!c&&!l&&u&&eE(e,r,i)&&(u=o?o(u,e.parentElement):u.replace(/[\S]/g,"*")),{type:O.Text,textContent:u||"",isStyle:c,rootId:s}}(e,{maskTextClass:u,maskTextSelector:c,maskTextFn:f,rootId:_});case e.CDATA_SECTION_NODE:return{type:O.CDATA,textContent:"",rootId:_};case e.COMMENT_NODE:return{type:O.Comment,textContent:e.textContent||"",rootId:_};default:return!1}}(e,{doc:o,mirror:s,blockClass:a,blockSelector:u,maskTextClass:c,maskTextSelector:l,inlineStylesheet:f,maskInputOptions:h,maskTextFn:p,maskInputFn:v,dataURLOptions:m,inlineImages:y,recordCanvas:_,keepIframeSrcFn:C,newlyAddedElement:k});if(!M)return console.warn(e,"not serialized"),null;n=s.hasNode(e)?s.getId(e):!function(e,t){if(t.comment&&e.type===O.Comment)return!0;if(e.type===O.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js"))||t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(eC(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===eC(e.attributes.name)||"icon"===eC(e.attributes.rel)||"apple-touch-icon"===eC(e.attributes.rel)||"shortcut icon"===eC(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&eC(e.attributes.name).match(/^description|keywords$/)||t.headMetaSocial&&(eC(e.attributes.property).match(/^(og|twitter|fb):/)||eC(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===eC(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===eC(e.attributes.name)||"googlebot"===eC(e.attributes.name)||"bingbot"===eC(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;else if(t.headMetaAuthorship&&("author"===eC(e.attributes.name)||"generator"===eC(e.attributes.name)||"framework"===eC(e.attributes.name)||"publisher"===eC(e.attributes.name)||"progid"===eC(e.attributes.name)||eC(e.attributes.property).match(/^article:/)||eC(e.attributes.property).match(/^product:/)))return!0;else if(t.headMetaVerification&&("google-site-verification"===eC(e.attributes.name)||"yandex-verification"===eC(e.attributes.name)||"csrf-token"===eC(e.attributes.name)||"p:domain_verify"===eC(e.attributes.name)||"verify-v1"===eC(e.attributes.name)||"verification"===eC(e.attributes.name)||"shopify-checkout-api-token"===eC(e.attributes.name)))return!0}}return!1}(M,g)&&(T||M.type!==O.Text||M.isStyle||M.textContent.replace(/^\s+|\s+$/gm,"").length)?ed():-2;let x=Object.assign(M,{id:n});if(s.add(e,x),-2===n)return null;b&&b(e);let R=!d;if(x.type===O.Element){R=R&&!x.needBlock,delete x.needBlock;let t=e.shadowRoot;t&&et(t)&&(x.isShadowHost=!0)}if((x.type===O.Document||x.type===O.Element)&&R){g.headWhitespace&&x.type===O.Element&&"head"===x.tagName&&(T=!1);let t={doc:o,mirror:s,blockClass:a,blockSelector:u,maskTextClass:c,maskTextSelector:l,skipChild:d,inlineStylesheet:f,maskInputOptions:h,maskTextFn:p,maskInputFn:v,slimDOMOptions:g,dataURLOptions:m,inlineImages:y,recordCanvas:_,preserveWhiteSpace:T,onSerialize:b,onIframeLoad:w,iframeLoadTimeout:S,onStylesheetLoad:I,stylesheetLoadTimeout:E,keepIframeSrcFn:C};if(x.type===O.Element&&"textarea"===x.tagName&&void 0!==x.attributes.value);else for(let n of Array.from(e.childNodes)){let e=ek(n,t);e&&x.childNodes.push(e)}if(e.nodeType===e.ELEMENT_NODE&&e.shadowRoot)for(let n of Array.from(e.shadowRoot.childNodes)){let r=ek(n,t);r&&(et(e.shadowRoot)&&(r.isShadow=!0),x.childNodes.push(r))}}return e.parentNode&&ee(e.parentNode)&&et(e.parentNode)&&(x.isShadow=!0),x.type===O.Element&&"iframe"===x.tagName&&function(e,t,n){let r;let i=e.contentWindow;if(!i)return;let o=!1;try{r=i.document.readyState}catch(e){return}if("complete"!==r){let r=setTimeout(()=>{o||(t(),o=!0)},n);e.addEventListener("load",()=>{clearTimeout(r),o=!0,t()});return}let s="about:blank";if(i.location.href!==s||e.src===s||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}(e,()=>{let t=e.contentDocument;if(t&&w){let n=ek(t,{doc:t,mirror:s,blockClass:a,blockSelector:u,maskTextClass:c,maskTextSelector:l,skipChild:!1,inlineStylesheet:f,maskInputOptions:h,maskTextFn:p,maskInputFn:v,slimDOMOptions:g,dataURLOptions:m,inlineImages:y,recordCanvas:_,preserveWhiteSpace:T,onSerialize:b,onIframeLoad:w,iframeLoadTimeout:S,onStylesheetLoad:I,stylesheetLoadTimeout:E,keepIframeSrcFn:C});n&&w(e,n)}},S),x.type===O.Element&&"link"===x.tagName&&"stylesheet"===x.attributes.rel&&function(e,t,n){let r,i=!1;try{r=e.sheet}catch(e){return}if(r)return;let o=setTimeout(()=>{i||(t(),i=!0)},n);e.addEventListener("load",()=>{clearTimeout(o),i=!0,t()})}(e,()=>{if(I){let t=ek(e,{doc:o,mirror:s,blockClass:a,blockSelector:u,maskTextClass:c,maskTextSelector:l,skipChild:!1,inlineStylesheet:f,maskInputOptions:h,maskTextFn:p,maskInputFn:v,slimDOMOptions:g,dataURLOptions:m,inlineImages:y,recordCanvas:_,preserveWhiteSpace:T,onSerialize:b,onIframeLoad:w,iframeLoadTimeout:S,onStylesheetLoad:I,stylesheetLoadTimeout:E,keepIframeSrcFn:C});t&&I(e,t)}},E),x}RegExp(/(max|min)-device-(width|height)/.source,"g"),RegExp(/([^\\]):hover/.source,"g");var eT=((d=eT||{})[d.DomContentLoaded=0]="DomContentLoaded",d[d.Load=1]="Load",d[d.FullSnapshot=2]="FullSnapshot",d[d.IncrementalSnapshot=3]="IncrementalSnapshot",d[d.Meta=4]="Meta",d[d.Custom=5]="Custom",d[d.Plugin=6]="Plugin",d),eM=((f=eM||{})[f.Mutation=0]="Mutation",f[f.MouseMove=1]="MouseMove",f[f.MouseInteraction=2]="MouseInteraction",f[f.Scroll=3]="Scroll",f[f.ViewportResize=4]="ViewportResize",f[f.Input=5]="Input",f[f.TouchMove=6]="TouchMove",f[f.MediaInteraction=7]="MediaInteraction",f[f.StyleSheetRule=8]="StyleSheetRule",f[f.CanvasMutation=9]="CanvasMutation",f[f.Font=10]="Font",f[f.Log=11]="Log",f[f.Drag=12]="Drag",f[f.StyleDeclaration=13]="StyleDeclaration",f[f.Selection=14]="Selection",f[f.AdoptedStyleSheet=15]="AdoptedStyleSheet",f),ex=((h=ex||{})[h.MouseUp=0]="MouseUp",h[h.MouseDown=1]="MouseDown",h[h.Click=2]="Click",h[h.ContextMenu=3]="ContextMenu",h[h.DblClick=4]="DblClick",h[h.Focus=5]="Focus",h[h.Blur=6]="Blur",h[h.TouchStart=7]="TouchStart",h[h.TouchMove_Departed=8]="TouchMove_Departed",h[h.TouchEnd=9]="TouchEnd",h[h.TouchCancel=10]="TouchCancel",h),eO=((p=eO||{})[p.Mouse=0]="Mouse",p[p.Pen=1]="Pen",p[p.Touch=2]="Touch",p),eR=((v=eR||{})[v["2D"]=0]="2D",v[v.WebGL=1]="WebGL",v[v.WebGL2=2]="WebGL2",v),eP=((g=eP||{}).Start="start",g.Pause="pause",g.Resume="resume",g.Resize="resize",g.Finish="finish",g.FullsnapshotRebuilded="fullsnapshot-rebuilded",g.LoadStylesheetStart="load-stylesheet-start",g.LoadStylesheetEnd="load-stylesheet-end",g.SkipStart="skip-start",g.SkipEnd="skip-end",g.MouseInteraction="mouse-interaction",g.EventCast="event-cast",g.CustomEvent="custom-event",g.Flush="flush",g.StateChange="state-change",g.PlayBack="play-back",g.Destroy="destroy",g);function eN(e,t,n=document){let r={capture:!0,passive:!0};return n.addEventListener(e,t,r),()=>n.removeEventListener(e,t,r)}let eD="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",eA={map:{},getId:()=>(console.error(eD),-1),getNode:()=>(console.error(eD),null),removeNodeFromMap(){console.error(eD)},has:()=>(console.error(eD),!1),reset(){console.error(eD)}};function eL(e,t,n={}){let r=null,i=0;return function(...o){let s=Date.now();i||!1!==n.leading||(i=s);let a=t-(s-i),u=this;a<=0||a>t?(r&&(clearTimeout(r),r=null),i=s,e.apply(u,o)):r||!1===n.trailing||(r=setTimeout(()=>{i=!1===n.leading?0:Date.now(),r=null,e.apply(u,o)},a))}}function eq(e,t,n,r,i=window){let o=i.Object.getOwnPropertyDescriptor(e,t);return i.Object.defineProperty(e,t,r?n:{set(e){setTimeout(()=>{n.set.call(this,e)},0),o&&o.set&&o.set.call(this,e)}}),()=>eq(e,t,o||{},!0)}function ej(e,t,n){try{if(!(t in e))return()=>{};let r=e[t],i=n(r);return"function"==typeof i&&(i.prototype=i.prototype||{},Object.defineProperties(i,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=i,()=>{e[t]=r}}catch(e){return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(eA=new Proxy(eA,{get:(e,t,n)=>("map"===t&&console.error(eD),Reflect.get(e,t,n))}));let eF=Date.now;function eU(e){var t,n,r,i,o,s;let a=e.document;return{left:a.scrollingElement?a.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:(null==a?void 0:a.documentElement.scrollLeft)||(null===(n=null===(t=null==a?void 0:a.body)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.scrollLeft)||(null===(r=null==a?void 0:a.body)||void 0===r?void 0:r.scrollLeft)||0,top:a.scrollingElement?a.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:(null==a?void 0:a.documentElement.scrollTop)||(null===(o=null===(i=null==a?void 0:a.body)||void 0===i?void 0:i.parentElement)||void 0===o?void 0:o.scrollTop)||(null===(s=null==a?void 0:a.body)||void 0===s?void 0:s.scrollTop)||0}}function ez(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function eB(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function eW(e){return e?e.nodeType===e.ELEMENT_NODE?e:e.parentElement:null}function eV(e,t,n,r){if(!e)return!1;let i=eW(e);if(!i)return!1;try{if("string"==typeof t){if(i.classList.contains(t)||r&&null!==i.closest("."+t))return!0}else if(eI(i,t,r))return!0}catch(e){}return!!(n&&(i.matches(n)||r&&null!==i.closest(n)))}function eK(e,t){return -2===t.getId(e)}function eH(e){return!!e.changedTouches}function eG(e,t){return!!("IFRAME"===e.nodeName&&t.getMeta(e))}function e$(e,t){return!!("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function eJ(e){return!!(null==e?void 0:e.shadowRoot)}/[1-9][0-9]{12}/.test(Date.now().toString())||(eF=()=>new Date().getTime());class eY{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var t;return null!==(t=this.styleIDMap.get(e))&&void 0!==t?t:-1}has(e){return this.styleIDMap.has(e)}add(e,t){let n;return this.has(e)?this.getId(e):(n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n)}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function eQ(e){var t,n;let r=null;return(null===(n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e))||void 0===n?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(r=e.getRootNode().host),r}function eX(e){let t=e.ownerDocument;return!!t&&(t.contains(e)||function(e){let t=e.ownerDocument;if(!t)return!1;let n=function(e){let t,n=e;for(;t=eQ(n);)n=t;return n}(e);return t.contains(n)}(e))}let eZ=e=>o?(...t)=>{try{return e(...t)}catch(e){if(o&&!0===o(e))return;throw e}}:e;function e0(e){return(...t)=>{try{return e(...t)}catch(e){try{e._external_=!0}catch(e){}throw e}}}class e1{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,n,r){let i=n||this.getIdToRemoteIdMap(e),o=r||this.getRemoteIdToIdMap(e),s=i.get(t);return s||(s=this.generateIdFn(),i.set(t,s),o.set(s,t)),s}getIds(e,t){let n=this.getIdToRemoteIdMap(e),r=this.getRemoteIdToIdMap(e);return t.map(t=>this.getId(e,t,n,r))}getRemoteId(e,t,n){let r=n||this.getRemoteIdToIdMap(e);return"number"!=typeof t?t:r.get(t)||-1}getRemoteIds(e,t){let n=this.getRemoteIdToIdMap(e);return t.map(t=>this.getRemoteId(e,t,n))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}class e2{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new e1(ed),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new e1(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){var n;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(n=this.loadListener)||void 0===n||n.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){if("rrweb"!==e.data.type||e.origin!==e.data.origin||!e.source)return;let t=this.crossOriginIframeMap.get(e.source);if(!t)return;let n=this.transformCrossOriginEvent(t,e.data.event);n&&this.wrappedEmit(n,e.data.isCheckout)}transformCrossOriginEvent(e,t){var n;switch(t.type){case eT.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);let n=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,n),this.patchRootIdOnNode(t.data.node,n),{timestamp:t.timestamp,type:eT.IncrementalSnapshot,data:{source:eM.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case eT.Meta:case eT.Load:case eT.DomContentLoaded:return!1;case eT.Plugin:return t;case eT.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case eT.IncrementalSnapshot:switch(t.data.source){case eM.Mutation:return t.data.adds.forEach(t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);let n=this.crossOriginIframeRootIdMap.get(e);n&&this.patchRootIdOnNode(t.node,n)}),t.data.removes.forEach(t=>{this.replaceIds(t,e,["parentId","id"])}),t.data.attributes.forEach(t=>{this.replaceIds(t,e,["id"])}),t.data.texts.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case eM.Drag:case eM.TouchMove:case eM.MouseMove:return t.data.positions.forEach(t=>{this.replaceIds(t,e,["id"])}),t;case eM.ViewportResize:return!1;case eM.MediaInteraction:case eM.MouseInteraction:case eM.Scroll:case eM.CanvasMutation:case eM.Input:return this.replaceIds(t.data,e,["id"]),t;case eM.StyleSheetRule:case eM.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case eM.Font:return t;case eM.Selection:return t.data.ranges.forEach(t=>{this.replaceIds(t,e,["start","end"])}),t;case eM.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),null===(n=t.data.styles)||void 0===n||n.forEach(t=>{this.replaceStyleIds(t,e,["styleId"])}),t}}}replace(e,t,n,r){for(let i of r)(Array.isArray(t[i])||"number"==typeof t[i])&&(Array.isArray(t[i])?t[i]=e.getIds(n,t[i]):t[i]=e.getId(n,t[i]));return t}replaceIds(e,t,n){return this.replace(this.crossOriginIframeMirror,e,t,n)}replaceStyleIds(e,t,n){return this.replace(this.crossOriginIframeStyleMirror,e,t,n)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(e=>{this.replaceIdOnNode(e,t)})}patchRootIdOnNode(e,t){e.type===O.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach(e=>{this.patchRootIdOnNode(e,t)})}}class e3{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw Error("Position outside of list range");let t=this.head;for(let n=0;n<e;n++)t=(null==t?void 0:t.next)||null;return t}addNode(e){let t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&"__ln"in e.previousSibling){let n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&"__ln"in e.nextSibling&&e.nextSibling.__ln.previous){let n=e.nextSibling.__ln.previous;t.previous=n,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}removeNode(e){let t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}let e4=(e,t)=>`${e}@${t}`;class e5{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;let e=[],t=new Set,n=new e3,r=e=>{let t=e,n=-2;for(;-2===n;)n=(t=t&&t.nextSibling)&&this.mirror.getId(t);return n},i=i=>{if(!i.parentNode||!eX(i)||"TEXTAREA"===i.parentNode.tagName)return;let o=ee(i.parentNode)?this.mirror.getId(eQ(i)):this.mirror.getId(i.parentNode),s=r(i);if(-1===o||-1===s)return n.addNode(i);let a=ek(i,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:e=>{eG(e,this.mirror)&&this.iframeManager.addIframe(e),e$(e,this.mirror)&&this.stylesheetManager.trackLinkElement(e),eJ(i)&&this.shadowDomManager.addShadowRoot(i.shadowRoot,this.doc)},onIframeLoad:(e,t)=>{this.iframeManager.attachIframe(e,t),this.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{this.stylesheetManager.attachLinkElement(e,t)}});a&&(e.push({parentId:o,nextId:s,node:a}),t.add(a.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(let e of this.movedSet)(!e8(this.removes,e,this.mirror)||this.movedSet.has(e.parentNode))&&i(e);for(let e of this.addedSet)e7(this.droppedSet,e)||e8(this.removes,e,this.mirror)?e7(this.movedSet,e)?i(e):this.droppedSet.add(e):i(e);let o=null;for(;n.length;){let e=null;if(o){let t=this.mirror.getId(o.value.parentNode),n=r(o.value);-1!==t&&-1!==n&&(e=o)}if(!e){let t=n.tail;for(;t;){let n=t;if(t=t.previous,n){let t=this.mirror.getId(n.value.parentNode);if(-1===r(n.value))continue;if(-1!==t){e=n;break}{let t=n.value;if(t.parentNode&&t.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){let r=t.parentNode.host;if(-1!==this.mirror.getId(r)){e=n;break}}}}}}if(!e){for(;n.head;)n.removeNode(n.head.value);break}o=e.previous,n.removeNode(e.value),i(e.value)}let s={texts:this.texts.map(e=>{let t=e.node;return"TEXTAREA"===t.parentNode.tagName&&this.genTextAreaValueMutation(t.parentNode),{id:this.mirror.getId(t),value:e.value}}).filter(e=>!t.has(e.id)).filter(e=>this.mirror.has(e.id)),attributes:this.attributes.map(e=>{let{attributes:t}=e;if("string"==typeof t.style){let n=JSON.stringify(e.styleDiff),r=JSON.stringify(e._unchangedStyles);n.length<t.style.length&&(n+r).split("var(").length===t.style.split("var(").length&&(t.style=e.styleDiff)}return{id:this.mirror.getId(e.node),attributes:t}}).filter(e=>!t.has(e.id)).filter(e=>this.mirror.has(e.id)),removes:this.removes,adds:e};(s.texts.length||s.attributes.length||s.removes.length||s.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(s))},this.genTextAreaValueMutation=e=>{let t=this.attributeMap.get(e);t||(t={node:e,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(t),this.attributeMap.set(e,t)),t.attributes.value=Array.from(e.childNodes,e=>e.textContent||"").join("")},this.processMutation=e=>{if(!eK(e.target,this.mirror))switch(e.type){case"characterData":{let t=e.target.textContent;eV(e.target,this.blockClass,this.blockSelector,!1)||t===e.oldValue||this.texts.push({value:eE(e.target,this.maskTextClass,this.maskTextSelector)&&t?this.maskTextFn?this.maskTextFn(t,eW(e.target)):t.replace(/[\S]/g,"*"):t,node:e.target});break}case"attributes":{let t=e.target,n=e.attributeName,r=e.target.getAttribute(n);if("value"===n){let e=eu(t);r=eo({element:t,maskInputOptions:this.maskInputOptions,tagName:t.tagName,type:e,value:r,maskInputFn:this.maskInputFn})}if(eV(e.target,this.blockClass,this.blockSelector,!1)||r===e.oldValue)return;let i=this.attributeMap.get(e.target);if("IFRAME"===t.tagName&&"src"===n&&!this.keepIframeSrcFn(r)){if(t.contentDocument)return;n="rr_src"}if(i||(i={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(i),this.attributeMap.set(e.target,i)),"type"===n&&"INPUT"===t.tagName&&"password"===(e.oldValue||"").toLowerCase()&&t.setAttribute("data-rr-is-password","true"),!eS(t.tagName,n)&&(i.attributes[n]=ew(this.doc,es(t.tagName),es(n),r),"style"===n)){let n;try{n=document.implementation.createHTMLDocument()}catch(e){n=this.doc}let r=n.createElement("span");for(let n of(e.oldValue&&r.setAttribute("style",e.oldValue),Array.from(t.style))){let e=t.style.getPropertyValue(n),o=t.style.getPropertyPriority(n);e!==r.style.getPropertyValue(n)||o!==r.style.getPropertyPriority(n)?""===o?i.styleDiff[n]=e:i.styleDiff[n]=[e,o]:i._unchangedStyles[n]=[e,o]}for(let e of Array.from(r.style))""===t.style.getPropertyValue(e)&&(i.styleDiff[e]=!1)}break}case"childList":if(eV(e.target,this.blockClass,this.blockSelector,!0))return;if("TEXTAREA"===e.target.tagName){this.genTextAreaValueMutation(e.target);return}e.addedNodes.forEach(t=>this.genAdds(t,e.target)),e.removedNodes.forEach(t=>{let n=this.mirror.getId(t),r=ee(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);eV(e.target,this.blockClass,this.blockSelector,!1)||eK(t,this.mirror)||-1===this.mirror.getId(t)||(this.addedSet.has(t)?(e6(this.addedSet,t),this.droppedSet.add(t)):this.addedSet.has(e.target)&&-1===n||function e(t,n){if(ee(t))return!1;let r=n.getId(t);return!n.has(r)||(!t.parentNode||t.parentNode.nodeType!==t.DOCUMENT_NODE)&&(!t.parentNode||e(t.parentNode,n))}(e.target,this.mirror)||(this.movedSet.has(t)&&this.movedMap[e4(n,r)]?e6(this.movedSet,t):this.removes.push({parentId:r,id:n,isShadow:!!(ee(e.target)&&et(e.target))||void 0})),this.mapRemoves.push(t))})}},this.genAdds=(e,t)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!(this.addedSet.has(e)||this.movedSet.has(e))){if(this.mirror.hasNode(e)){if(eK(e,this.mirror))return;this.movedSet.add(e);let n=null;t&&this.mirror.hasNode(t)&&(n=this.mirror.getId(t)),n&&-1!==n&&(this.movedMap[e4(this.mirror.getId(e),n)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);!eV(e,this.blockClass,this.blockSelector,!1)&&(e.childNodes.forEach(e=>this.genAdds(e)),eJ(e)&&e.shadowRoot.childNodes.forEach(t=>{this.processedNodeManager.add(t,this),this.genAdds(t,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(t=>{this[t]=e[t]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function e6(e,t){e.delete(t),t.childNodes.forEach(t=>e6(e,t))}function e8(e,t,n){return 0!==e.length&&function e(t,n,r){let{parentNode:i}=n;if(!i)return!1;let o=r.getId(i);return!!t.some(e=>e.id===o)||e(t,i,r)}(e,t,n)}function e7(e,t){return 0!==e.size&&function e(t,n){let{parentNode:r}=n;return!!r&&(!!t.has(r)||e(t,r))}(e,t)}let e9=[];function te(e){try{if("composedPath"in e){let t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch(e){}return e&&e.target}function tt(e,t){var n,r;let i=new e5;e9.push(i),i.init(e);let o=window.MutationObserver||window.__rrMutationObserver,s=null===(r=null===(n=null==window?void 0:window.Zone)||void 0===n?void 0:n.__symbol__)||void 0===r?void 0:r.call(n,"MutationObserver");s&&window[s]&&(o=window[s]);let a=new o(eZ(i.processMutations.bind(i)));return a.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),a}function tn({scrollCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,sampling:o}){return eN("scroll",eZ(eL(eZ(o=>{let s=te(o);if(!s||eV(s,r,i,!0))return;let a=n.getId(s);if(s===t&&t.defaultView){let n=eU(t.defaultView);e({id:a,x:n.left,y:n.top})}else e({id:a,x:s.scrollLeft,y:s.scrollTop})}),o.scroll||100)),t)}function tr(e,t){let n=Object.assign({},e);return t||delete n.userTriggered,n}let ti=["INPUT","TEXTAREA","SELECT"],to=new WeakMap;function ts(e){var t;return t=[],tl("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||tl("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||tl("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||tl("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule?t.unshift(Array.from(e.parentRule.cssRules).indexOf(e)):e.parentStyleSheet&&t.unshift(Array.from(e.parentStyleSheet.cssRules).indexOf(e)),t}function ta(e,t,n){let r,i;return e?(e.ownerNode?r=t.getId(e.ownerNode):i=n.getId(e),{styleId:i,id:r}):{}}function tu({mirror:e,stylesheetManager:t},n){var r,i,o;let s=null;s="#document"===n.nodeName?e.getId(n):e.getId(n.host);let a="#document"===n.nodeName?null===(r=n.defaultView)||void 0===r?void 0:r.Document:null===(o=null===(i=n.ownerDocument)||void 0===i?void 0:i.defaultView)||void 0===o?void 0:o.ShadowRoot,u=(null==a?void 0:a.prototype)?Object.getOwnPropertyDescriptor(null==a?void 0:a.prototype,"adoptedStyleSheets"):void 0;return null!==s&&-1!==s&&a&&u?(Object.defineProperty(n,"adoptedStyleSheets",{configurable:u.configurable,enumerable:u.enumerable,get(){var e;return null===(e=u.get)||void 0===e?void 0:e.call(this)},set(e){var n;let r=null===(n=u.set)||void 0===n?void 0:n.call(this,e);if(null!==s&&-1!==s)try{t.adoptStyleSheets(e,s)}catch(e){}return r}}),eZ(()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:u.configurable,enumerable:u.enumerable,get:u.get,set:u.set})})):()=>{}}function tc(e,t={}){let n;let r=e.doc.defaultView;if(!r)return()=>{};!function(e,t){let{mutationCb:n,mousemoveCb:r,mouseInteractionCb:i,scrollCb:o,viewportResizeCb:s,inputCb:a,mediaInteractionCb:u,styleSheetRuleCb:c,styleDeclarationCb:l,canvasMutationCb:d,fontCb:f,selectionCb:h}=e;e.mutationCb=(...e)=>{t.mutation&&t.mutation(...e),n(...e)},e.mousemoveCb=(...e)=>{t.mousemove&&t.mousemove(...e),r(...e)},e.mouseInteractionCb=(...e)=>{t.mouseInteraction&&t.mouseInteraction(...e),i(...e)},e.scrollCb=(...e)=>{t.scroll&&t.scroll(...e),o(...e)},e.viewportResizeCb=(...e)=>{t.viewportResize&&t.viewportResize(...e),s(...e)},e.inputCb=(...e)=>{t.input&&t.input(...e),a(...e)},e.mediaInteractionCb=(...e)=>{t.mediaInteaction&&t.mediaInteaction(...e),u(...e)},e.styleSheetRuleCb=(...e)=>{t.styleSheetRule&&t.styleSheetRule(...e),c(...e)},e.styleDeclarationCb=(...e)=>{t.styleDeclaration&&t.styleDeclaration(...e),l(...e)},e.canvasMutationCb=(...e)=>{t.canvasMutation&&t.canvasMutation(...e),d(...e)},e.fontCb=(...e)=>{t.font&&t.font(...e),f(...e)},e.selectionCb=(...e)=>{t.selection&&t.selection(...e),h(...e)}}(e,t),e.recordDOM&&(n=tt(e,e.doc));let i=function({mousemoveCb:e,sampling:t,doc:n,mirror:r}){let i;if(!1===t.mousemove)return()=>{};let o="number"==typeof t.mousemove?t.mousemove:50,s="number"==typeof t.mousemoveCallback?t.mousemoveCallback:500,a=[],u=eL(eZ(t=>{let n=Date.now()-i;e(a.map(e=>(e.timeOffset-=n,e)),t),a=[],i=null}),s),c=eZ(eL(eZ(e=>{let t=te(e),{clientX:n,clientY:o}=eH(e)?e.changedTouches[0]:e;i||(i=eF()),a.push({x:n,y:o,id:r.getId(t),timeOffset:eF()-i}),u("undefined"!=typeof DragEvent&&e instanceof DragEvent?eM.Drag:e instanceof MouseEvent?eM.MouseMove:eM.TouchMove)}),o,{trailing:!1})),l=[eN("mousemove",c,n),eN("touchmove",c,n),eN("drag",c,n)];return eZ(()=>{l.forEach(e=>e())})}(e),o=function({mouseInteractionCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,sampling:o}){if(!1===o.mouseInteraction)return()=>{};let s=!0===o.mouseInteraction||void 0===o.mouseInteraction?{}:o.mouseInteraction,a=[],u=null,c=t=>o=>{let s=te(o);if(eV(s,r,i,!0))return;let a=null,c=t;if("pointerType"in o){switch(o.pointerType){case"mouse":a=eO.Mouse;break;case"touch":a=eO.Touch;break;case"pen":a=eO.Pen}a===eO.Touch?ex[t]===ex.MouseDown?c="TouchStart":ex[t]===ex.MouseUp&&(c="TouchEnd"):eO.Pen}else eH(o)&&(a=eO.Touch);null!==a?(u=a,(c.startsWith("Touch")&&a===eO.Touch||c.startsWith("Mouse")&&a===eO.Mouse)&&(a=null)):ex[t]===ex.Click&&(a=u,u=null);let l=eH(o)?o.changedTouches[0]:o;if(!l)return;let d=n.getId(s),{clientX:f,clientY:h}=l;eZ(e)(Object.assign({type:ex[c],id:d,x:f,y:h},null!==a&&{pointerType:a}))};return Object.keys(ex).filter(e=>Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==s[e]).forEach(e=>{let n=es(e),r=c(e);if(window.PointerEvent)switch(ex[e]){case ex.MouseDown:case ex.MouseUp:n=n.replace("mouse","pointer");break;case ex.TouchStart:case ex.TouchEnd:return}a.push(eN(n,r,t))}),eZ(()=>{a.forEach(e=>e())})}(e),s=tn(e),a=function({viewportResizeCb:e},{win:t}){let n=-1,r=-1;return eN("resize",eZ(eL(eZ(()=>{let t=ez(),i=eB();(n!==t||r!==i)&&(e({width:Number(i),height:Number(t)}),n=t,r=i)}),200)),t)}(e,{win:r}),u=function({inputCb:e,doc:t,mirror:n,blockClass:r,blockSelector:i,ignoreClass:o,ignoreSelector:s,maskInputOptions:a,maskInputFn:u,sampling:c,userTriggeredOnInput:l}){function d(e){let n=te(e),c=e.isTrusted,d=n&&n.tagName;if(n&&"OPTION"===d&&(n=n.parentElement),!n||!d||0>ti.indexOf(d)||eV(n,r,i,!0)||n.classList.contains(o)||s&&n.matches(s))return;let h=n.value,p=!1,v=eu(n)||"";"radio"===v||"checkbox"===v?p=n.checked:(a[d.toLowerCase()]||a[v])&&(h=eo({element:n,maskInputOptions:a,tagName:d,type:v,value:h,maskInputFn:u})),f(n,eZ(tr)({text:h,isChecked:p,userTriggered:c},l));let g=n.name;"radio"===v&&g&&p&&t.querySelectorAll(`input[type="radio"][name="${g}"]`).forEach(e=>{e!==n&&f(e,eZ(tr)({text:e.value,isChecked:!p,userTriggered:!1},l))})}function f(t,r){let i=to.get(t);if(!i||i.text!==r.text||i.isChecked!==r.isChecked){to.set(t,r);let i=n.getId(t);eZ(e)(Object.assign(Object.assign({},r),{id:i}))}}let h=("last"===c.input?["change"]:["input","change"]).map(e=>eN(e,eZ(d),t)),p=t.defaultView;if(!p)return()=>{h.forEach(e=>e())};let v=p.Object.getOwnPropertyDescriptor(p.HTMLInputElement.prototype,"value"),g=[[p.HTMLInputElement.prototype,"value"],[p.HTMLInputElement.prototype,"checked"],[p.HTMLSelectElement.prototype,"value"],[p.HTMLTextAreaElement.prototype,"value"],[p.HTMLSelectElement.prototype,"selectedIndex"],[p.HTMLOptionElement.prototype,"selected"]];return v&&v.set&&h.push(...g.map(e=>eq(e[0],e[1],{set(){eZ(d)({target:this,isTrusted:!1})}},!1,p))),eZ(()=>{h.forEach(e=>e())})}(e),c=function({mediaInteractionCb:e,blockClass:t,blockSelector:n,mirror:r,sampling:i,doc:o}){let s=eZ(o=>eL(eZ(i=>{let s=te(i);if(!s||eV(s,t,n,!0))return;let{currentTime:a,volume:u,muted:c,playbackRate:l}=s;e({type:o,id:r.getId(s),currentTime:a,volume:u,muted:c,playbackRate:l})}),i.media||500)),a=[eN("play",s(0),o),eN("pause",s(1),o),eN("seeked",s(2),o),eN("volumechange",s(3),o),eN("ratechange",s(4),o)];return eZ(()=>{a.forEach(e=>e())})}(e),l=()=>{},d=()=>{},f=()=>{},h=()=>{};e.recordDOM&&(l=function({styleSheetRuleCb:e,mirror:t,stylesheetManager:n},{win:r}){let i,o;if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};let s=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(s,{apply:eZ((r,i,o)=>{let[s,a]=o,{id:u,styleId:c}=ta(i,t,n.styleMirror);return(u&&-1!==u||c&&-1!==c)&&e({id:u,styleId:c,adds:[{rule:s,index:a}]}),e0(()=>r.apply(i,o))()})});let a=r.CSSStyleSheet.prototype.deleteRule;r.CSSStyleSheet.prototype.deleteRule=new Proxy(a,{apply:eZ((r,i,o)=>{let[s]=o,{id:a,styleId:u}=ta(i,t,n.styleMirror);return(a&&-1!==a||u&&-1!==u)&&e({id:a,styleId:u,removes:[{index:s}]}),e0(()=>r.apply(i,o))()})}),r.CSSStyleSheet.prototype.replace&&(i=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(i,{apply:eZ((r,i,o)=>{let[s]=o,{id:a,styleId:u}=ta(i,t,n.styleMirror);return(a&&-1!==a||u&&-1!==u)&&e({id:a,styleId:u,replace:s}),r.apply(i,o)})})),r.CSSStyleSheet.prototype.replaceSync&&(o=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(o,{apply:eZ((r,i,o)=>{let[s]=o,{id:a,styleId:u}=ta(i,t,n.styleMirror);return(a&&-1!==a||u&&-1!==u)&&e({id:a,styleId:u,replaceSync:s}),r.apply(i,o)})}));let u={};td("CSSGroupingRule")?u.CSSGroupingRule=r.CSSGroupingRule:(td("CSSMediaRule")&&(u.CSSMediaRule=r.CSSMediaRule),td("CSSConditionRule")&&(u.CSSConditionRule=r.CSSConditionRule),td("CSSSupportsRule")&&(u.CSSSupportsRule=r.CSSSupportsRule));let c={};return Object.entries(u).forEach(([r,i])=>{c[r]={insertRule:i.prototype.insertRule,deleteRule:i.prototype.deleteRule},i.prototype.insertRule=new Proxy(c[r].insertRule,{apply:eZ((r,i,o)=>{let[s,a]=o,{id:u,styleId:c}=ta(i.parentStyleSheet,t,n.styleMirror);return(u&&-1!==u||c&&-1!==c)&&e({id:u,styleId:c,adds:[{rule:s,index:[...ts(i),a||0]}]}),r.apply(i,o)})}),i.prototype.deleteRule=new Proxy(c[r].deleteRule,{apply:eZ((r,i,o)=>{let[s]=o,{id:a,styleId:u}=ta(i.parentStyleSheet,t,n.styleMirror);return(a&&-1!==a||u&&-1!==u)&&e({id:a,styleId:u,removes:[{index:[...ts(i),s]}]}),r.apply(i,o)})})}),eZ(()=>{r.CSSStyleSheet.prototype.insertRule=s,r.CSSStyleSheet.prototype.deleteRule=a,i&&(r.CSSStyleSheet.prototype.replace=i),o&&(r.CSSStyleSheet.prototype.replaceSync=o),Object.entries(u).forEach(([e,t])=>{t.prototype.insertRule=c[e].insertRule,t.prototype.deleteRule=c[e].deleteRule})})}(e,{win:r}),d=tu(e,e.doc),f=function({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:n,stylesheetManager:r},{win:i}){let o=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(o,{apply:eZ((i,s,a)=>{var u;let[c,l,d]=a;if(n.has(c))return o.apply(s,[c,l,d]);let{id:f,styleId:h}=ta(null===(u=s.parentRule)||void 0===u?void 0:u.parentStyleSheet,t,r.styleMirror);return(f&&-1!==f||h&&-1!==h)&&e({id:f,styleId:h,set:{property:c,value:l,priority:d},index:ts(s.parentRule)}),i.apply(s,a)})});let s=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(s,{apply:eZ((i,o,a)=>{var u;let[c]=a;if(n.has(c))return s.apply(o,[c]);let{id:l,styleId:d}=ta(null===(u=o.parentRule)||void 0===u?void 0:u.parentStyleSheet,t,r.styleMirror);return(l&&-1!==l||d&&-1!==d)&&e({id:l,styleId:d,remove:{property:c},index:ts(o.parentRule)}),i.apply(o,a)})}),eZ(()=>{i.CSSStyleDeclaration.prototype.setProperty=o,i.CSSStyleDeclaration.prototype.removeProperty=s})}(e,{win:r}),e.collectFonts&&(h=function({fontCb:e,doc:t}){let n=t.defaultView;if(!n)return()=>{};let r=[],i=new WeakMap,o=n.FontFace;n.FontFace=function(e,t,n){let r=new o(e,t,n);return i.set(r,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};let s=ej(t.fonts,"add",function(t){return function(n){return setTimeout(eZ(()=>{let t=i.get(n);t&&(e(t),i.delete(n))}),0),t.apply(this,[n])}});return r.push(()=>{n.FontFace=o}),r.push(s),eZ(()=>{r.forEach(e=>e())})}(e)));let p=function(e){let{doc:t,mirror:n,blockClass:r,blockSelector:i,selectionCb:o}=e,s=!0,a=eZ(()=>{let e=t.getSelection();if(!e||s&&(null==e?void 0:e.isCollapsed))return;s=e.isCollapsed||!1;let a=[],u=e.rangeCount||0;for(let t=0;t<u;t++){let{startContainer:o,startOffset:s,endContainer:u,endOffset:c}=e.getRangeAt(t);eV(o,r,i,!0)||eV(u,r,i,!0)||a.push({start:n.getId(o),startOffset:s,end:n.getId(u),endOffset:c})}o({ranges:a})});return a(),eN("selectionchange",a)}(e),v=[];for(let t of e.plugins)v.push(t.observer(t.callback,r,t.options));return eZ(()=>{e9.forEach(e=>e.reset()),null==n||n.disconnect(),i(),o(),s(),a(),u(),c(),l(),d(),f(),h(),p(),v.forEach(e=>e())})}function tl(e){return void 0!==window[e]}function td(e){return!!(void 0!==window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}for(var tf=(m=function(){!function(){function e(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})}for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="undefined"==typeof Uint8Array?[]:new Uint8Array(256),r=0;r<t.length;r++)n[t.charCodeAt(r)]=r;var i=function(e){var n,r=new Uint8Array(e),i=r.length,o="";for(n=0;n<i;n+=3)o+=t[r[n]>>2]+t[(3&r[n])<<4|r[n+1]>>4]+t[(15&r[n+1])<<2|r[n+2]>>6]+t[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o};let o=new Map,s=new Map,a=self;a.onmessage=function(t){return e(this,void 0,void 0,function*(){if(!("OffscreenCanvas"in globalThis))return a.postMessage({id:t.data.id});{let{id:n,bitmap:r,width:u,height:c,dataURLOptions:l}=t.data,d=function(t,n,r){return e(this,void 0,void 0,function*(){let e=`${t}-${n}`;if(!("OffscreenCanvas"in globalThis))return"";{if(s.has(e))return s.get(e);let o=new OffscreenCanvas(t,n);o.getContext("2d");let a=yield o.convertToBlob(r),u=i((yield a.arrayBuffer()));return s.set(e,u),u}})}(u,c,l),f=new OffscreenCanvas(u,c);f.getContext("2d").drawImage(r,0,0),r.close();let h=yield f.convertToBlob(l),p=h.type,v=i((yield h.arrayBuffer()));if(!o.has(n)&&(yield d)===v)return o.set(n,v),a.postMessage({id:n});if(o.get(n)===v)return a.postMessage({id:n});a.postMessage({id:n,type:p,base64:v,width:u,height:c}),o.set(n,v)}})}}()},function(e){var t;return new Worker(y=y||(t=new Blob(function(e,t){var n=e.toString().split("\n");n.pop(),n.shift();for(var r=n[0].search(/\S/),i=/(['"])__worker_loader_strict__(['"])/g,o=0,s=n.length;o<s;++o)n[o]=n[o].substring(r).replace(i,"$1use strict$2")+"\n";return n}(m,null),{type:"application/javascript"}),URL.createObjectURL(t)),e)}),th="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tp="undefined"==typeof Uint8Array?[]:new Uint8Array(256),tv=0;tv<th.length;tv++)tp[th.charCodeAt(tv)]=tv;var tg=function(e){var t,n=new Uint8Array(e),r=n.length,i="";for(t=0;t<r;t+=3)i+=th[n[t]>>2]+th[(3&n[t])<<4|n[t+1]>>4]+th[(15&n[t+1])<<2|n[t+2]>>6]+th[63&n[t+2]];return r%3==2?i=i.substring(0,i.length-1)+"=":r%3==1&&(i=i.substring(0,i.length-2)+"=="),i};let tm=new Map,ty=(e,t,n)=>{let r;if(!e||!(tb(e,t)||"object"==typeof e))return;let i=e.constructor.name,o=((r=tm.get(n))||(r=new Map,tm.set(n,r)),r.has(i)||r.set(i,[]),r.get(i)),s=o.indexOf(e);return -1===s&&(s=o.length,o.push(e)),s},t_=(e,t,n)=>[...e].map(e=>(function e(t,n,r){if(t instanceof Array)return t.map(t=>e(t,n,r));if(null===t);else if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray)return{rr_type:t.constructor.name,args:[Object.values(t)]};else if(t instanceof ArrayBuffer)return{rr_type:t.constructor.name,base64:tg(t)};else if(t instanceof DataView)return{rr_type:t.constructor.name,args:[e(t.buffer,n,r),t.byteOffset,t.byteLength]};else if(t instanceof HTMLImageElement){let e=t.constructor.name,{src:n}=t;return{rr_type:e,src:n}}else if(t instanceof HTMLCanvasElement)return{rr_type:"HTMLImageElement",src:t.toDataURL()};else if(t instanceof ImageData)return{rr_type:t.constructor.name,args:[e(t.data,n,r),t.width,t.height]};else if(tb(t,n)||"object"==typeof t)return{rr_type:t.constructor.name,index:ty(t,n,r)};return t})(e,t,n)),tb=(e,t)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(e=>"function"==typeof t[e]).find(n=>e instanceof t[n]);function tw(e,t,n,r){let i=[];try{let o=ej(e.HTMLCanvasElement.prototype,"getContext",function(e){return function(i,...o){if(!eV(this,t,n,!0)){let e="experimental-webgl"===i?"webgl":i;if("__context"in this||(this.__context=e),r&&["webgl","webgl2"].includes(e)){if(o[0]&&"object"==typeof o[0]){let e=o[0];e.preserveDrawingBuffer||(e.preserveDrawingBuffer=!0)}else o.splice(0,1,{preserveDrawingBuffer:!0})}}return e.apply(this,[i,...o])}});i.push(o)}catch(e){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{i.forEach(e=>e())}}function tS(e,t,n,r,i,o,s){let a=[];for(let o of Object.getOwnPropertyNames(e))if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(o))try{if("function"!=typeof e[o])continue;let u=ej(e,o,function(e){return function(...a){let u=e.apply(this,a);if(ty(u,s,this),"tagName"in this.canvas&&!eV(this.canvas,r,i,!0)){let e=t_([...a],s,this),r={type:t,property:o,args:e};n(this.canvas,r)}return u}});a.push(u)}catch(i){let r=eq(e,o,{set(e){n(this.canvas,{type:t,property:o,args:[e],setter:!0})}});a.push(r)}return a}class tI{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(e,t)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)};let{sampling:t="all",win:n,blockClass:r,blockSelector:i,recordCanvas:o,dataURLOptions:s}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,o&&"all"===t&&this.initCanvasMutationObserver(n,r,i),o&&"number"==typeof t&&this.initCanvasFPSObserver(t,n,r,i,{dataURLOptions:s})}initCanvasFPSObserver(e,t,n,r,i){let o;let s=tw(t,n,r,!0),a=new Map,u=new tf;u.onmessage=e=>{let{id:t}=e.data;if(a.set(t,!1),!("base64"in e.data))return;let{base64:n,type:r,width:i,height:o}=e.data;this.mutationCb({id:t,type:eR["2D"],commands:[{property:"clearRect",args:[0,0,i,o]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:n}],type:r}]},0,0]}]})};let c=1e3/e,l=0,d=()=>{let e=[];return t.document.querySelectorAll("canvas").forEach(t=>{eV(t,n,r,!0)||e.push(t)}),e},f=e=>{if(l&&e-l<c){o=requestAnimationFrame(f);return}l=e,d().forEach(e=>{var t,n,r,o;return t=this,n=void 0,r=void 0,o=function*(){var t;let n=this.mirror.getId(e);if(a.get(n))return;if(a.set(n,!0),["webgl","webgl2"].includes(e.__context)){let n=e.getContext(e.__context);(null===(t=null==n?void 0:n.getContextAttributes())||void 0===t?void 0:t.preserveDrawingBuffer)===!1&&n.clear(n.COLOR_BUFFER_BIT)}let r=yield createImageBitmap(e);u.postMessage({id:n,bitmap:r,width:e.width,height:e.height,dataURLOptions:i.dataURLOptions},[r])},new(r||(r=Promise))(function(e,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(t){var n;t.done?e(t.value):((n=t.value)instanceof r?n:new r(function(e){e(n)})).then(s,a)}u((o=o.apply(t,n||[])).next())})}),o=requestAnimationFrame(f)};o=requestAnimationFrame(f),this.resetObservers=()=>{s(),cancelAnimationFrame(o)}}initCanvasMutationObserver(e,t,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();let r=tw(e,t,n,!1),i=function(e,t,n,r){let i=[];for(let o of Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype))try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[o])continue;let s=ej(t.CanvasRenderingContext2D.prototype,o,function(i){return function(...s){return eV(this.canvas,n,r,!0)||setTimeout(()=>{let n=t_([...s],t,this);e(this.canvas,{type:eR["2D"],property:o,args:n})},0),i.apply(this,s)}});i.push(s)}catch(r){let n=eq(t.CanvasRenderingContext2D.prototype,o,{set(t){e(this.canvas,{type:eR["2D"],property:o,args:[t],setter:!0})}});i.push(n)}return()=>{i.forEach(e=>e())}}(this.processMutation.bind(this),e,t,n),o=function(e,t,n,r,i){let o=[];return o.push(...tS(t.WebGLRenderingContext.prototype,eR.WebGL,e,n,r,i,t)),void 0!==t.WebGL2RenderingContext&&o.push(...tS(t.WebGL2RenderingContext.prototype,eR.WebGL2,e,n,r,i,t)),()=>{o.forEach(e=>e())}}(this.processMutation.bind(this),e,t,n,this.mirror);this.resetObservers=()=>{r(),i(),o()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){let e=t=>{this.rafStamps.latestId=t,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,t)=>{let n=this.mirror.getId(t);this.flushPendingCanvasMutationFor(t,n)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,t){if(this.frozen||this.locked)return;let n=this.pendingCanvasMutations.get(e);if(!n||-1===t)return;let r=n.map(e=>(function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n})(e,["type"])),{type:i}=n[0];this.mutationCb({id:t,type:i,commands:r}),this.pendingCanvasMutations.delete(e)}}class tE{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(e,t){let n=this.nodeMap.get(e);return n&&Array.from(n).some(e=>e!==t)}add(e,t){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}class tC{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,t){if(!et(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e);let n=tt(Object.assign(Object.assign({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push(()=>n.disconnect()),this.restoreHandlers.push(tn(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(tu({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){e.contentWindow&&e.contentDocument&&this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,t){let n=this;this.restoreHandlers.push(ej(e.prototype,"attachShadow",function(e){return function(r){let i=e.call(this,r);return this.shadowRoot&&eX(this)&&n.addShadowRoot(this.shadowRoot,t),i}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch(e){}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}class tk{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new eY,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,t){if(0===e.length)return;let n={id:t,styleIds:[]},r=[];for(let t of e){let e;this.styleMirror.has(t)?e=this.styleMirror.getId(t):(e=this.styleMirror.add(t),r.push({styleId:e,rules:Array.from(t.rules||CSSRule,(e,t)=>({rule:er(e),index:t}))})),n.styleIds.push(e)}r.length>0&&(n.styles=r),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}function tT(e){return Object.assign(Object.assign({},e),{timestamp:eF()})}let tM=!1,tx=new ei;function tO(e={}){let t;let{emit:n,checkoutEveryNms:r,checkoutEveryNth:i,blockClass:c="rr-block",blockSelector:l=null,ignoreClass:d="rr-ignore",ignoreSelector:f=null,maskTextClass:h="rr-mask",maskTextSelector:p=null,inlineStylesheet:v=!0,maskAllInputs:g,maskInputOptions:m,slimDOMOptions:y,maskInputFn:_,maskTextFn:b,hooks:w,packFn:S,sampling:I={},dataURLOptions:E={},mousemoveWait:C,recordDOM:k=!0,recordCanvas:T=!1,recordCrossOriginIframes:M=!1,recordAfter:x="DOMContentLoaded"===e.recordAfter?e.recordAfter:"load",userTriggeredOnInput:O=!1,collectFonts:R=!1,inlineImages:P=!1,plugins:N,keepIframeSrcFn:D=()=>!1,ignoreCSSAttributes:A=new Set([]),errorHandler:L}=e;o=L;let q=!M||window.parent===window,j=!1;if(!q)try{window.parent.document&&(j=!1)}catch(e){j=!0}if(q&&!n)throw Error("emit function is required");void 0!==C&&void 0===I.mousemove&&(I.mousemove=C),tx.reset();let F=!0===g?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==m?m:{password:!0},U=!0===y||"all"===y?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===y,headMetaDescKeywords:"all"===y}:y||{};!function(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let t=e[0];if(!(0 in e))throw TypeError("1 argument is required");do if(this===t)return!0;while(t=t&&t.parentNode);return!1})}();let z=0,B=e=>{for(let t of N||[])t.eventProcessor&&(e=t.eventProcessor(e));return S&&!j&&(e=S(e)),e};s=(e,o)=>{var s;if((null===(s=e9[0])||void 0===s?void 0:s.isFrozen())&&e.type!==eT.FullSnapshot&&!(e.type===eT.IncrementalSnapshot&&e.data.source===eM.Mutation)&&e9.forEach(e=>e.unfreeze()),q)null==n||n(B(e),o);else if(j){let t={type:"rrweb",event:B(e),origin:window.location.origin,isCheckout:o};window.parent.postMessage(t,"*")}if(e.type===eT.FullSnapshot)t=e,z=0;else if(e.type===eT.IncrementalSnapshot){if(e.data.source===eM.Mutation&&e.data.isAttachIframe)return;z++;let n=i&&z>=i,o=r&&e.timestamp-t.timestamp>r;(n||o)&&a(!0)}};let W=e=>{s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.Mutation},e)}))},V=e=>s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.Scroll},e)})),K=e=>s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.CanvasMutation},e)})),H=new tk({mutationCb:W,adoptedStyleSheetCb:e=>s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.AdoptedStyleSheet},e)}))}),G=new e2({mirror:tx,mutationCb:W,stylesheetManager:H,recordCrossOriginIframes:M,wrappedEmit:s});for(let e of N||[])e.getMirror&&e.getMirror({nodeMirror:tx,crossOriginIframeMirror:G.crossOriginIframeMirror,crossOriginIframeStyleMirror:G.crossOriginIframeStyleMirror});let $=new tE;u=new tI({recordCanvas:T,mutationCb:K,win:window,blockClass:c,blockSelector:l,mirror:tx,sampling:I.canvas,dataURLOptions:E});let J=new tC({mutationCb:W,scrollCb:V,bypassOptions:{blockClass:c,blockSelector:l,maskTextClass:h,maskTextSelector:p,inlineStylesheet:v,maskInputOptions:F,dataURLOptions:E,maskTextFn:b,maskInputFn:_,recordCanvas:T,inlineImages:P,sampling:I,slimDOMOptions:U,iframeManager:G,stylesheetManager:H,canvasManager:u,keepIframeSrcFn:D,processedNodeManager:$},mirror:tx});a=(e=!1)=>{if(!k)return;s(tT({type:eT.Meta,data:{href:window.location.href,width:eB(),height:ez()}}),e),H.reset(),J.init(),e9.forEach(e=>e.lock());let t=function(e,t){let{mirror:n=new ei,blockClass:r="rr-block",blockSelector:i=null,maskTextClass:o="rr-mask",maskTextSelector:s=null,inlineStylesheet:a=!0,inlineImages:u=!1,recordCanvas:c=!1,maskAllInputs:l=!1,maskTextFn:d,maskInputFn:f,slimDOM:h=!1,dataURLOptions:p,preserveWhiteSpace:v,onSerialize:g,onIframeLoad:m,iframeLoadTimeout:y,onStylesheetLoad:_,stylesheetLoadTimeout:b,keepIframeSrcFn:w=()=>!1}=t||{};return ek(e,{doc:e,mirror:n,blockClass:r,blockSelector:i,maskTextClass:o,maskTextSelector:s,skipChild:!1,inlineStylesheet:a,maskInputOptions:!0===l?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===l?{password:!0}:l,maskTextFn:d,maskInputFn:f,slimDOMOptions:!0===h||"all"===h?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===h,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===h?{}:h,dataURLOptions:p,inlineImages:u,recordCanvas:c,preserveWhiteSpace:v,onSerialize:g,onIframeLoad:m,iframeLoadTimeout:y,onStylesheetLoad:_,stylesheetLoadTimeout:b,keepIframeSrcFn:w,newlyAddedElement:!1})}(document,{mirror:tx,blockClass:c,blockSelector:l,maskTextClass:h,maskTextSelector:p,inlineStylesheet:v,maskAllInputs:F,maskTextFn:b,maskInputFn:_,slimDOM:U,dataURLOptions:E,recordCanvas:T,inlineImages:P,onSerialize:e=>{eG(e,tx)&&G.addIframe(e),e$(e,tx)&&H.trackLinkElement(e),eJ(e)&&J.addShadowRoot(e.shadowRoot,document)},onIframeLoad:(e,t)=>{G.attachIframe(e,t),J.observeAttachShadow(e)},onStylesheetLoad:(e,t)=>{H.attachLinkElement(e,t)},keepIframeSrcFn:D});if(!t)return console.warn("Failed to snapshot the document");s(tT({type:eT.FullSnapshot,data:{node:t,initialOffset:eU(window)}}),e),e9.forEach(e=>e.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&H.adoptStyleSheets(document.adoptedStyleSheets,tx.getId(document))};try{let e=[],t=e=>{var t;return eZ(tc)({mutationCb:W,mousemoveCb:(e,t)=>s(tT({type:eT.IncrementalSnapshot,data:{source:t,positions:e}})),mouseInteractionCb:e=>s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.MouseInteraction},e)})),scrollCb:V,viewportResizeCb:e=>s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.ViewportResize},e)})),inputCb:e=>s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.Input},e)})),mediaInteractionCb:e=>s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.MediaInteraction},e)})),styleSheetRuleCb:e=>s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.StyleSheetRule},e)})),styleDeclarationCb:e=>s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.StyleDeclaration},e)})),canvasMutationCb:K,fontCb:e=>s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.Font},e)})),selectionCb:e=>{s(tT({type:eT.IncrementalSnapshot,data:Object.assign({source:eM.Selection},e)}))},blockClass:c,ignoreClass:d,ignoreSelector:f,maskTextClass:h,maskTextSelector:p,maskInputOptions:F,inlineStylesheet:v,sampling:I,recordDOM:k,recordCanvas:T,inlineImages:P,userTriggeredOnInput:O,collectFonts:R,doc:e,maskInputFn:_,maskTextFn:b,keepIframeSrcFn:D,blockSelector:l,slimDOMOptions:U,dataURLOptions:E,mirror:tx,iframeManager:G,stylesheetManager:H,shadowDomManager:J,processedNodeManager:$,canvasManager:u,ignoreCSSAttributes:A,plugins:(null===(t=null==N?void 0:N.filter(e=>e.observer))||void 0===t?void 0:t.map(e=>({observer:e.observer,options:e.options,callback:t=>s(tT({type:eT.Plugin,data:{plugin:e.name,payload:t}}))})))||[]},w)};G.addLoadListener(n=>{try{e.push(t(n.contentDocument))}catch(e){console.warn(e)}});let n=()=>{a(),e.push(t(document)),tM=!0};return"interactive"===document.readyState||"complete"===document.readyState?n():(e.push(eN("DOMContentLoaded",()=>{s(tT({type:eT.DomContentLoaded,data:{}})),"DOMContentLoaded"===x&&n()})),e.push(eN("load",()=>{s(tT({type:eT.Load,data:{}})),"load"===x&&n()},window))),()=>{e.forEach(e=>e()),$.destroy(),tM=!1,o=void 0}}catch(e){console.warn(e)}}tO.addCustomEvent=(e,t)=>{if(!tM)throw Error("please add custom event after start recording");s(tT({type:eT.Custom,data:{tag:e,payload:t}}))},tO.freezePage=()=>{e9.forEach(e=>e.freeze())},tO.takeFullSnapshot=e=>{if(!tM)throw Error("please take full snapshot after start recording");a(e)},tO.mirror=tx;var tR=Uint8Array,tP=Uint16Array,tN=Uint32Array,tD=new tR([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),tA=new tR([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),tL=new tR([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),tq=function(e,t){for(var n=new tP(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new tN(n[30]),r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return[n,i]},tj=tq(tD,2),tF=tj[0],tU=tj[1];tF[28]=258,tU[258]=28;for(var tz=tq(tA,0),tB=(tz[0],tz[1]),tW=new tP(32768),tV=0;tV<32768;++tV){var tK=(43690&tV)>>>1|(21845&tV)<<1;tK=(61680&(tK=(52428&tK)>>>2|(13107&tK)<<2))>>>4|(3855&tK)<<4,tW[tV]=((65280&tK)>>>8|(255&tK)<<8)>>>1}for(var tH=function(e,t,n){for(var r,i=e.length,o=0,s=new tP(t);o<i;++o)++s[e[o]-1];var a=new tP(t);for(o=0;o<t;++o)a[o]=a[o-1]+s[o-1]<<1;if(n){r=new tP(1<<t);var u=15-t;for(o=0;o<i;++o)if(e[o])for(var c=o<<4|e[o],l=t-e[o],d=a[e[o]-1]++<<l,f=d|(1<<l)-1;d<=f;++d)r[tW[d]>>>u]=c}else for(o=0,r=new tP(i);o<i;++o)r[o]=tW[a[e[o]-1]++]>>>15-e[o];return r},tG=new tR(288),tV=0;tV<144;++tV)tG[tV]=8;for(var tV=144;tV<256;++tV)tG[tV]=9;for(var tV=256;tV<280;++tV)tG[tV]=7;for(var tV=280;tV<288;++tV)tG[tV]=8;for(var t$=new tR(32),tV=0;tV<32;++tV)t$[tV]=5;var tJ=tH(tG,9,0),tY=tH(t$,5,0),tQ=function(e){return(e/8>>0)+(7&e&&1)},tX=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof tP?tP:e instanceof tN?tN:tR)(n-t);return r.set(e.subarray(t,n)),r},tZ=function(e,t,n){n<<=7&t;var r=t/8>>0;e[r]|=n,e[r+1]|=n>>>8},t0=function(e,t,n){n<<=7&t;var r=t/8>>0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},t1=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,o=n.slice();if(!i)return[new tR(0),0];if(1==i){var s=new tR(n[0].s+1);return s[n[0].s]=1,[s,1]}n.sort(function(e,t){return e.f-t.f}),n.push({s:-1,f:25001});var a=n[0],u=n[1],c=0,l=1,d=2;for(n[0]={s:-1,f:a.f+u.f,l:a,r:u};l!=i-1;)a=n[n[c].f<n[d].f?c++:d++],u=n[c!=l&&n[c].f<n[d].f?c++:d++],n[l++]={s:-1,f:a.f+u.f,l:a,r:u};for(var f=o[0].s,r=1;r<i;++r)o[r].s>f&&(f=o[r].s);var h=new tP(f+1),p=t2(n[l-1],h,0);if(p>t){var r=0,v=0,g=p-t,m=1<<g;for(o.sort(function(e,t){return h[t.s]-h[e.s]||e.f-t.f});r<i;++r){var y=o[r].s;if(h[y]>t)v+=m-(1<<p-h[y]),h[y]=t;else break}for(v>>>=g;v>0;){var _=o[r].s;h[_]<t?v-=1<<t-h[_]++-1:++r}for(;r>=0&&v;--r){var b=o[r].s;h[b]==t&&(--h[b],++v)}p=t}return[new tR(h),p]},t2=function(e,t,n){return -1==e.s?Math.max(t2(e.l,t,n+1),t2(e.r,t,n+1)):t[e.s]=n},t3=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new tP(++t),r=0,i=e[0],o=1,s=function(e){n[r++]=e},a=1;a<=t;++a)if(e[a]==i&&a!=t)++o;else{if(!i&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(i),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(i);o=1,i=e[a]}return[n.subarray(0,r),t]},t4=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},t5=function(e,t,n){var r=n.length,i=tQ(t+2);e[i]=255&r,e[i+1]=r>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var o=0;o<r;++o)e[i+o+4]=n[o];return(i+4+r)*8},t6=function(e,t,n,r,i,o,s,a,u,c,l){tZ(t,l++,n),++i[256];for(var d,f,h,p,v=t1(i,15),g=v[0],m=v[1],y=t1(o,15),_=y[0],b=y[1],w=t3(g),S=w[0],I=w[1],E=t3(_),C=E[0],k=E[1],T=new tP(19),M=0;M<S.length;++M)T[31&S[M]]++;for(var M=0;M<C.length;++M)T[31&C[M]]++;for(var x=t1(T,7),O=x[0],R=x[1],P=19;P>4&&!O[tL[P-1]];--P);var N=c+5<<3,D=t4(i,tG)+t4(o,t$)+s,A=t4(i,g)+t4(o,_)+s+14+3*P+t4(T,O)+(2*T[16]+3*T[17]+7*T[18]);if(N<=D&&N<=A)return t5(t,l,e.subarray(u,u+c));if(tZ(t,l,1+(A<D)),l+=2,A<D){d=tH(g,m,0),f=g,h=tH(_,b,0),p=_;var L=tH(O,R,0);tZ(t,l,I-257),tZ(t,l+5,k-1),tZ(t,l+10,P-4),l+=14;for(var M=0;M<P;++M)tZ(t,l+3*M,O[tL[M]]);l+=3*P;for(var q=[S,C],j=0;j<2;++j)for(var F=q[j],M=0;M<F.length;++M){var U=31&F[M];tZ(t,l,L[U]),l+=O[U],U>15&&(tZ(t,l,F[M]>>>5&127),l+=F[M]>>>12)}}else d=tJ,f=tG,h=tY,p=t$;for(var M=0;M<a;++M)if(r[M]>255){var U=r[M]>>>18&31;t0(t,l,d[U+257]),l+=f[U+257],U>7&&(tZ(t,l,r[M]>>>23&31),l+=tD[U]);var z=31&r[M];t0(t,l,h[z]),l+=p[z],z>3&&(t0(t,l,r[M]>>>5&8191),l+=tA[z])}else t0(t,l,d[r[M]]),l+=f[r[M]];return t0(t,l,d[256]),l+f[256]},t8=new tN([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),t7=new tR(0),t9=function(e,t,n,r,i,o){var s=e.length,a=new tR(r+s+5*(1+Math.floor(s/7e3))+i),u=a.subarray(r,a.length-i),c=0;if(!t||s<8)for(var l=0;l<=s;l+=65535){var d=l+65535;d<s?c=t5(u,c,e.subarray(l,d)):(u[l]=o,c=t5(u,c,e.subarray(l,s)))}else{for(var f=t8[t-1],h=f>>>13,p=8191&f,v=(1<<n)-1,g=new tP(32768),m=new tP(v+1),y=Math.ceil(n/3),_=2*y,b=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<_)&v},w=new tN(25e3),S=new tP(288),I=new tP(32),E=0,C=0,l=0,k=0,T=0,M=0;l<s;++l){var x=b(l),O=32767&l,R=m[x];if(g[O]=R,m[x]=O,T<=l){var P=s-l;if((E>7e3||k>24576)&&P>423){c=t6(e,u,0,w,S,I,C,k,M,l-M,c),k=E=C=0,M=l;for(var N=0;N<286;++N)S[N]=0;for(var N=0;N<30;++N)I[N]=0}var D=2,A=0,L=p,q=O-R&32767;if(P>2&&x==b(l-q))for(var j=Math.min(h,P)-1,F=Math.min(32767,l),U=Math.min(258,P);q<=F&&--L&&O!=R;){if(e[l+D]==e[l+D-q]){for(var z=0;z<U&&e[l+z]==e[l+z-q];++z);if(z>D){if(D=z,A=q,z>j)break;for(var B=Math.min(q,z-2),W=0,N=0;N<B;++N){var V=l-q+N+32768&32767,K=g[V],H=V-K+32768&32767;H>W&&(W=H,R=V)}}}R=g[O=R],q+=O-R+32768&32767}if(A){w[k++]=268435456|tU[D]<<18|tB[A];var G=31&tU[D],$=31&tB[A];C+=tD[G]+tA[$],++S[257+G],++I[$],T=l+D,++E}else w[k++]=e[l],++S[e[l]]}}c=t6(e,u,o,w,S,I,C,k,M,l-M,c),o||(c=t5(u,c,t7))}return tX(a,0,r+tQ(c)+i)},ne=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,o=n.length,s=0;s!=o;){for(var a=Math.min(s+5552,o);s<a;++s)r+=n[s],i+=r;r%=65521,i%=65521}e=r,t=i},d:function(){return(e>>>8<<16|(255&t)<<8|t>>>8)+((255&e)<<23)*2}}},nt=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},nn=function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;e[0]=120,e[1]=r<<6|(r?32-2*r:1)};let nr=e=>{var t,n,r,i,o;return function(e,t){var n="";if(!t&&"undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);for(var r=0;r<e.length;){var i=e[r++];i<128||t?n+=String.fromCharCode(i):i<224?n+=String.fromCharCode((31&i)<<6|63&e[r++]):i<240?n+=String.fromCharCode((15&i)<<12|(63&e[r++])<<6|63&e[r++]):n+=String.fromCharCode(55296|(i=((15&i)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536)>>10,56320|1023&i)}return n}((t=function(e,t){var n=e.length;if("undefined"!=typeof TextEncoder)return new TextEncoder().encode(e);for(var r=new tR(e.length+(e.length>>>1)),i=0,o=function(e){r[i++]=e},s=0;s<n;++s){if(i+5>r.length){var a=new tR(i+8+(n-s<<1));a.set(r),r=a}var u=e.charCodeAt(s);u<128?o(u):(u<2048?o(192|u>>>6):(u>55295&&u<57344?(o(240|(u=65536+(1047552&u)|1023&e.charCodeAt(++s))>>>18),o(128|u>>>12&63)):o(224|u>>>12),o(128|u>>>6&63)),o(128|63&u))}return tX(r,0,i)}(JSON.stringify(Object.assign(Object.assign({},e),{v:"v1"}))),void 0===n&&(n={}),(r=ne()).p(t),nn(o=t9(t,null==(i=n).level?6:i.level,null==i.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+i.mem,2,4,!0),n),nt(o,o.length-4,r.d()),o),!0)};var ni=n(327704),no=n(594789),ns="Remote config fetch rejected due to timeout after 5 seconds",na=function(){function e(e){var t=e.localConfig,n=e.configKeys,r=this;this.retryTimeout=1e3,this.attempts=0,this.sessionTargetingMatch=!1,this.metrics={},this.getRemoteConfig=function(e,t,n){return(0,L.__awaiter)(r,void 0,void 0,function(){var r,i,o;return(0,L.__generator)(this,function(s){switch(s.label){case 0:return r=Date.now(),[4,this.fetchWithTimeout(n)];case 1:if((i=s.sent())&&(o=i.configs&&i.configs[e]))return this.metrics.fetchTimeAPISuccess=Date.now()-r,[2,o[t]];return this.metrics.fetchTimeAPIFail=Date.now()-r,[2,void 0]}})})},this.fetchWithTimeout=function(e){return(0,L.__awaiter)(r,void 0,void 0,function(){var t,n,r;return(0,L.__generator)(this,function(i){switch(i.label){case 0:return t=new AbortController,n=setTimeout(function(){return t.abort()},5e3),[4,this.fetchRemoteConfig(t.signal,e)];case 1:return r=i.sent(),clearTimeout(n),[2,r]}})})},this.fetchRemoteConfig=function(e,t){return(0,L.__awaiter)(r,void 0,void 0,function(){var n,r,i,o,s,a,u,c,l,d;return(0,L.__generator)(this,function(f){switch(f.label){case 0:if(t===this.lastFetchedSessionId&&this.attempts>=this.localConfig.flushMaxRetries)return[2,this.completeRequest({err:"Remote config fetch rejected due to exceeded retry count"})];if(e.aborted)return[2,this.completeRequest({err:ns})];t!==this.lastFetchedSessionId&&(this.lastFetchedSessionId=t,this.attempts=0),f.label=1;case 1:f.trys.push([1,3,,4]),n=new URLSearchParams({api_key:this.localConfig.apiKey});try{for(i=(r=(0,L.__values)(this.configKeys)).next();!i.done;i=r.next())o=i.value,n.append("config_keys",o)}catch(e){l={error:e}}finally{try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(l)throw l.error}}return t&&n.set("session_id",String(t)),s={headers:{Accept:"*/*"},method:"GET"},a="".concat(this.getServerUrl(),"?").concat(n.toString()),this.attempts+=1,[4,fetch(a,(0,L.__assign)((0,L.__assign)({},s),{signal:e}))];case 2:if(null===(u=f.sent()))return[2,this.completeRequest({err:"Unexpected error occurred"})];switch(new ni.d().buildStatus(u.status)){case no.q.Success:return this.attempts=0,[2,this.parseAndStoreConfig(u)];case no.q.Failed:return[2,this.retryFetch(e,t)];default:return[2,this.completeRequest({err:"Network error occurred, remote config fetch failed"})]}return[3,4];case 3:if(c=f.sent(),e.aborted)return[2,this.completeRequest({err:ns})];return[2,this.completeRequest({err:c.message})];case 4:return[2]}})})},this.retryFetch=function(e,t){return(0,L.__awaiter)(r,void 0,void 0,function(){var n=this;return(0,L.__generator)(this,function(r){switch(r.label){case 0:return[4,new Promise(function(e){return setTimeout(e,n.attempts*n.retryTimeout)})];case 1:return r.sent(),[2,this.fetchRemoteConfig(e,t)]}})})},this.parseAndStoreConfig=function(e){return(0,L.__awaiter)(r,void 0,void 0,function(){var t;return(0,L.__generator)(this,function(n){switch(n.label){case 0:return[4,e.json()];case 1:return t=n.sent(),this.completeRequest({success:"Remote config successfully fetched"}),[2,t]}})})},this.localConfig=t,this.configKeys=n}return e.prototype.getServerUrl=function(){return this.localConfig.serverZone===W.J.STAGING?"https://sr-client-cfg.stag2.amplitude.com/config":this.localConfig.serverZone===W.J.EU?"https://sr-client-cfg.eu.amplitude.com/config":"https://sr-client-cfg.amplitude.com/config"},e.prototype.completeRequest=function(e){var t=e.err,n=e.success;if(t)throw Error(t);n&&this.localConfig.loggerProvider.log(n)},e}(),nu=function(e){var t=e.localConfig,n=e.configKeys;return(0,L.__awaiter)(void 0,void 0,void 0,function(){return(0,L.__generator)(this,function(e){return[2,new na({localConfig:t,configKeys:n})]})})},nc="medium";(_=R||(R={}))[_.Document=0]="Document",_[_.DocumentType=1]="DocumentType",_[_.Element=2]="Element",_[_.Text=3]="Text",_[_.CDATA=4]="CDATA",_[_.Comment=5]="Comment",RegExp(/(max|min)-device-(width|height)/.source,"g"),RegExp(/([^\\]):hover/.source,"g");var nl=function(e,t,n){switch(t){case"light":if("input"!==e)return!0;var r=n?function(e){let t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?t.toLowerCase():null}(n):"";if(!r)return!1;if(["password","hidden","email","tel"].includes(r)||n.autocomplete.startsWith("cc-"))return!0;return!1;case"medium":case"conservative":return!0;default:return nl(e,nc,n)}},nd=function(e,t,n){var r,i,o;if(void 0===t&&(t={defaultMaskLevel:nc}),n){if(n.closest("."+$)||(null!==(r=t.maskSelector)&&void 0!==r?r:[]).some(function(e){return n.closest(e)}))return!0;if(n.closest(".amp-unmask")||(null!==(i=t.unmaskSelector)&&void 0!==i?i:[]).some(function(e){return n.closest(e)}))return!1}return nl(e,null!==(o=t.defaultMaskLevel)&&void 0!==o?o:nc,n)},nf=function(e,t){return function(n,r){return nd(e,t,r)?n.replace(/[^\s]/g,"*"):n}},nh=function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t},np=function(){var e=(0,Q.l)();return(null==e?void 0:e.location)?e.location.href:""},nv=function(e){return e===W.J.STAGING?"https://api-sr.stag2.amplitude.com/sessions/v2/track":e===W.J.EU?"https://api-sr.eu.amplitude.com/sessions/v2/track":"https://api-sr.amplitude.com/sessions/v2/track"},ng=function(){return(0,L.__awaiter)(void 0,void 0,void 0,function(){var e,t,n,r;return(0,L.__generator)(this,function(i){switch(i.label){case 0:if(i.trys.push([0,3,,4]),!(e=(0,Q.l)()))return[3,2];return[4,e.navigator.storage.estimate()];case 1:return n=(t=i.sent()).usage,r=t.quota,[2,{totalStorageSize:n?Math.round(n/1024):0,percentOfQuota:n&&r?Math.round((n/r+Number.EPSILON)*1e3)/1e3:0,usageDetails:JSON.stringify(t.usageDetails)}];case 2:return[3,4];case 3:return i.sent(),[3,4];case 4:return[2,{totalStorageSize:0,percentOfQuota:0,usageDetails:""}]}})})},nm=function(e){var t=(0,L.__assign)({},e),n=t.apiKey;return t.apiKey="****".concat(n.substring(n.length-4)),t},ny=function(e,t){var n=document.createDocumentFragment(),r=function(e){if(void 0===e&&(e=[]),"string"==typeof e&&(e=[e]),0!==(e=e.filter(function(e){try{n.querySelector(e)}catch(n){return t.warn('[session-replay-browser] omitting selector "'.concat(e,'" because it is invalid')),!1}return!0})).length)return e};return e.blockSelector=r(e.blockSelector),e.maskSelector=r(e.maskSelector),e.unmaskSelector=r(e.unmaskSelector),e},n_=function(){function e(e,t){this.localConfig=new Y(e,t)}return e.prototype.initialize=function(){return(0,L.__awaiter)(this,void 0,void 0,function(){var e;return(0,L.__generator)(this,function(t){switch(t.label){case 0:return e=this,[4,nu({localConfig:this.localConfig,configKeys:["sessionReplay"]})];case 1:return e.remoteConfigFetch=t.sent(),[2]}})})},e.prototype.generateJoinedConfig=function(e){var t,n,r;return(0,L.__awaiter)(this,void 0,void 0,function(){var i,o,s,a,u,c,l,d,f,h,p,v,g,m,y,_,b,w,S;return(0,L.__generator)(this,function(I){switch(I.label){case 0:(i=(0,L.__assign)({},this.localConfig)).optOut=this.localConfig.optOut,i.captureEnabled=!0,I.label=1;case 1:if(I.trys.push([1,5,,6]),!this.remoteConfigFetch)return i.captureEnabled=!1,[2,i];return[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_sampling_config",e)];case 2:return s=I.sent(),[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_privacy_config",e)];case 3:return a=I.sent(),u=i,[4,this.remoteConfigFetch.getRemoteConfig("sessionReplay","sr_interaction_config",e)];case 4:return u.interactionConfig=I.sent(),(s||a)&&(o={},s&&(o.sr_sampling_config=s),a&&(o.sr_privacy_config=a)),[3,6];case 5:return c=I.sent(),this.localConfig.loggerProvider.warn(c.message),i.captureEnabled=!1,[3,6];case 6:if(!o)return[2,i];if(l=o.sr_sampling_config,d=o.sr_privacy_config,l&&Object.keys(l).length>0?(Object.prototype.hasOwnProperty.call(l,"capture_enabled")?i.captureEnabled=l.capture_enabled:i.captureEnabled=!1,Object.prototype.hasOwnProperty.call(l,"sample_rate")&&(i.sampleRate=l.sample_rate)):(i.captureEnabled=!0,this.localConfig.loggerProvider.debug("Remote config successfully fetched, but no values set for project, Session Replay capture enabled.")),d){f=null!==(t=i.privacyConfig)&&void 0!==t?t:{},h={defaultMaskLevel:null!==(r=null!==(n=d.defaultMaskLevel)&&void 0!==n?n:f.defaultMaskLevel)&&void 0!==r?r:"medium",blockSelector:[],maskSelector:[],unmaskSelector:[]},p=function(e){var t,n,r,i,o,s,a,u,c,l={};"string"==typeof e.blockSelector&&(e.blockSelector=[e.blockSelector]);try{for(var d=(0,L.__values)(null!==(a=e.blockSelector)&&void 0!==a?a:[]),f=d.next();!f.done;f=d.next()){var h=f.value;l[h]="block"}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}try{for(var p=(0,L.__values)(null!==(u=e.maskSelector)&&void 0!==u?u:[]),v=p.next();!v.done;v=p.next()){var h=v.value;l[h]="mask"}}catch(e){r={error:e}}finally{try{v&&!v.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}try{for(var g=(0,L.__values)(null!==(c=e.unmaskSelector)&&void 0!==c?c:[]),m=g.next();!m.done;m=g.next()){var h=m.value;l[h]="unmask"}}catch(e){o={error:e}}finally{try{m&&!m.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}return l},v=(0,L.__assign)((0,L.__assign)({},p(f)),p(d));try{for(m=(g=(0,L.__values)(Object.entries(v))).next();!m.done;m=g.next())_=(y=(0,L.__read)(m.value,2))[0],b=y[1],"mask"===b?h.maskSelector.push(_):"block"===b?h.blockSelector.push(_):"unmask"===b&&h.unmaskSelector.push(_)}catch(e){w={error:e}}finally{try{m&&!m.done&&(S=g.return)&&S.call(g)}finally{if(w)throw w.error}}i.privacyConfig=ny(h,this.localConfig.loggerProvider)}return this.localConfig.loggerProvider.debug(JSON.stringify({name:"session replay joined config",config:nm(i)},null,2)),[2,i]}})})},e}(),nb=n(997172),nw="Failed to store session replay events in IndexedDB";(b=P||(P={})).RECORDING="recording",b.SENT="sent";var nS="sessionCurrentSequence",nI="sequencesToSend",nE=function(){var e=(0,Q.l)();return new Promise(function(t,n){if(!e)return n(Error("Global scope not found"));if(!e.indexedDB)return n(Error("Session Replay: cannot find indexedDB"));try{var r=e.indexedDB.open("keyval-store");r.onupgradeneeded=function(){1===r.result.version&&(r.result.close(),r.transaction&&r.transaction.abort(),e.indexedDB.deleteDatabase("keyval-store"),t())},r.onsuccess=function(){t(r.result)}}catch(e){n(e)}})},nC=function(e){return(0,L.__awaiter)(void 0,void 0,void 0,function(){return(0,L.__generator)(this,function(t){switch(t.label){case 0:if(!(e.length>0))return[3,2];return[4,Promise.all(e.splice(0,10))];case 1:return t.sent(),[3,0];case 2:return[2]}})})},nk=function(e){var t,n;return e.objectStoreNames.contains(nS)||(n=e.createObjectStore(nS,{keyPath:"sessionId"})),e.objectStoreNames.contains(nI)||(t=e.createObjectStore(nI,{keyPath:"sequenceId",autoIncrement:!0})).createIndex("sessionId","sessionId"),{sequencesStore:t,currentSequenceStore:n}},nT=function(){function e(e){var t=e.loggerProvider,n=e.apiKey,r=e.minInterval,i=e.maxInterval,o=this;this.storageKey="",this.maxPersistedEventsSize=1e6,this.timeAtLastSplit=null,this.shouldSplitEventsList=function(e,t){var n=new Blob([t]).size;return new Blob(e).size+n>=o.maxPersistedEventsSize||!!(null!==o.timeAtLastSplit&&o.interval&&Date.now()-o.timeAtLastSplit>o.interval)&&!!e.length&&(o.interval=Math.min(o.maxInterval,o.interval+o.minInterval),o.timeAtLastSplit=Date.now(),!0)},this.getSequencesToSend=function(){return(0,L.__awaiter)(o,void 0,void 0,function(){var e,t;return(0,L.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,null===(t=this.db)||void 0===t?void 0:t.getAll(nI)];case 1:return[2,n.sent()];case 2:return e=n.sent(),this.loggerProvider.warn("".concat(nw,": ").concat(e)),[3,3];case 3:return[2,void 0]}})})},this.storeCurrentSequence=function(e){return(0,L.__awaiter)(o,void 0,void 0,function(){var t,n,r;return(0,L.__generator)(this,function(i){switch(i.label){case 0:if(i.trys.push([0,4,,5]),!this.db)return[2,void 0];return[4,this.db.get(nS,e)];case 1:if(!(t=i.sent()))return[2,void 0];return[4,this.db.put(nI,{sessionId:e,events:t.events})];case 2:return n=i.sent(),[4,this.db.put(nS,{sessionId:e,events:[]})];case 3:return i.sent(),[2,(0,L.__assign)((0,L.__assign)({},t),{sessionId:e,sequenceId:n})];case 4:return r=i.sent(),this.loggerProvider.warn("".concat(nw,": ").concat(r)),[3,5];case 5:return[2,void 0]}})})},this.addEventToCurrentSequence=function(e,t){return(0,L.__awaiter)(o,void 0,void 0,function(){var n,r,i,o,s,a,u;return(0,L.__generator)(this,function(c){switch(c.label){case 0:0===this.interval&&(this.interval=this.minInterval),c.label=1;case 1:if(c.trys.push([1,11,,12]),!(n=null===(u=this.db)||void 0===u?void 0:u.transaction(nS,"readwrite")))return[2];return[4,n.store.get(e)];case 2:if(r=c.sent())return[3,4];return[4,n.store.put({sessionId:e,events:[t]})];case 3:return c.sent(),[2];case 4:if(i=void 0,!this.shouldSplitEventsList(r.events,t))return[3,6];return i=r.events,[4,n.store.put({sessionId:e,events:[t]})];case 5:return c.sent(),[3,8];case 6:return o=r.events.concat(t),[4,n.store.put({sessionId:e,events:o})];case 7:c.sent(),c.label=8;case 8:return[4,n.done];case 9:if(c.sent(),!i)return[2,void 0];return[4,this.storeSendingEvents(e,i)];case 10:if(!(s=c.sent()))return[2,void 0];return[2,{events:i,sessionId:e,sequenceId:s}];case 11:return a=c.sent(),this.loggerProvider.warn("".concat(nw,": ").concat(a)),[3,12];case 12:return[2,void 0]}})})},this.storeSendingEvents=function(e,t){return(0,L.__awaiter)(o,void 0,void 0,function(){var n,r;return(0,L.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,null===(r=this.db)||void 0===r?void 0:r.put(nI,{sessionId:e,events:t})];case 1:return[2,i.sent()];case 2:return n=i.sent(),this.loggerProvider.warn("".concat(nw,": ").concat(n)),[3,3];case 3:return[2,void 0]}})})},this.cleanUpSessionEventsStore=function(e){return(0,L.__awaiter)(o,void 0,void 0,function(){var t,n;return(0,L.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,null===(n=this.db)||void 0===n?void 0:n.delete(nI,e)];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),this.loggerProvider.warn("".concat(nw,": ").concat(t)),[3,3];case 3:return[2]}})})},this.transitionFromKeyValStore=function(e){return(0,L.__awaiter)(o,void 0,void 0,function(){var t,n,r,i,o,s,a,u=this;return(0,L.__generator)(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,nE()];case 1:if(!(t=c.sent()))return[2];n=function(e,t){return(0,L.__awaiter)(u,void 0,void 0,function(){var n,r,i=this;return(0,L.__generator)(this,function(o){switch(o.label){case 0:return n=t.sessionSequences,r=[],Object.keys(n).forEach(function(o){var s=parseInt(o,10),a=n[s];if(s===t.currentSequenceId){var u=a.events.map(function(t){return(0,L.__awaiter)(i,void 0,void 0,function(){return(0,L.__generator)(this,function(n){return[2,this.addEventToCurrentSequence(e,t)]})})});r.concat(u)}else a.status!==P.SENT&&r.push(i.storeSendingEvents(e,a.events))}),[4,nC(r)];case 1:return o.sent(),[2]}})})},r="".concat(B.f1,"_").concat(this.apiKey.substring(0,10)),c.label=2;case 2:return c.trys.push([2,4,,5]),i=t.transaction("keyval").objectStore("keyval").getAll(r),[4,new Promise(function(t){i.onsuccess=function(r){return(0,L.__awaiter)(u,void 0,void 0,function(){var i,o,s,a=this;return(0,L.__generator)(this,function(u){switch(u.label){case 0:if(!(o=(i=r&&r.target.result)&&i[0]))return[3,2];return s=[],Object.keys(o).forEach(function(t){var r=parseInt(t,10),i=o[r];if(e===r)s.push(n(r,i));else{var u=i.sessionSequences;Object.keys(u).forEach(function(e){var t=parseInt(e,10);u[t].status!==P.SENT&&s.push(a.storeSendingEvents(r,u[t].events))})}}),[4,nC(s)];case 1:u.sent(),u.label=2;case 2:return t(),[2]}})})}})];case 3:return c.sent(),(o=(0,Q.l)())&&o.indexedDB.deleteDatabase("keyval-store"),[3,5];case 4:return s=c.sent(),this.loggerProvider.warn("Failed to transition session replay events from keyval to new store: ".concat(s)),[3,5];case 5:return[3,7];case 6:return a=c.sent(),this.loggerProvider.warn("Failed to access keyval store: ".concat(a,". For more information, visit: https://www.docs.developers.amplitude.com/session-replay/sdks/standalone/#indexeddb-best-practices")),[3,7];case 7:return[2]}})})},this.loggerProvider=t,this.apiKey=n,this.maxInterval=null!=i?i:1e4,this.minInterval=null!=r?r:500,this.interval=0}return e.prototype.initialize=function(e,t){return(0,L.__awaiter)(this,void 0,void 0,function(){var n,r,i;return(0,L.__generator)(this,function(o){switch(o.label){case 0:return n="replay"===e?"":"_".concat(e),r="".concat(this.apiKey.substring(0,10),"_amp_session_replay_events").concat(n),i=this,[4,(0,L.__awaiter)(void 0,void 0,void 0,function(){return(0,L.__generator)(this,function(e){switch(e.label){case 0:return[4,(0,nb.X3)(r,1,{upgrade:nk})];case 1:return[2,e.sent()]}})})];case 1:return i.db=o.sent(),this.timeAtLastSplit=Date.now(),[4,this.transitionFromKeyValStore(t)];case 2:return o.sent(),[2]}})})},e}(),nM=function(e){var t=e.loggerProvider,n=e.apiKey,r=e.sessionId,i=e.type,o=e.minInterval,s=e.maxInterval;return(0,L.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,L.__generator)(this,function(a){switch(a.label){case 0:return[4,(e=new nT({loggerProvider:t,apiKey:n,minInterval:o,maxInterval:s})).initialize(i,r)];case 1:return a.sent(),[2,e]}})})},nx="1.13.7",nO=function(){function e(e){var t=e.loggerProvider,n=e.payloadBatcher;this.storageKey="",this.retryTimeout=1e3,this.scheduled=null,this.queue=[],this.loggerProvider=t,this.payloadBatcher=n||function(e){return e}}return e.prototype.sendEventsList=function(e){this.addToQueue((0,L.__assign)((0,L.__assign)({},e),{attempts:0,timeout:0}))},e.prototype.addToQueue=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.filter(function(t){return t.attempts<(t.flushMaxRetries||0)?(t.attempts+=1,!0):(e.completeRequest({context:t,err:"".concat("Session replay event batch rejected due to exceeded retry count",", batch sequence id, ").concat(t.sequenceId)}),!1)}).forEach(function(t){if(e.queue=e.queue.concat(t),0===t.timeout){e.schedule(0);return}setTimeout(function(){t.timeout=0,e.schedule(0)},t.timeout)})},e.prototype.schedule=function(e){var t=this;this.scheduled||(this.scheduled=setTimeout(function(){t.flush(!0).then(function(){t.queue.length>0&&t.schedule(e)})},e))},e.prototype.flush=function(e){return void 0===e&&(e=!1),(0,L.__awaiter)(this,void 0,void 0,function(){var t,n,r=this;return(0,L.__generator)(this,function(i){switch(i.label){case 0:return t=[],n=[],this.queue.forEach(function(e){return 0===e.timeout?t.push(e):n.push(e)}),this.queue=n,this.scheduled&&(clearTimeout(this.scheduled),this.scheduled=null),[4,Promise.all(t.map(function(t){return r.send(t,e)}))];case 1:return i.sent(),[2]}})})},e.prototype.send=function(e,t){var n,r;return void 0===t&&(t=!0),(0,L.__awaiter)(this,void 0,void 0,function(){var i,o,s,a,u,c,l,d,f,h,p,v;return(0,L.__generator)(this,function(g){switch(g.label){case 0:if(!(i=e.apiKey))return[2,this.completeRequest({context:e,err:"Session replay event batch not sent due to missing api key"})];if(!(o=e.deviceId))return[2,this.completeRequest({context:e,err:"Session replay event batch not sent due to missing device ID"})];if(s=np(),a=nx,u=e.sampleRate,c=new URLSearchParams({device_id:o,session_id:"".concat(e.sessionId),seq_number:"".concat(e.sequenceId),type:"".concat(e.type)}),l="".concat((null===(n=e.version)||void 0===n?void 0:n.type)||"standalone","/").concat((null===(r=e.version)||void 0===r?void 0:r.version)||a),0===(d=this.payloadBatcher({version:1,events:e.events})).events.length)return this.completeRequest({context:e}),[2];g.label=1;case 1:return g.trys.push([1,3,,4]),f={headers:{"Content-Type":"application/json",Accept:"*/*",Authorization:"Bearer ".concat(i),"X-Client-Version":a,"X-Client-Library":l,"X-Client-Url":s,"X-Client-Sample-Rate":"".concat(u)},body:JSON.stringify(d),method:"POST"},[4,fetch("".concat(nv(e.serverZone),"?").concat(c.toString()),f)];case 2:if(null===(h=g.sent()))return this.completeRequest({context:e,err:"Unexpected error occurred"}),[2];if(t)this.handleReponse(h.status,e);else{p="";try{p=JSON.stringify(h.body,null,2)}catch(e){}this.completeRequest({context:e,success:"".concat(h.status,": ").concat(p)})}return[3,4];case 3:return v=g.sent(),this.completeRequest({context:e,err:v}),[3,4];case 4:return[2]}})})},e.prototype.handleReponse=function(e,t){switch(new ni.d().buildStatus(e)){case no.q.Success:this.handleSuccessResponse(t);break;case no.q.Failed:this.handleOtherResponse(t);break;default:this.completeRequest({context:t,err:"Network error occurred, event batch rejected"})}},e.prototype.handleSuccessResponse=function(e){var t=Math.round(new Blob(e.events).size/1024);this.completeRequest({context:e,success:"Session replay event batch with seq id ".concat(e.sequenceId," tracked successfully for session id ").concat(e.sessionId,", size of events: ").concat(t," KB")})},e.prototype.handleOtherResponse=function(e){this.addToQueue((0,L.__assign)((0,L.__assign)({},e),{timeout:e.attempts*this.retryTimeout}))},e.prototype.completeRequest=function(e){var t=e.context,n=e.err,r=e.success;t.onComplete(t.sequenceId),n?this.loggerProvider.warn(n):r&&this.loggerProvider.log(r)},e}(),nR=function(e){var t=e.config,n=e.sessionId,r=e.minInterval,i=e.maxInterval,o=e.type,s=e.payloadBatcher;return(0,L.__awaiter)(void 0,void 0,void 0,function(){var e,a,u;function c(t){return void 0===t&&(t=!1),(0,L.__awaiter)(this,void 0,void 0,function(){return(0,L.__generator)(this,function(n){return[2,e.flush(t)]})})}return(0,L.__generator)(this,function(l){switch(l.label){case 0:return e=new nO({loggerProvider:t.loggerProvider,payloadBatcher:s}),[4,nM({loggerProvider:t.loggerProvider,apiKey:t.apiKey,sessionId:n,minInterval:r,maxInterval:i,type:o})];case 1:return a=l.sent(),u=function(n){var r=n.events,i=n.sessionId,s=n.deviceId,u=n.sequenceId;t.debugMode&&ng().then(function(e){var n=e.totalStorageSize,r=e.percentOfQuota,i=e.usageDetails;t.loggerProvider.debug("Total storage size: ".concat(n," KB, percentage of quota: ").concat(r,"%, usage details: ").concat(i))}).catch(function(){}),e.sendEventsList({events:r,sequenceId:u,sessionId:i,flushMaxRetries:t.flushMaxRetries,apiKey:t.apiKey,deviceId:s,sampleRate:t.sampleRate,serverZone:t.serverZone,version:t.version,type:o,onComplete:a.cleanUpSessionEventsStore.bind(a)})},[2,{sendCurrentSequenceEvents:function(e){var n=e.sessionId,r=e.deviceId;a.storeCurrentSequence(n).then(function(e){e&&u({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:r})}).catch(function(e){t.loggerProvider.warn("Failed to get current sequence of session replay events for session:",e)})},addEvent:function(e){var n=e.event,r=e.sessionId,i=e.deviceId;a.addEventToCurrentSequence(r,n.data).then(function(e){return e&&u({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:i})}).catch(function(e){t.loggerProvider.warn("Failed to add event to session replay capture:",e)})},sendStoredEvents:function(e){var t=e.deviceId;return(0,L.__awaiter)(void 0,void 0,void 0,function(){var e;return(0,L.__generator)(this,function(n){switch(n.label){case 0:return[4,a.getSequencesToSend()];case 1:return(e=n.sent())&&e.forEach(function(e){u({sequenceId:e.sequenceId,events:e.events,sessionId:e.sessionId,deviceId:t})}),[2]}})})},flush:c}]}})})},nP=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=new Map;e.forEach(function(e){n.set(e.name,e.manager)}),this.managers=n}return e.prototype.sendStoredEvents=function(e){return(0,L.__awaiter)(this,void 0,void 0,function(){var t;return(0,L.__generator)(this,function(n){switch(n.label){case 0:return t=[],this.managers.forEach(function(n){t.push(n.sendStoredEvents(e))}),[4,Promise.all(t)];case 1:return n.sent(),[2]}})})},e.prototype.addEvent=function(e){var t,n=e.sessionId,r=e.event,i=e.deviceId;null===(t=this.managers.get(r.type))||void 0===t||t.addEvent({sessionId:n,event:r,deviceId:i})},e.prototype.sendCurrentSequenceEvents=function(e){var t=e.sessionId,n=e.deviceId;this.managers.forEach(function(e){e.sendCurrentSequenceEvents({sessionId:t,deviceId:n})})},e.prototype.flush=function(e){return(0,L.__awaiter)(this,void 0,void 0,function(){var t;return(0,L.__generator)(this,function(n){switch(n.label){case 0:return t=[],this.managers.forEach(function(n){t.push(n.flush(e))}),[4,Promise.all(t)];case 1:return n.sent(),[2]}})})},e}(),nN=((w=nN||{})[w.DomContentLoaded=0]="DomContentLoaded",w[w.Load=1]="Load",w[w.FullSnapshot=2]="FullSnapshot",w[w.IncrementalSnapshot=3]="IncrementalSnapshot",w[w.Meta=4]="Meta",w[w.Custom=5]="Custom",w[w.Plugin=6]="Plugin",w),nD=((S=nD||{})[S.Mutation=0]="Mutation",S[S.MouseMove=1]="MouseMove",S[S.MouseInteraction=2]="MouseInteraction",S[S.Scroll=3]="Scroll",S[S.ViewportResize=4]="ViewportResize",S[S.Input=5]="Input",S[S.TouchMove=6]="TouchMove",S[S.MediaInteraction=7]="MediaInteraction",S[S.StyleSheetRule=8]="StyleSheetRule",S[S.CanvasMutation=9]="CanvasMutation",S[S.Font=10]="Font",S[S.Log=11]="Log",S[S.Drag=12]="Drag",S[S.StyleDeclaration=13]="StyleDeclaration",S[S.Selection=14]="Selection",S[S.AdoptedStyleSheet=15]="AdoptedStyleSheet",S),nA=((I=nA||{})[I.MouseUp=0]="MouseUp",I[I.MouseDown=1]="MouseDown",I[I.Click=2]="Click",I[I.ContextMenu=3]="ContextMenu",I[I.DblClick=4]="DblClick",I[I.Focus=5]="Focus",I[I.Blur=6]="Blur",I[I.TouchStart=7]="TouchStart",I[I.TouchMove_Departed=8]="TouchMove_Departed",I[I.TouchEnd=9]="TouchEnd",I[I.TouchCancel=10]="TouchCancel",I),nL=((E=nL||{})[E.Mouse=0]="Mouse",E[E.Pen=1]="Pen",E[E.Touch=2]="Touch",E),nq=((C=nq||{})[C["2D"]=0]="2D",C[C.WebGL=1]="WebGL",C[C.WebGL2=2]="WebGL2",C),nj=((k=nj||{})[k.Play=0]="Play",k[k.Pause=1]="Pause",k[k.Seeked=2]="Seeked",k[k.VolumeChange=3]="VolumeChange",k[k.RateChange=4]="RateChange",k),nF=((T=nF||{}).Start="start",T.Pause="pause",T.Resume="resume",T.Resize="resize",T.Finish="finish",T.FullsnapshotRebuilded="fullsnapshot-rebuilded",T.LoadStylesheetStart="load-stylesheet-start",T.LoadStylesheetEnd="load-stylesheet-end",T.SkipStart="skip-start",T.SkipEnd="skip-end",T.MouseInteraction="mouse-interaction",T.EventCast="event-cast",T.CustomEvent="custom-event",T.Flush="flush",T.StateChange="state-change",T.PlayBack="play-back",T.Destroy="destroy",T);function nU(e,t,n){for(var r=null,i=[],o=e,s=0;o&&"break"!==function(){var e,a,u,c,l=new Date().getTime()-A.getTime();if(void 0!==N.timeoutMs&&l>N.timeoutMs)throw Error("Timeout: Can't find a unique selector after ".concat(l,"ms"));var d=n$((e=o.getAttribute("id"))&&N.idName(e)?{name:"#"+CSS.escape(e),penalty:0}:null)||n$.apply(void 0,(0,L.__spreadArray)([],(0,L.__read)(Array.from(o.attributes).filter(function(e){return N.attr(e.name,e.value)}).map(function(e){return{name:"[".concat(CSS.escape(e.name),'="').concat(CSS.escape(e.value),'"]'),penalty:.5}})),!1))||n$.apply(void 0,(0,L.__spreadArray)([],(0,L.__read)(Array.from(o.classList).filter(N.className).map(function(e){return{name:"."+CSS.escape(e),penalty:1}})),!1))||n$((a=o.tagName.toLowerCase(),N.tagName(a)?{name:a,penalty:2}:null))||[nK()],f=function(e){var t=e.parentNode;if(!t)return null;var n=t.firstChild;if(!n)return null;for(var r=0;n&&(n.nodeType===Node.ELEMENT_NODE&&r++,n!==e);)n=n.nextSibling;return r}(o);if("all"==t)f&&(d=d.concat(d.filter(nG).map(function(e){return nH(e,f)})));else if("two"==t)d=d.slice(0,1),f&&(d=d.concat(d.filter(nG).map(function(e){return nH(e,f)})));else if("one"==t){var h=(0,L.__read)(d=d.slice(0,1),1)[0];f&&nG(h)&&(d=[nH(h,f)])}else"none"==t&&(d=[nK()],f&&(d=[nH(d[0],f)]));try{for(var p=(u=void 0,(0,L.__values)(d)),v=p.next();!v.done;v=p.next()){var h=v.value;h.level=s}}catch(e){u={error:e}}finally{try{v&&!v.done&&(c=p.return)&&c.call(p)}finally{if(u)throw u.error}}if(i.push(d),i.length>=N.seedMinLength&&(r=nz(i,n)))return"break";o=o.parentElement,s++}(););return(r||(r=nz(i,n)),!r&&n)?n():r}function nz(e,t){var n,r,i=nY(function e(t,n){var r,i,o,s,a;return void 0===n&&(n=[]),(0,L.__generator)(this,function(u){switch(u.label){case 0:if(!(t.length>0))return[3,9];u.label=1;case 1:u.trys.push([1,6,7,8]),i=(r=(0,L.__values)(t[0])).next(),u.label=2;case 2:if(i.done)return[3,5];return o=i.value,[5,(0,L.__values)(e(t.slice(1,t.length),n.concat(o)))];case 3:u.sent(),u.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return s={error:u.sent()},[3,8];case 7:try{i&&!i.done&&(a=r.return)&&a.call(r)}finally{if(s)throw s.error}return[7];case 8:return[3,11];case 9:return[4,n];case 10:u.sent(),u.label=11;case 11:return[2]}})}(e));if(i.length>N.threshold)return t?t():null;try{for(var o=(0,L.__values)(i),s=o.next();!s.done;s=o.next()){var a=s.value;if(nV(a))return a}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return null}function nB(e){for(var t=e[0],n=t.name,r=1;r<e.length;r++){var i=e[r].level||0;n=t.level===i-1?"".concat(e[r].name," > ").concat(n):"".concat(e[r].name," ").concat(n),t=e[r]}return n}function nW(e){return e.map(function(e){return e.penalty}).reduce(function(e,t){return e+t},0)}function nV(e){var t=nB(e);switch(D.querySelectorAll(t).length){case 0:throw Error("Can't select any node with this selector: ".concat(t));case 1:return!0;default:return!1}}function nK(){return{name:"*",penalty:3}}function nH(e,t){return{name:e.name+":nth-child(".concat(t,")"),penalty:e.penalty+1}}function nG(e){return"html"!==e.name&&!e.name.startsWith("#")}function n$(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter(nJ);return n.length>0?n:null}function nJ(e){return null!=e}function nY(e){return(0,L.__spreadArray)([],(0,L.__read)(e),!1).sort(function(e,t){return nW(e)-nW(t)})}var nQ=function(e){var t=e.version,n=e.events,r=[];return n.forEach(function(e){var t=JSON.parse(e);t.count=1,"click"===t.type&&r.push(t)}),{version:t,events:r}},nX=function(e){var t=e.version,n=e.events,r=[];return n.forEach(function(e){var t=JSON.parse(e);"click"===t.type&&r.push(t)}),{version:t,events:Object.values(r.reduce(function(e,t){var n=t.x,r=t.y,i=t.selector,o=t.timestamp,s=o-o%36e5,a="".concat(n,":").concat(r,":").concat(null!=i?i:"",":").concat(s);return e[a]?e[a].count+=1:e[a]=(0,L.__assign)((0,L.__assign)({},t),{timestamp:s,count:1}),e},{}))}},nZ=function(e){var t=e.eventsManager,n=e.sessionId,r=e.deviceIdFn;return function(e){if(e.type===nA.Click){var i,o=(0,Q.l)();if(o){var s=o.location,a=o.innerHeight,u=o.innerWidth;if(s){var c=e.x,l=e.y,d=tO.mirror.getNode(e.id);d&&(i=function(e,t){if(A=new Date,e.nodeType!==Node.ELEMENT_NODE)throw Error("Can't generate CSS selector for non-element node type.");if("html"===e.tagName.toLowerCase())return"html";var n,r={root:document.body,idName:function(e){return!0},className:function(e){return!0},tagName:function(e){return!0},attr:function(e,t){return!1},seedMinLength:1,optimizedMinLength:2,threshold:1e3,maxNumberOfTries:1e4,timeoutMs:void 0};D=(n=(N=(0,L.__assign)((0,L.__assign)({},r),void 0)).root).nodeType===Node.DOCUMENT_NODE?n:n===r.root?n.ownerDocument:n;var i=nU(e,"all",function(){return nU(e,"two",function(){return nU(e,"one",function(){return nU(e,"none")})})});if(i){var o=nY(function e(t,n,r){var i,o,s;return void 0===r&&(r={counter:0,visited:new Map}),(0,L.__generator)(this,function(a){switch(a.label){case 0:if(!(t.length>2&&t.length>N.optimizedMinLength))return[3,5];i=1,a.label=1;case 1:var u;if(!(i<t.length-1))return[3,5];if(r.counter>N.maxNumberOfTries||(r.counter+=1,(o=(0,L.__spreadArray)([],(0,L.__read)(t),!1)).splice(i,1),s=nB(o),r.visited.has(s)))return[2];if(!(nV(o)&&(u=o,D.querySelector(nB(u))===n)))return[3,4];return[4,o];case 2:return a.sent(),r.visited.set(s,!0),[5,(0,L.__values)(e(o,n,r))];case 3:a.sent(),a.label=4;case 4:return i++,[3,1];case 5:return[2]}})}(i,e));return o.length>0&&(i=o[0]),nB(i)}throw Error("Selector was not found.")}(d));var f=eU(o),h={x:c+f.left,y:l+f.top,selector:i,viewportHeight:a,viewportWidth:u,pageUrl:s.href,timestamp:Date.now(),type:"click"},p=r();p&&t.addEvent({sessionId:n,event:{type:"interaction",data:JSON.stringify(h)},deviceId:p})}}}}},n0=function(){function e(e,t){var n=(0,Q.l)();n&&n.navigator&&"function"==typeof n.navigator.sendBeacon?this.sendBeacon=function(e,t){try{if(n.navigator.sendBeacon(e,JSON.stringify(t)))return!0}catch(e){}return!1}:this.sendBeacon=function(){return!1},this.sendXhr=function(e,t){var n=new XMLHttpRequest;return n.open("POST",e,!0),n.setRequestHeader("Accept","*/*"),n.send(JSON.stringify(t)),!0},this.basePageUrl=nv(t.serverZone),this.context=e}return e.prototype.send=function(e,t){var n=this.context,r=n.sessionId,i=n.type,o=new URLSearchParams({device_id:e,session_id:String(r),type:String(i)}),s="".concat(this.basePageUrl,"?").concat(o.toString());this.sendBeacon(s,t)||this.sendXhr(s,t)},e}(),n1=function(){function e(e){var t=this;this.timestamp=Date.now(),this.hook=function(e){t.update(e)},this.send=function(e){return function(n){var r=e(),i=(0,Q.l)();i&&r&&t.transport.send(r,{maxScrollX:t._maxScrollX,maxScrollY:t._maxScrollY,maxScrollWidth:t._maxScrollWidth,maxScrollHeight:t._maxScrollHeight,viewportHeight:ez(),viewportWidth:eB(),pageUrl:i.location.href,timestamp:t.timestamp,type:"scroll"})}},this._maxScrollX=0,this._maxScrollY=0,this._maxScrollWidth=eB(),this._maxScrollHeight=ez(),this.transport=e}return e.default=function(t,n){return new e(new n0(t,n))},Object.defineProperty(e.prototype,"maxScrollX",{get:function(){return this._maxScrollX},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollY",{get:function(){return this._maxScrollY},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollWidth",{get:function(){return this._maxScrollWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxScrollHeight",{get:function(){return this._maxScrollHeight},enumerable:!1,configurable:!0}),e.prototype.update=function(e){var t=Date.now();if(e.x>this._maxScrollX){var n=eB();this._maxScrollX=e.x;var r=e.x+n;r>this._maxScrollWidth&&(this._maxScrollWidth=r),this.timestamp=t}if(e.y>this._maxScrollY){var i=ez();this._maxScrollY=e.y;var o=e.y+i;o>this._maxScrollHeight&&(this._maxScrollHeight=o),this.timestamp=t}},e}(),n2=function(e){var t=e.sessionId,n=e.deviceId;this.deviceId=n,this.sessionId=t,t&&n&&(this.sessionReplayId="".concat(n,"/").concat(t))},n3=function(){function e(){var e=this;this.name="@amplitude/session-replay-browser",this.recordCancelCallback=null,this.eventCount=0,this.pageLeaveFns=[],this.teardownEventListeners=function(t){var n=(0,Q.l)();n&&(n.removeEventListener("blur",e.blurListener),n.removeEventListener("focus",e.focusListener),t||n.addEventListener("blur",e.blurListener),t||n.addEventListener("focus",e.focusListener),n.self&&"onpagehide"in n.self?(n.removeEventListener("pagehide",e.pageLeaveListener),t||n.addEventListener("pagehide",e.pageLeaveListener)):(n.removeEventListener("beforeunload",e.pageLeaveListener),t||n.addEventListener("beforeunload",e.pageLeaveListener)))},this.blurListener=function(){e.sendEvents()},this.focusListener=function(){e.recordEvents()},this.pageLeaveListener=function(t){e.pageLeaveFns.forEach(function(e){e(t)})},this.addCustomRRWebEvent=function(t,n,r){return void 0===n&&(n={}),void 0===r&&(r=!0),(0,L.__awaiter)(e,void 0,void 0,function(){var e,i,o;return(0,L.__generator)(this,function(s){switch(s.label){case 0:if(s.trys.push([0,3,,4]),e=void 0,!this.config||(e={config:nm(this.config),version:nx},!r))return[3,2];return[4,ng()];case 1:i=s.sent(),e=(0,L.__assign)((0,L.__assign)({},i),e),s.label=2;case 2:return this.recordCancelCallback?tO.addCustomEvent(t,(0,L.__assign)((0,L.__assign)({},n),e)):this.loggerProvider.debug("Not able to add custom replay capture event ".concat(t," due to no ongoing recording.")),[3,4];case 3:return o=s.sent(),this.loggerProvider.debug("Error while adding custom replay capture event: ",o),[3,4];case 4:return[2]}})})},this.stopRecordingEvents=function(){try{e.loggerProvider.log("Session Replay capture stopping."),e.recordCancelCallback&&e.recordCancelCallback(),e.recordCancelCallback=null}catch(t){e.loggerProvider.warn("Error occurred while stopping replay capture: ".concat(t.toString()))}},this.loggerProvider=new F.Y}return e.prototype.init=function(e,t){return(0,Z.S)(this._init(e,t))},e.prototype._init=function(e,t){var n,r,i;return(0,L.__awaiter)(this,void 0,void 0,function(){var o,s,a,u,c,l,d;return(0,L.__generator)(this,function(f){switch(f.label){case 0:return this.loggerProvider=t.loggerProvider||new F.Y,Object.prototype.hasOwnProperty.call(t,"logLevel")&&this.loggerProvider.enable(t.logLevel),this.identifiers=new n2({sessionId:t.sessionId,deviceId:t.deviceId}),o=this,[4,(0,L.__awaiter)(void 0,void 0,void 0,function(){var n;return(0,L.__generator)(this,function(r){switch(r.label){case 0:return[4,(n=new n_(e,t)).initialize()];case 1:return r.sent(),[2,n]}})})];case 1:return o.joinedConfigGenerator=f.sent(),s=this,[4,this.joinedConfigGenerator.generateJoinedConfig(this.identifiers.sessionId)];case 2:return s.config=f.sent(),t.sessionId&&(null===(n=this.config.interactionConfig)||void 0===n?void 0:n.enabled)&&(a=n1.default({sessionId:t.sessionId,type:"interaction"},this.config),this.pageLeaveFns=[a.send(this.getDeviceId.bind(this))],this.scrollHook=a.hook.bind(a)),u=[],[4,nR({config:this.config,sessionId:this.identifiers.sessionId,type:"replay"})];case 3:if(c=f.sent(),u.push({name:"replay",manager:c}),!(null===(r=this.config.interactionConfig)||void 0===r?void 0:r.enabled))return[3,5];return l=this.config.interactionConfig.batch?nX:nQ,[4,nR({config:this.config,sessionId:this.identifiers.sessionId,type:"interaction",minInterval:null!==(i=this.config.interactionConfig.trackEveryNms)&&void 0!==i?i:3e4,maxInterval:6e4,payloadBatcher:l})];case 4:d=f.sent(),u.push({name:"interaction",manager:d}),f.label=5;case 5:return this.eventsManager=new(nP.bind.apply(nP,(0,L.__spreadArray)([void 0],(0,L.__read)(u),!1))),this.loggerProvider.log("Installing @amplitude/session-replay-browser."),this.teardownEventListeners(!1),this.initialize(!0),[2]}})})},e.prototype.setSessionId=function(e,t){return(0,Z.S)(this.asyncSetSessionId(e,t))},e.prototype.asyncSetSessionId=function(e,t){return(0,L.__awaiter)(this,void 0,void 0,function(){var n,r,i;return(0,L.__generator)(this,function(o){switch(o.label){case 0:if((n=this.identifiers&&this.identifiers.sessionId)&&this.sendEvents(n),r=t||this.getDeviceId(),this.identifiers=new n2({sessionId:e,deviceId:r}),!(this.joinedConfigGenerator&&n))return[3,2];return i=this,[4,this.joinedConfigGenerator.generateJoinedConfig(this.identifiers.sessionId)];case 1:i.config=o.sent(),o.label=2;case 2:return this.recordEvents(),[2]}})})},e.prototype.getSessionReplayDebugPropertyValue=function(){var e="";return this.config&&(e=nh(this.config.apiKey).toString()),JSON.stringify({appHash:e})},e.prototype.getSessionReplayProperties=function(){if(!this.config||!this.identifiers)return this.loggerProvider.warn("Session replay init has not been called, cannot get session replay properties."),{};var e,t=this.getShouldRecord(),n={};return t&&((e={})[K]=this.identifiers.sessionReplayId?this.identifiers.sessionReplayId:null,n=e,this.config.debugMode&&(n[G]=this.getSessionReplayDebugPropertyValue())),this.addCustomRRWebEvent(x.GET_SR_PROPS,{shouldRecord:t,eventProperties:n},10===this.eventCount),10===this.eventCount&&(this.eventCount=0),this.eventCount++,n},e.prototype.sendEvents=function(e){var t,n=e||(null===(t=this.identifiers)||void 0===t?void 0:t.sessionId),r=this.getDeviceId();this.eventsManager&&n&&r&&this.eventsManager.sendCurrentSequenceEvents({sessionId:n,deviceId:r})},e.prototype.initialize=function(e){if(void 0===e&&(e=!1),!(null===(t=this.identifiers)||void 0===t?void 0:t.sessionId)){this.loggerProvider.log("Session is not being recorded due to lack of session id.");return}var t,n=this.getDeviceId();if(!n){this.loggerProvider.log("Session is not being recorded due to lack of device id.");return}this.eventsManager&&e&&this.eventsManager.sendStoredEvents({deviceId:n}),this.recordEvents()},e.prototype.shouldOptOut=function(){if(null===(e=this.config)||void 0===e?void 0:e.instanceName){var e,t,n;n=(0,X.bM)(this.config.instanceName).identityStore.getIdentity().optOut}return void 0!==n?n:null===(t=this.config)||void 0===t?void 0:t.optOut},e.prototype.getShouldRecord=function(){if(!this.identifiers||!this.config||!this.identifiers.sessionId)return this.loggerProvider.warn("Session is not being recorded due to lack of config, please call sessionReplay.init."),!1;if(!this.config.captureEnabled)return this.loggerProvider.log("Session ".concat(this.identifiers.sessionId," not being captured due to capture being disabled for project or because the remote config could not be fetched.")),!1;if(this.shouldOptOut())return this.loggerProvider.log("Opting session ".concat(this.identifiers.sessionId," out of recording due to optOut config.")),!1;var e,t,n=(e=this.identifiers.sessionId,t=this.config.sampleRate,31*Math.abs(nh(e.toString()))%1e6/1e6<t);return n||this.loggerProvider.log("Opting session ".concat(this.identifiers.sessionId," out of recording due to sample rate.")),n},e.prototype.getBlockSelectors=function(){var e,t,n,r=null!==(n=null===(t=null===(e=this.config)||void 0===e?void 0:e.privacyConfig)||void 0===t?void 0:t.blockSelector)&&void 0!==n?n:[];if(0!==r.length)return r},e.prototype.getMaskTextSelectors=function(){if((null===(t=null===(e=this.config)||void 0===e?void 0:e.privacyConfig)||void 0===t?void 0:t.defaultMaskLevel)==="conservative")return"*";var e,t,n,r,i=null===(r=null===(n=this.config)||void 0===n?void 0:n.privacyConfig)||void 0===r?void 0:r.maskSelector;if(i)return i},e.prototype.recordEvents=function(){var e,t=this,n=this.getShouldRecord(),r=null===(e=this.identifiers)||void 0===e?void 0:e.sessionId;if(n&&r&&this.config){this.stopRecordingEvents();var i=this.config.privacyConfig;this.loggerProvider.log("Session Replay capture beginning."),this.recordCancelCallback=tO({emit:function(e){if(t.shouldOptOut()){t.loggerProvider.log("Opting session ".concat(r," out of recording due to optOut config.")),t.stopRecordingEvents(),t.sendEvents();return}var n=JSON.stringify(e),i=t.getDeviceId();t.eventsManager&&i&&t.eventsManager.addEvent({event:{type:"replay",data:n},sessionId:r,deviceId:i})},packFn:nr,inlineStylesheet:this.config.shouldInlineStylesheet,hooks:{mouseInteraction:this.eventsManager&&nZ({eventsManager:this.eventsManager,sessionId:r,deviceIdFn:this.getDeviceId.bind(this)}),scroll:this.scrollHook},maskAllInputs:!0,maskTextClass:$,blockClass:"amp-block",blockSelector:this.getBlockSelectors(),maskInputFn:nf("input",i),maskTextFn:nf("text",i),maskTextSelector:this.getMaskTextSelectors(),recordCanvas:!1,errorHandler:function(e){if(e.message.includes("insertRule")&&e.message.includes("CSSStyleSheet")||e._external_)throw e;return t.loggerProvider.warn("Error while capturing replay: ",e.toString()),!0}}),this.addCustomRRWebEvent(x.DEBUG_INFO)}},e.prototype.getDeviceId=function(){var e;return null===(e=this.identifiers)||void 0===e?void 0:e.deviceId},e.prototype.getSessionId=function(){var e;return null===(e=this.identifiers)||void 0===e?void 0:e.sessionId},e.prototype.flush=function(e){var t;return void 0===e&&(e=!1),(0,L.__awaiter)(this,void 0,void 0,function(){return(0,L.__generator)(this,function(n){return[2,null===(t=this.eventsManager)||void 0===t?void 0:t.flush(e)]})})},e.prototype.shutdown=function(){this.teardownEventListeners(!0),this.stopRecordingEvents(),this.sendEvents()},e}(),n4=function(e){return function(){var t=e.config||J();return{logger:t.loggerProvider,logLevel:t.logLevel}}},n5=(M=new n3,{init:(0,q.w_)(M.init.bind(M),"init",n4(M)),setSessionId:(0,q.w_)(M.setSessionId.bind(M),"setSessionId",n4(M)),getSessionId:(0,q.w_)(M.getSessionId.bind(M),"getSessionId",n4(M)),getSessionReplayProperties:(0,q.w_)(M.getSessionReplayProperties.bind(M),"getSessionReplayProperties",n4(M)),flush:(0,q.w_)(M.flush.bind(M),"flush",n4(M)),shutdown:(0,q.w_)(M.shutdown.bind(M),"shutdown",n4(M))}),n6=n5.init,n8=n5.setSessionId,n7=n5.getSessionId,n9=n5.getSessionReplayProperties,re=(n5.flush,n5.shutdown),rt="1.6.23",rn=function(){function e(e){this.name="@amplitude/plugin-session-replay-browser",this.type="enrichment",this.options=(0,L.__assign)({},e),!1!==this.options.forceSessionTracking&&(this.options.forceSessionTracking=!0)}return e.prototype.setup=function(e){var t,n,r,i;return(0,L.__awaiter)(this,void 0,void 0,function(){return(0,L.__generator)(this,function(o){switch(o.label){case 0:return e.loggerProvider.log("Installing @amplitude/plugin-session-replay, version ".concat(rt,".")),this.config=e,this.options.forceSessionTracking&&("boolean"==typeof e.defaultTracking?!1===e.defaultTracking&&(e.defaultTracking={pageViews:!1,formInteractions:!1,fileDownloads:!1,sessions:!0}):e.defaultTracking=(0,L.__assign)((0,L.__assign)({},e.defaultTracking),{sessions:!0})),[4,n6(e.apiKey,{instanceName:this.config.instanceName,deviceId:this.config.deviceId,optOut:this.config.optOut,sessionId:this.config.sessionId,loggerProvider:this.config.loggerProvider,logLevel:this.config.logLevel,flushMaxRetries:this.config.flushMaxRetries,serverZone:this.config.serverZone,sampleRate:this.options.sampleRate,privacyConfig:{blockSelector:null===(t=this.options.privacyConfig)||void 0===t?void 0:t.blockSelector,maskSelector:null===(n=this.options.privacyConfig)||void 0===n?void 0:n.maskSelector,unmaskSelector:null===(r=this.options.privacyConfig)||void 0===r?void 0:r.unmaskSelector,defaultMaskLevel:null===(i=this.options.privacyConfig)||void 0===i?void 0:i.defaultMaskLevel},debugMode:this.options.debugMode,configEndpointUrl:this.options.configEndpointUrl,shouldInlineStylesheet:this.options.shouldInlineStylesheet,version:{type:"plugin",version:rt}}).promise];case 1:return o.sent(),[2]}})})},e.prototype.execute=function(e){return(0,L.__awaiter)(this,void 0,void 0,function(){var t;return(0,L.__generator)(this,function(n){switch(n.label){case 0:if(!(this.config.sessionId&&this.config.sessionId!==n7()))return[3,2];return[4,n8(this.config.sessionId).promise];case 1:n.sent(),n.label=2;case 2:return this.config.sessionId&&this.config.sessionId===e.session_id&&(t=n9(),e.event_properties=(0,L.__assign)((0,L.__assign)({},e.event_properties),t)),[2,Promise.resolve(e)]}})})},e.prototype.teardown=function(){return(0,L.__awaiter)(this,void 0,void 0,function(){return(0,L.__generator)(this,function(e){return re(),this.config=null,[2]})})},e.prototype.getSessionReplayProperties=function(){return n9()},e}(),rr=function(e){return new rn(e)}},997172:function(e,t,n){let r,i,o,s;n.d(t,{Lj:function(){return v},X3:function(){return p}});let a=(e,t)=>t.some(t=>e instanceof t),u=new WeakMap,c=new WeakMap,l=new WeakMap,d={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return u.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function f(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(f(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)});return l.set(t,e),t}(e);if(c.has(e))return c.get(e);let n="function"==typeof(t=e)?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(h(this),e),f(this.request)}:function(...e){return f(t.apply(h(this),e))}:(t instanceof IDBTransaction&&function(e){if(u.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});u.set(e,t)}(t),a(t,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,d):t;return n!==e&&(c.set(e,n),l.set(n,e)),n}let h=e=>l.get(e);function p(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){let s=indexedDB.open(e,t),a=f(s);return r&&s.addEventListener("upgradeneeded",e=>{r(f(s.result),e.oldVersion,e.newVersion,f(s.transaction),e)}),n&&s.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}function v(e,{blocked:t}={}){let n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",e=>t(e.oldVersion,e)),f(n).then(()=>void 0)}let g=["get","getKey","getAll","getAllKeys","count"],m=["put","add","delete","clear"],y=new Map;function _(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(y.get(t))return y.get(t);let n=t.replace(/FromIndex$/,""),r=t!==n,i=m.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||g.includes(n)))return;let o=async function(e,...t){let o=this.transaction(e,i?"readwrite":"readonly"),s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&o.done]))[0]};return y.set(t,o),o}d={...o=d,get:(e,t,n)=>_(e,t)||o.get(e,t,n),has:(e,t)=>!!_(e,t)||o.has(e,t)};let b=["continue","continuePrimaryKey","advance"],w={},S=new WeakMap,I=new WeakMap,E={get(e,t){if(!b.includes(t))return e[t];let n=w[t];return n||(n=w[t]=function(...e){S.set(this,I.get(this)[t](...e))}),n}};async function*C(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let n=new Proxy(t,E);for(I.set(n,t),l.set(n,h(t));t;)yield n,t=await (S.get(n)||t.continue()),S.delete(n)}function k(e,t){return t===Symbol.asyncIterator&&a(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&a(e,[IDBIndex,IDBObjectStore])}d={...s=d,get:(e,t,n)=>k(e,t)?C:s.get(e,t,n),has:(e,t)=>k(e,t)||s.has(e,t)}},300491:function(e,t,n){n.r(t),n.d(t,{__addDisposableResource:function(){return D},__assign:function(){return o},__asyncDelegator:function(){return C},__asyncGenerator:function(){return E},__asyncValues:function(){return k},__await:function(){return I},__awaiter:function(){return p},__classPrivateFieldGet:function(){return R},__classPrivateFieldIn:function(){return N},__classPrivateFieldSet:function(){return P},__createBinding:function(){return g},__decorate:function(){return a},__disposeResources:function(){return L},__esDecorate:function(){return c},__exportStar:function(){return m},__extends:function(){return i},__generator:function(){return v},__importDefault:function(){return O},__importStar:function(){return x},__makeTemplateObject:function(){return T},__metadata:function(){return h},__param:function(){return u},__propKey:function(){return d},__read:function(){return _},__rest:function(){return s},__runInitializers:function(){return l},__setFunctionName:function(){return f},__spread:function(){return b},__spreadArray:function(){return S},__spreadArrays:function(){return w},__values:function(){return y}});var r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function a(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function u(e,t){return function(n,r){t(n,r,e)}}function c(e,t,n,r,i,o){function s(e){if(void 0!==e&&"function"!=typeof e)throw TypeError("Function expected");return e}for(var a,u=r.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!t&&e?r.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),f=!1,h=n.length-1;h>=0;h--){var p={};for(var v in r)p[v]="access"===v?{}:r[v];for(var v in r.access)p.access[v]=r.access[v];p.addInitializer=function(e){if(f)throw TypeError("Cannot add initializers after decoration has completed");o.push(s(e||null))};var g=(0,n[h])("accessor"===u?{get:d.get,set:d.set}:d[c],p);if("accessor"===u){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw TypeError("Object expected");(a=s(g.get))&&(d.get=a),(a=s(g.set))&&(d.set=a),(a=s(g.init))&&i.unshift(a)}else(a=s(g))&&("field"===u?i.unshift(a):d[c]=a)}l&&Object.defineProperty(l,r.name,d),f=!0}function l(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,a)}u((r=r.apply(e,t||[])).next())})}function v(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var g=Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function m(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||g(t,e,n)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function _(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e}function w(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function S(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function I(e){return this instanceof I?(this.v=e,this):new I(e)}function E(e,t,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),r[Symbol.asyncIterator]=function(){return this},r;function s(e,t){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||a(e,t)})},t&&(r[e]=t(r[e])))}function a(e,t){try{var n;(n=i[e](t)).value instanceof I?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(e){l(o[0][3],e)}}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function C(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:I(e[r](t)),done:!1}:i?i(t):t}:i}}function k(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=y(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var M=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function x(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&g(t,e,n);return M(t,e),t}function O(e){return e&&e.__esModule?e:{default:e}}function R(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function P(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}function N(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function D(e,t,n){if(null!=t){var r,i;if("object"!=typeof t&&"function"!=typeof t)throw TypeError("Object expected.");if(n){if(!Symbol.asyncDispose)throw TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if("function"!=typeof r)throw TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var A="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function L(e){function t(t){e.error=e.hasError?new A(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var r=e.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(n,function(e){return t(e),n()})}catch(e){t(e)}}if(e.hasError)throw e.error}()}t.default={__extends:i,__assign:o,__rest:s,__decorate:a,__param:u,__metadata:h,__awaiter:p,__generator:v,__createBinding:g,__exportStar:m,__values:y,__read:_,__spread:b,__spreadArrays:w,__spreadArray:S,__await:I,__asyncGenerator:E,__asyncDelegator:C,__asyncValues:k,__makeTemplateObject:T,__importStar:x,__importDefault:O,__classPrivateFieldGet:R,__classPrivateFieldSet:P,__classPrivateFieldIn:N,__addDisposableResource:D,__disposeResources:L}}}]);
//# sourceMappingURL=75538.2f11eb54327fd81a.js.map